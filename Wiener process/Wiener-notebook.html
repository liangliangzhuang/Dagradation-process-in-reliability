<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="庄亮亮">

<title>退化过程模型综述</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Wiener-notebook_files/libs/clipboard/clipboard.min.js"></script>
<script src="Wiener-notebook_files/libs/quarto-html/quarto.js"></script>
<script src="Wiener-notebook_files/libs/quarto-html/popper.min.js"></script>
<script src="Wiener-notebook_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Wiener-notebook_files/libs/quarto-html/anchor.min.js"></script>
<link href="Wiener-notebook_files/libs/quarto-html/tippy.css" rel="stylesheet">
<script src="Wiener-notebook_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Wiener-notebook_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Wiener-notebook_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#介绍" id="toc-介绍" class="nav-link active" data-scroll-target="#介绍">1. 介绍</a></li>
  <li><a href="#退化轨道模型" id="toc-退化轨道模型" class="nav-link" data-scroll-target="#退化轨道模型">2. 退化轨道模型</a></li>
  <li><a href="#wiener-退化过程模型" id="toc-wiener-退化过程模型" class="nav-link" data-scroll-target="#wiener-退化过程模型">3. Wiener 退化过程模型</a>
  <ul>
  <li><a href="#带漂移的-wiener-过程" id="toc-带漂移的-wiener-过程" class="nav-link" data-scroll-target="#带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</a>
  <ul>
  <li><a href="#数据模拟产生" id="toc-数据模拟产生" class="nav-link" data-scroll-target="#数据模拟产生">3.1.1 数据模拟产生</a></li>
  <li><a href="#统计推断" id="toc-统计推断" class="nav-link" data-scroll-target="#统计推断">3.1.2 统计推断</a>
  <ul class="collapse">
  <li><a href="#极大似然估计" id="toc-极大似然估计" class="nav-link" data-scroll-target="#极大似然估计">3.1.2.1 极大似然估计</a></li>
  <li><a href="#贝叶斯分析" id="toc-贝叶斯分析" class="nav-link" data-scroll-target="#贝叶斯分析">3.1.2.2 贝叶斯分析</a></li>
  <li><a href="#客观贝叶斯分析" id="toc-客观贝叶斯分析" class="nav-link" data-scroll-target="#客观贝叶斯分析">3.1.2.3 客观贝叶斯分析</a></li>
  <li><a href="#广义推断方法" id="toc-广义推断方法" class="nav-link" data-scroll-target="#广义推断方法">3.1.2.4 广义推断方法</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#案例分析" id="toc-案例分析" class="nav-link" data-scroll-target="#案例分析">3.2 案例分析</a>
  <ul>
  <li><a href="#nasa-锂电池数据" id="toc-nasa-锂电池数据" class="nav-link" data-scroll-target="#nasa-锂电池数据">3.2.1 NASA 锂电池数据</a></li>
  <li><a href="#激光器件-laser-数据集" id="toc-激光器件-laser-数据集" class="nav-link" data-scroll-target="#激光器件-laser-数据集">3.2.2 激光器件 Laser 数据集</a></li>
  <li><a href="#炭膜电阻器-carbon-film-resistors" id="toc-炭膜电阻器-carbon-film-resistors" class="nav-link" data-scroll-target="#炭膜电阻器-carbon-film-resistors">3.2.3 炭膜电阻器 carbon-film resistors</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">退化过程模型综述</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>庄亮亮 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="介绍" class="level2">
<h2 class="anchored" data-anchor-id="介绍">1. 介绍</h2>
<p>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在<strong>基于退化的可靠性模型</strong>方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</p>
<ol type="1">
<li><p>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</p></li>
<li><p>基于 Wiener 过程的模型</p></li>
<li><p>基于 Gamma 过程的模型</p></li>
<li><p>累积损伤模型(主要是基于混合 Poisson 过程的模型）</p></li>
<li><p>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</p></li>
</ol>
<p>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究<strong>矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法</strong>，以及<strong>非参数和半参数方法</strong>等，解决模型辨识和修正问题;</p>
<p>采用<strong>似然比检验、Bayes 因子分析</strong>等方法进行模型验证;</p>
<p>采用<strong>均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)</strong>等进行模型优良性检验。</p>
<p>在基于退化的可靠性技术应用方面，针对<strong>机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）</strong>等的退化失效过程，开展<strong>退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计</strong>：特别是加速退化试验方案设计的研究。</p>
</section>
<section id="退化轨道模型" class="level2">
<h2 class="anchored" data-anchor-id="退化轨道模型">2. 退化轨道模型</h2>
<blockquote class="blockquote">
<p>暂时不考虑</p>
</blockquote>
</section>
<section id="wiener-退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="wiener-退化过程模型">3. Wiener 退化过程模型</h2>
<p>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</p>
<p>Wiener 退化过程的<strong>首达时间分布具有解析形式</strong>，便于对<strong>产品寿命</strong>和<strong>可靠度</strong>的分析和计算。</p>
<p>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</p>
<p>通过对经典 Wiener 过程的参数引入<strong>随机性</strong>，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</p>
<blockquote class="blockquote">
<p>对 Wiener 退化过程及其观测过程所构成的<strong>状态空间模型</strong>，可以采用 <strong>Kalman 滤波技术</strong>进行处理，为产品<strong>在线寿命预测、视情维修决策</strong>等提供了可行的算法和实现途径。</p>
</blockquote>
<section id="带漂移的-wiener-过程" class="level3">
<h3 class="anchored" data-anchor-id="带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</h3>
<p>称 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是漂移参数为 <span class="math inline">\(\mu\)</span> 、扩散参数为 <span class="math inline">\(\sigma\)</span> 的 (一元) Wiener 过程, 若</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span>。</p></li>
<li><p><span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 有平稳独立增量。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 服从均值为 <span class="math inline">\(\mu t\)</span>,方差为 <span class="math inline">\(\sigma^2 t\)</span> 的正态分布。</p></li>
</ol>
<p>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: <span class="math display">\[
X(t)=\mu t+\sigma B(t)
\]</span> 式中: <span class="math inline">\(\{B(t)\}, t \geqslant 0\)</span> 是标准 Wiener 过程或标准布朗运动过程。</p>
<p>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</p>
<p>（1）时刻 <span class="math inline">\(t \sim t+\Delta t\)</span> 之间的增量服从正态分布, 即 <span class="math inline">\(\Delta X=X(t+\Delta t)-X(t) \sim\)</span> <span class="math inline">\(N\left(\mu \Delta t, \sigma^2 \Delta t\right)\)</span> 。</p>
<ol start="2" type="1">
<li>对任意两个不相交的时间区间 <span class="math inline">\(\left[t_1, t_2\right],\left[t_3, t_4\right], t_1&lt;t_2 \leqslant t_3&lt;t_4\)</span>, 增量 <span class="math inline">\(X\left(t_4\right)-X\)</span> <span class="math inline">\(\left(t_3\right)\)</span> 与 <span class="math inline">\(X\left(t_2\right)-X\left(t_1\right)\)</span> 相互独立。</li>
</ol>
<p><strong>可靠度</strong></p>
<p>如果产品的性能退化过程是一元 Wiener 过程，失效阈值为<span class="math inline">\(l\)</span>。 则可靠度为 <span class="math display">\[
R(t)= 1-F(t ; \mu, \sigma)=\Phi\left(\frac{l-\mu t}{\sigma \sqrt{t}}\right)-\exp \left(\frac{2 \mu l}{\sigma^2}\right) \Phi\left(\frac{-l-\mu t}{\sigma \sqrt{t}}\right)
\]</span></p>
<p><strong>剩余使用寿命</strong></p>
<p>假设其运行到时刻 <span class="math inline">\(\tau\)</span> 仍末失效, 且当前性能退化量为 <span class="math inline">\(x_\tau\left(x_\tau&lt;l\right)\)</span>, 则产品的剩余寿命 <span class="math inline">\(T_1\)</span> 可以表示为 <span class="math display">\[
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
\]</span> 由一元 Wiener 过程的独立增量性质和齐次马尔可夫性得到 <span class="math display">\[
\begin{aligned}
T_1 &amp;=\inf \left\{t \mid X(t+\tau)-X(\tau) \geqslant l-x_\tau, t \geqslant 0\right\} \\
&amp;=\inf \left\{t \mid X(t) \geqslant l-x_\tau, t \geqslant 0\right\}
\end{aligned}
\]</span> 可知剩余寿命 <span class="math inline">\(T_1\)</span> 也是逆 Gaussian 分布, 其密度函数只需将寿命 <span class="math inline">\(T\)</span> 密度函数中的失效阈值 <span class="math inline">\(l\)</span> 替换为 <span class="math inline">\(l-x_\tau\)</span>, 即 <span class="math display">\[f_{T_1}(t)=\frac{l-x_\tau}{\sqrt{2 \pi \sigma^2 t^3}} \exp \left[-\frac{\left(l-x_\tau-\mu t\right)^2}{2 \sigma^2 t}\right]\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="数据模拟产生" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生">3.1.1 数据模拟产生</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)){</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="co"># para 指 mu,sigma</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb2-7"><a href="#cb2-7"></a>  dat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb2-9"><a href="#cb2-9"></a>  dat_unit <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) dat_unit[j] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],<span class="fu">sqrt</span>(para[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_t[j]))</span>
<span id="cb2-12"><a href="#cb2-12"></a>    dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit)</span>
<span id="cb2-13"><a href="#cb2-13"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb2-15"><a href="#cb2-15"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="fu">return</span>(dat1)</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>绘制退化路径图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="co"># 画图</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data[,<span class="sc">-</span><span class="dv">1</span>])), </span>
<span id="cb3-5"><a href="#cb3-5"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb3-6"><a href="#cb3-6"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="fu">print</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb4-5"><a href="#cb4-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.6884963</td>
<td style="text-align: right;">1.917456</td>
<td style="text-align: right;">0.6282141</td>
<td style="text-align: right;">1.352515</td>
<td style="text-align: right;">1.804512</td>
<td style="text-align: right;">3.441481</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.8995243</td>
<td style="text-align: right;">3.656130</td>
<td style="text-align: right;">0.7456607</td>
<td style="text-align: right;">4.933220</td>
<td style="text-align: right;">3.329712</td>
<td style="text-align: right;">7.855412</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.9355898</td>
<td style="text-align: right;">3.013625</td>
<td style="text-align: right;">8.3614401</td>
<td style="text-align: right;">7.085078</td>
<td style="text-align: right;">4.736490</td>
<td style="text-align: right;">8.278781</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.1481868</td>
<td style="text-align: right;">4.787342</td>
<td style="text-align: right;">8.5227059</td>
<td style="text-align: right;">5.905574</td>
<td style="text-align: right;">7.714482</td>
<td style="text-align: right;">8.527700</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2.7647223</td>
<td style="text-align: right;">6.254419</td>
<td style="text-align: right;">7.9300480</td>
<td style="text-align: right;">10.395192</td>
<td style="text-align: right;">13.129829</td>
<td style="text-align: right;">9.715557</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">plot_path</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="统计推断" class="level4">
<h4 class="anchored" data-anchor-id="统计推断">3.1.2 统计推断</h4>
<p>假设共有 <span class="math inline">\(n\)</span> 个样品进行性能退化试验。样品 <span class="math inline">\(i\)</span> 初始时刻 <span class="math inline">\(t_{i 0}\)</span> 退化量取值为 <span class="math inline">\(X_{i 0}=0\)</span>, 在 时刻 <span class="math inline">\(t_{i 1}, \cdots, t_{i m_i}\)</span> 样品 <span class="math inline">\(i\)</span> 退化量为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span> 。记 <span class="math inline">\(\Delta X_{i j}=X_{i j}-X_{i, j-1}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{i, j-1} \sim t_{i j}\)</span> 之间的退化增量, <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 为各样品的测量间隔。</p>
<section id="极大似然估计" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计">3.1.2.1 极大似然估计</h5>
<p>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 <span class="math display">\[
\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)
\]</span></p>
<p>于是由退化数据 <span class="math inline">\(X_{i j}=x_{i j}\)</span> (等价的, <span class="math inline">\(\Delta X_{i j}=\Delta x_{i j}\)</span> ) <span class="math inline">\(, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span>, 得到模型参数的似然函数为 <span class="math display">\[
L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left[-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right]
\]</span> 由式可以直接求得漂移参数 <span class="math inline">\(\mu\)</span> 和扩散参数 <span class="math inline">\(\sigma^2\)</span> 的极大似然估计如下: <span class="math display">\[
\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left[\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right]
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb6-6"><a href="#cb6-6"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb6-7"><a href="#cb6-7"></a>  }</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">return</span>(re)</span>
<span id="cb6-9"><a href="#cb6-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb7-5"><a href="#cb7-5"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb7-14"><a href="#cb7-14"></a>}</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb7-17"><a href="#cb7-17"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># mle_re</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># 区间估计</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">low</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">up</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.821</td>
<td style="text-align: right;">1.931</td>
<td style="text-align: right;">2.041</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.864</td>
<td style="text-align: right;">1.942</td>
<td style="text-align: right;">2.020</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>为了得到产品可靠度的估计, 只要将 <span class="math inline">\(\hat{\mu} 、 \hat{\sigma}^2\)</span> 代人任务时间 <span class="math inline">\(t\)</span> 的可靠度的表达式。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb8-3"><a href="#cb8-3"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">return</span>(R)</span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>给个简单例子</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb9-4"><a href="#cb9-4"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb9-5"><a href="#cb9-5"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>剩余使用寿命</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## 剩余使用寿命计算</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>RUL_density <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">cur_time =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par){</span>
<span id="cb10-3"><a href="#cb10-3"></a>  RUL <span class="ot">=</span> (threshold <span class="sc">-</span> cur_time)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>mle_par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">3</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(threshold<span class="sc">-</span>cur_time <span class="sc">-</span> mle_par[<span class="dv">1</span>] <span class="sc">*</span> t)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> mle_par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> t)) </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">return</span>(RUL)</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>给一个简单例子，当前时刻为10，计算对应的RUL密度函数</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>rul_den <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">cur_time =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">plot</span>(rul_den,<span class="at">type =</span> <span class="st">'l'</span>,<span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"RUL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>计算未来某些时刻（<code>fut_time  = c(50,55,60,65,70,75,80)</code>）的RUL（<code>time_epoch = 1:100</code>），并绘制3D图形。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>fut_time <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">55</span>,<span class="dv">60</span>,<span class="dv">65</span>,<span class="dv">70</span>,<span class="dv">75</span>,<span class="dv">80</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>time_epoch <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>rul_den <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(time_epoch),<span class="fu">length</span>(fut_time))</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb12-5"><a href="#cb12-5"></a>  rul_den[,i] <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> time_epoch, <span class="at">cur_time =</span> fut_time[i], <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb12-6"><a href="#cb12-6"></a>}</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="fu">dim</span>(rul_den)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100   7</code></pre>
</div>
</div>
<p>使用真实参数值计算RUL值。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># 真实数据</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>true_rul_den <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(time_epoch),<span class="fu">length</span>(fut_time))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb14-4"><a href="#cb14-4"></a>  true_rul_den[,i] <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> time_epoch, <span class="at">cur_time =</span> fut_time[i], <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> par)</span>
<span id="cb14-5"><a href="#cb14-5"></a>}</span>
<span id="cb14-6"><a href="#cb14-6"></a>real_RUL <span class="ot">=</span> <span class="fu">apply</span>(true_rul_den,<span class="dv">2</span>,which.max)</span>
<span id="cb14-7"><a href="#cb14-7"></a>real_RUL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50 48 45 43 40 37 35</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># 未来时刻fut_time下的RUL值</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>RUL_3D_density <span class="ot">=</span> <span class="cf">function</span>(fut_time,time_epoch,rul_den,</span>
<span id="cb16-3"><a href="#cb16-3"></a>                          threshold,real_RUL,</span>
<span id="cb16-4"><a href="#cb16-4"></a>                          <span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)){</span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">library</span>(plot3D)</span>
<span id="cb16-6"><a href="#cb16-6"></a>  col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#02B1e6"</span>, <span class="st">"#E81D22"</span>, <span class="st">"#F9BC15"</span>, <span class="st">"#8015f9"</span>, <span class="st">"#20e81d"</span>, <span class="st">"#e64602"</span>,<span class="st">"black"</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">scatter3D</span>(time_epoch, <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(time_epoch)), rul_den[,<span class="dv">1</span>], <span class="at">bty =</span> <span class="st">"b2"</span>,<span class="at">colkey =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-8"><a href="#cb16-8"></a>          <span class="at">phi =</span> <span class="dv">14</span>,<span class="at">theta =</span> <span class="dv">55</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>          <span class="at">pch =</span> <span class="dv">18</span>,<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">expand =</span><span class="fl">0.2</span>,<span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb16-10"><a href="#cb16-10"></a>          <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb16-11"><a href="#cb16-11"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(fut_time)<span class="sc">-</span><span class="dv">5</span>,<span class="fu">max</span>(fut_time)<span class="sc">+</span><span class="dv">5</span>),</span>
<span id="cb16-12"><a href="#cb16-12"></a>          <span class="at">zlim =</span> zlim,</span>
<span id="cb16-13"><a href="#cb16-13"></a>          <span class="at">xlab =</span> <span class="st">"RUL"</span>, <span class="at">ylab =</span> <span class="st">"Time"</span>, <span class="at">zlab =</span> <span class="st">"Kernel Distribution"</span>)</span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># 循环绘制3D图形</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb16-16"><a href="#cb16-16"></a>  <span class="co"># 密度函数</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>  <span class="fu">scatter3D</span>(time_epoch, <span class="fu">rep</span>(fut_time[i],<span class="fu">length</span>(time_epoch)), rul_den[,i], </span>
<span id="cb16-18"><a href="#cb16-18"></a>            <span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">type =</span><span class="st">'l'</span>, <span class="at">col =</span> col[i], <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb16-19"><a href="#cb16-19"></a>  <span class="co"># 预测值</span></span>
<span id="cb16-20"><a href="#cb16-20"></a>   <span class="fu">scatter3D</span>(<span class="fu">which.max</span>(rul_den[,i]), fut_time[i], <span class="dv">0</span>, </span>
<span id="cb16-21"><a href="#cb16-21"></a>             <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">type =</span><span class="st">'h'</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb16-22"><a href="#cb16-22"></a>   <span class="co"># 真实值</span></span>
<span id="cb16-23"><a href="#cb16-23"></a>   <span class="fu">scatter3D</span>(real_RUL[i],fut_time[i], <span class="dv">0</span>,</span>
<span id="cb16-24"><a href="#cb16-24"></a>             <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">type =</span><span class="st">'h'</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">5</span>)</span>
<span id="cb16-25"><a href="#cb16-25"></a>}</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="fu">legend</span>(<span class="st">"top"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"RUL distribution"</span>,<span class="st">"Point estimation"</span>,<span class="st">"Real value"</span>),</span>
<span id="cb16-27"><a href="#cb16-27"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">16</span>,<span class="dv">5</span>), <span class="at">col =</span> <span class="fu">c</span>(col[<span class="dv">1</span>],<span class="st">"black"</span>,<span class="st">"red"</span>),<span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>)) <span class="co">#,inset = .05</span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co"># 7.8,6.4</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">RUL_3D_density</span>(fut_time,time_epoch,rul_den,threshold,real_RUL,<span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.08</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="贝叶斯分析" class="level5">
<h5 class="anchored" data-anchor-id="贝叶斯分析">3.1.2.2 贝叶斯分析</h5>
<p>基于 rstan 进行贝叶斯估计。详细的参考文献如下：</p>
<ul>
<li><p>最新、入门级别 <a href="https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html">rstan</a> 资料。</p></li>
<li><p><a href="https://mc-stan.org/users/interfaces/rstan">官网资料</a></p></li>
</ul>
<p>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),\\
&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),\\
&amp; \mu|w \sim N(d,\frac{c}{w}).
\end{aligned}
\]</span></p>
<p>其中，<span class="math inline">\(a = b = 1, d = 0, c =100\)</span>。</p>
<p>构建模型（<code>wiener_linear.stan</code>）</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1"></a>data {</span>
<span id="cb18-2"><a href="#cb18-2"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb18-3"><a href="#cb18-3"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb18-4"><a href="#cb18-4"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb18-5"><a href="#cb18-5"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb18-6"><a href="#cb18-6"></a>}</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>parameters {</span>
<span id="cb18-9"><a href="#cb18-9"></a>  real mu;</span>
<span id="cb18-10"><a href="#cb18-10"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb18-11"><a href="#cb18-11"></a>}</span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a>model {</span>
<span id="cb18-14"><a href="#cb18-14"></a>  w ~ gamma(1,1);</span>
<span id="cb18-15"><a href="#cb18-15"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb18-16"><a href="#cb18-16"></a>  for (i in 1:I){</span>
<span id="cb18-17"><a href="#cb18-17"></a>    for (j in 1:J) {</span>
<span id="cb18-18"><a href="#cb18-18"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb18-19"><a href="#cb18-19"></a>    }</span>
<span id="cb18-20"><a href="#cb18-20"></a>  }</span>
<span id="cb18-21"><a href="#cb18-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>存在问题：这里的normal中，sigma是标准差还是方差？</p>
</blockquote>
<ul>
<li>数据准备</li>
</ul>
<p>准备<span class="math inline">\(\Delta t_{ij}\)</span> 和 <span class="math inline">\(\Delta x_{ij}\)</span>的数据，并且标志出矩阵的维数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># 数据准备</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb19-5"><a href="#cb19-5"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="fu">dim</span>(delta_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 199   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb21-6"><a href="#cb21-6"></a>)</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="fu">dim</span>(delta_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 199   6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># 后验抽样</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">library</span>(rstan)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>输出各个参数的后验估计结果并进行绘制。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">print</span>(fit1,</span>
<span id="cb24-2"><a href="#cb24-2"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inference for Stan model: wiener_linear.
1 chains, each with iter=2000; warmup=1000; thin=1; 
post-warmup draws per chain=1000, total post-warmup draws=1000.

         mean se_mean   sd      10%      50%      90% n_eff Rhat
mu       1.93    0.00 0.06     1.86     1.93     2.01   791    1
w        0.52    0.00 0.01     0.50     0.52     0.53   709    1
lp__ -1396.92    0.06 1.05 -1398.29 -1396.57 -1396.00   334    1

Samples were drawn using NUTS(diag_e) at Fri Feb  3 10:35:22 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">plot</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb27-2"><a href="#cb27-2"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb27-3"><a href="#cb27-3"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>可以看出，效果较好。真实值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.25\)</span>，估计值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.5\)</span>。 估计值的<span class="math inline">\(\sigma^2\)</span> 有些问题，应该如何处理？</p>
</section>
<section id="客观贝叶斯分析" class="level5">
<h5 class="anchored" data-anchor-id="客观贝叶斯分析">3.1.2.3 客观贝叶斯分析</h5>
<p>暂时还未找到，最经典的维纳过程客观贝叶斯分析。</p>
<ul>
<li>维纳（线性） + 随机效应：</li>
</ul>
</section>
<section id="广义推断方法" class="level5">
<h5 class="anchored" data-anchor-id="广义推断方法">3.1.2.4 广义推断方法</h5>
<p>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</p>
<ul>
<li>维纳（线性） + 随机效应：</li>
</ul>
<p>Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety 193.</p>
<ul>
<li>维纳（线性）+ 加速寿命试验 + 随机效应：</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2020). “Reliability analysis for accelerated degradation data based on the Wiener process with random effects.” Quality and Reliability Engineering International 36(6): 1969-1981.</p>
<p>Hong, L., et al.&nbsp;(2018). “Interval estimation for Wiener processes based on accelerated degradation test data.” IISE Transactions 50(12): 1043-1057.</p>
<ul>
<li>伽马 + 随机过程</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2021). “Degradation data analysis based on gamma process with random effects.” European Journal of Operational Research 292(3): 1200-1208.</p>
<ul>
<li>伽马 + 加速寿命试验</li>
</ul>
<p>Jiang, P. H., et al.&nbsp;(2019). “Inference for constant-stress accelerated degradation test based on Gamma process.” Applied Mathematical Modelling 67: 123-134.</p>
<!-- ### 3.2 多应力和动态环境情形 -->
<!-- **1. 多应力情形** -->
<!-- 某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。 -->
<!-- 假设在不同应力下, 一元 Wiener 过程模型的参数是应力 $S$ 的函数 $$ -->
<!-- \mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right) -->
<!-- $$ 式中: $\theta_\mu 、 \theta_\sigma$ 是末知参数向量。 -->
<!-- 对不同类型应力, $\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)$ 的形式和参数不同。比如对漂移参数 $\mu$, 应力 为温度时通常采用阿伦尼斯模型进行描述 $$ -->
<!-- \mu(S)=a \mathrm{e}^{-b / S} -->
<!-- $$ -->
<!-- 如果应力是电压、功率等, 则通常采用幂律模型 $$ -->
<!-- \mu(S)=a S^b -->
<!-- $$ -->
<!-- 根据加速退化试验中应力的变化情况,加速退化试验又分别为**恒定应力加速退化试验**、**步进应力加速退化试验**和**序进应力加速退化试验**。 -->
<!-- 恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。 -->
<!-- 设产品在 $S_0, S_1, \cdots, S_s$ 共 $s+1$ 个应力下进行退化试验, 其中应力 $S_0$ 为正常工作应 力。应力 $S_i$ 下共得到 $n_i$ 个产品的性能退化数据, 其中对产品 $j$, 初始时刻 $t_{i j 0}$ 的退化量 为 $X_{i j 0}=0$, 分别在时刻 $t_{i j 1}, \cdots, t_{i j m_{i j}}$ 测量其性能退化量 $X_{i j 1}, \cdots, X_{i j m_{i j}}$, 其中 $i=0,1, \cdots, s, j=$ $1,2, \cdots, n_i$ 记 $\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}$, 其中 $k=1,2, \cdots, m_{i j}$ 。由各应力下 的退化数据 $\left\{\Delta x_{i j k}\right\}$ 得到模型参数的似然函数为 $$ -->
<!-- L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k}}} \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right] -->
<!-- $$ -->
<!-- 则参数 $\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma$ 的极大似然估计 $\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma$ 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 $S_0$ 下参数 $\mu 、 \sigma^2$ 为 $$ -->
<!-- \mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right) -->
<!-- $$ 产品可靠度点估计可由式 (3.42)得到。 -->
<!-- **2. 动态环境情形** -->
<!-- 与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 $\{S$ $(t), t \geqslant 0\}$, 并且假设应力对退化速率的影响函数为 $\beta_0 \cdot h(S(t) ; b)$, 其中 $\beta_0$ 是基准应 力下的退化速率, 以 $b$ 为参数的函数 $h(S(t) ; b)$ 表示应力的影响, $b$ 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 $t$ 产品退化量取值为 $$ -->
<!-- X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t) -->
<!-- $$ 式中: $\{S(\tau), 0 \leqslant \tau \leqslant t\}$ 为 $[0, \tau]$ 内的应力; $\{B(t), t \geqslant 0\}$ 为标准 Wiener 过程; 模型待估 参数为 $$ -->
<!-- \boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right) -->
<!-- $$ -->
<!-- 设有 $n$ 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 $i$, 设 时刻 $t_{i k}$ 观测到的退化量为 $X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)$; 对环境进行连续观测, 时刻 $j$ 观测到应力取值为 $S_{i j}, j=1,2, \cdots$ 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 $t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots$ 。下面基于动态环境下的退化试验数据, 给出 模型参数的**极大似然估计**方法。 -->
<!-- 根据模型式 $(3.51)$, 记 $\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)$, 对产品 $i$ 以及时刻 $t_{i k}$ 近似的有 $$ -->
<!-- X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right) -->
<!-- $$ 且有 $$ -->
<!-- \begin{gathered} -->
<!-- E\left[X_i\left(t_{i k}\right)\right]=\beta_0 \nu_{i k} \\ -->
<!-- \operatorname{Cov}\left[X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right]=\sigma_B^2 \cdot \min \left\{t_{i k_1}, t_{i k_2}\right\} -->
<!-- \end{gathered} -->
<!-- $$ 如果考虑退化增量 $\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)$, 其中 $$ -->
<!-- Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m -->
<!-- $$ 记 $\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}$ 。容易知道 $\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)$, 其中 $$ -->
<!-- \mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right) -->
<!-- $$ -->
<!-- 其中 $$ -->
<!-- \Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}} -->
<!-- $$ 设退化试验数据为 $\boldsymbol{y}_i, i=1,2, \cdots, n$, 则似然函数为 $$ -->
<!-- L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right\} -->
<!-- $$ 对数似然函数为 $$ -->
<!-- l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} -->
<!-- $$ 取对数似然函数关 $\sigma_B$ 和 $\beta_0$ 的一阶偏导数,得到 $$ -->
<!-- \frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} -->
<!-- $$ 与 $$ -->
<!-- \frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}} -->
<!-- $$ 这样, 对特定的 $\sigma_B$ 和 $\beta_0$, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: $$ -->
<!-- l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} -->
<!-- $$ 通过搜索得到 $b$ 的极大似然估计 $\hat{b}$, 并将其代人式 (3.52) 或式 (3.53), 就得到 $\sigma_B$ 和 $\beta_0$ 的极大似然估计。 -->
<!-- ### 3.3 含随机效应情形 -->
<!-- #### 3.3.1 二阶段的极大似然方法 -->
<!-- 考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 $n$ 个样品的退化 试验数据对随机效应的分布参数 $\nu 、 \eta 、 \alpha 、 \beta$ 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。 -->
<!-- 对产品 $i$, 分别在时刻 $t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}$ 对其进行 $m_i+1$ 次测量, $i=1,2, \cdots, n$, 得 到的测量数据为 $x_{i j}$ 。记 $\Delta x_{i j}=x_{i j}-x_{i, j-1}$, 即 $\Delta x_{i j}$ 为产品 $i$ 在 $t_{i j-1}$ 到 $t_{i j}$ 之间的退化量增量, 由式 (3.41), 给定试验数据 $\Delta x_{i j}$ 的情况下, 样品 $i$ 的退化过程模型参数 $\mu_i, \sigma_i^2$ 的极大似然估计为 $$ -->
<!-- \hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right] -->
<!-- $$ 式中 : $\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i$ 。 -->
<!-- 由式 (3.56) 得到各产品的退化过程参数的估计 $\hat{\mu}_i 、 \hat{\sigma}_i^2$ 后, 可以拟合得到 $\mu$ 和 $D$ 的 分布参数。令 $\hat{D}_i=\hat{\sigma}_i^2$, 由于 $D^{-1}$ 服从参数为 $(\alpha, \beta)$ 的 $\mathrm{Gamma}$ 分布, 则根据极大似然估 计, $D$ 的分布参数 $\alpha \sqrt{ } \beta$ 可以通过求解下面的方程组得到: $$ -->
<!-- \left\{\begin{array}{l} -->
<!-- \ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) \\ -->
<!-- \alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}} -->
<!-- \end{array}\right. -->
<!-- $$ 式中: $\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)$ 为 Digamma 函数, 文献 $[47]$ 给出了其准确计算方法。 -->
<!-- 由于 $\mu \sim N(\nu, \eta D)$, 对单元 $i$, 近似认为参数 $\nu 、 \eta$ 的似然函数为 $$ -->
<!-- l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right) -->
<!-- $$ 于是总的似然函数为 $$ -->
<!-- l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right) -->
<!-- $$ 由极大似然方法得到 $$ -->
<!-- \left\{\begin{array}{l} -->
<!-- -\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 \\ -->
<!-- -\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 -->
<!-- \end{array}\right. -->
<!-- $$ 解上面的方程组得到 $$ -->
<!-- \left\{\begin{array}{l} -->
<!-- \hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} \\ -->
<!-- \hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right) -->
<!-- \end{array}\right. -->
<!-- $$ -->
<!-- #### 3.3.2 客观贝叶斯方法 -->
<!-- ### 3.4 有测量误差情形 -->
<!-- 假设 $Y(t)$ 和 $X(t)$ 分别表示观测的退化过程和真实退化过程在时刻 $t, t \geqslant 0$ 的退化水平, $X(t)$ 和 $Y(t)$ 可用下面的模型描述: $$ -->
<!-- \left\{\begin{array}{l} -->
<!-- X(t)=\beta \cdot t+\sigma_B \cdot B(t) \\ -->
<!-- Y(t)=X(t)+\sigma_R \cdot \varepsilon(t) -->
<!-- \end{array}\right. -->
<!-- $$ 式中: $\beta$ 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 $\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)$ 是标准 Wiener 过程, $\sigma_B$ 为扩散参 数; $\varepsilon(t)$ 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。 -->
<!-- 因此, 式 (3.61) 模型共有 4 个待估参数, 即 $$ -->
<!-- \boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}} -->
<!-- $$ -->
<!-- 假设对 $n$ 个产品进行退化试验。对单元 $i(i=1, \cdots, n)$ 进行 $m_i$ 次测量, 时刻 $t_{i j}$ 的测量值为 $$ -->
<!-- Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i -->
<!-- $$ 式中 : $\beta_i$ 是单元 $i$ 的平均退化速率, 对单元 $i$ 的所有测量是恒定不变的。 -->
<!-- 定义时间间隔 $\Delta t_{i j}=t_{i j}-t_{i j-1}$, 观测的退化增量为 $\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1$, $2, \cdots, m_i$; 根据 Wiener 过程定义, $t_{i 0}=0, Y_i\left(t_{i 0}\right)=0$ 。为叙述方便, 令 $$ -->
<!-- \Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}} -->
<!-- $$ -->
<!-- 根据 Wiener 过程的独立增量性质, 得到 $$ -->
<!-- \begin{gathered} -->
<!-- E\left[\Delta \boldsymbol{Y}_i\right]=\mu_\beta \Delta \boldsymbol{t}_i \\ -->
<!-- \operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i \\ -->
<!-- \end{gathered} -->
<!-- $$ 其中， $$ -->
<!-- \boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc} -->
<!-- 2 & -1 & 0 & \cdots & 0 \\ -->
<!-- -1 & 2 & -1 & \cdots & 0 \\ -->
<!-- 0 & -1 & 2 & \cdots & 0 \\ -->
<!-- \vdots & \vdots & \vdots & \ddots & \vdots \\ -->
<!-- 0 & 0 & \cdots & -1 & 2 -->
<!-- \end{array}\right] -->
<!-- $$ -->
<!-- 设退化数据为 $\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n$, 则参数 $\boldsymbol{\theta}$ 的似然函数为 $$ -->
<!-- L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right\} -->
<!-- $$ 令 $\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i$, 其中 $\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i$ 定义 $$ -->
<!-- \phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i -->
<!-- $$ 取对数似然函数关于 $\mu_\beta$ 和 $\sigma_\beta^2$ 的一阶偏导数, 并利用下面的公式 $$ -->
<!-- \begin{aligned} -->
<!-- \left|\boldsymbol{\Sigma}_i\right| &=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.\\ -->
<!-- \boldsymbol{\Sigma}_i^{-1} &=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 }) -->
<!-- \end{aligned} -->
<!-- $$ -->
<!-- 得到 $$ -->
<!-- \frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i} -->
<!-- $$ 和 $$ -->
<!-- \frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i} -->
<!-- $$ 于是, 对特定的 $\left(\sigma_B, \sigma_R\right)$ 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的如下限制极大似然估计: $$ -->
<!-- \left\{\begin{array}{l} -->
<!-- \hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} \\ -->
<!-- \sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0 -->
<!-- \end{array}\right. -->
<!-- $$ 将上式代人 $\theta$ 的对数似然函数,则得到如下的截面似然函数: $$ -->
<!-- \begin{aligned} -->
<!-- l\left(\sigma_B, \sigma_R\right)=&-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) \\ -->
<!-- &-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) \\ -->
<!-- &+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i} -->
<!-- \end{aligned} -->
<!-- $$ 通过最大化上述截面似然函数, 得到 $\sigma_B$ 和 $\sigma_R$ 的极大似然估计 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$, 这可通过 2 维搜索算法实现。最后将 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$ 代人式 (3.64), 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的极大似然估计。 -->
<!-- 当所有观测时间相同时, 诸 $\rho_i$ 相同, 记为 $\rho$, 可以得到 $\hat{\mu}_\beta$ 和 $\hat{\sigma}_\beta^2$ 的解析形式, 即 $$ -->
<!-- \begin{gathered} -->
<!-- \hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} \\ -->
<!-- \hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho} -->
<!-- \end{gathered} -->
<!-- $$ 容易看出, $\hat{\mu}_{\beta, i}$ 实际上是单元 $i$ 的退化速率的加权最小二乘估计, $\hat{\sigma}_\beta^2$ 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: $$ -->
<!-- \begin{aligned} -->
<!-- l\left(\sigma_B, \sigma_R\right)=&-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| \\ -->
<!-- &-\frac{1}{2}\left\{\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right\} \\ -->
<!-- &-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right) -->
<!-- \end{aligned} -->
<!-- $$ -->
</section>
</section>
</section>
<section id="案例分析" class="level3">
<h3 class="anchored" data-anchor-id="案例分析">3.2 案例分析</h3>
<section id="nasa-锂电池数据" class="level4">
<h4 class="anchored" data-anchor-id="nasa-锂电池数据">3.2.1 NASA 锂电池数据</h4>
<blockquote class="blockquote">
<p>数据来源于<a href="https://c3.ndc.nasa.gov/dashlink/resources/133/">NASA Ames Prognostics Center of Excellence (PCoE)</a>，但是找不到数据下载。最后是通过 <a href="https://github.com/psanabriaUC/BatteryDatasetImplementation">Github</a> 获得。</p>
</blockquote>
<p>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即<strong>充电</strong>、<strong>放电</strong>和<strong>测量 EIS</strong>。</p>
<p>充电是以<strong>恒流模</strong>式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以<strong>恒压模式</strong>(CV)继续充电直到电流降到 20mA。</p>
<p>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</p>
<p>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Voltage_measured</th>
<th style="text-align: right;">Current_measured</th>
<th style="text-align: right;">Temperature_measured</th>
<th style="text-align: right;">Current_charge</th>
<th style="text-align: right;">Voltage_charge</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Capacity</th>
<th style="text-align: right;">id_cycle</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">ambient_temperature</th>
<th style="text-align: right;">time</th>
<th style="text-align: left;">Battery</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.974871</td>
<td style="text-align: right;">-2.012528</td>
<td style="text-align: right;">24.38909</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.062</td>
<td style="text-align: right;">35.703</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.951717</td>
<td style="text-align: right;">-2.013979</td>
<td style="text-align: right;">24.54475</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.030</td>
<td style="text-align: right;">53.781</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.934353</td>
<td style="text-align: right;">-2.011144</td>
<td style="text-align: right;">24.73139</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.011</td>
<td style="text-align: right;">71.922</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.920058</td>
<td style="text-align: right;">-2.013007</td>
<td style="text-align: right;">24.90982</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.991</td>
<td style="text-align: right;">90.094</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.907904</td>
<td style="text-align: right;">-2.014400</td>
<td style="text-align: right;">25.10588</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.977</td>
<td style="text-align: right;">108.281</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.897036</td>
<td style="text-align: right;">-2.011603</td>
<td style="text-align: right;">25.31702</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.967</td>
<td style="text-align: right;">126.453</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb31-2"><a href="#cb31-2"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb33-2"><a href="#cb33-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb33-4"><a href="#cb33-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003751909 0.017612386</code></pre>
</div>
</div>
<p>计算可靠度并绘图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6048919 0.9074667 0.6817691 0.6014642</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb37-5"><a href="#cb37-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb37-6"><a href="#cb37-6"></a>}</span>
<span id="cb37-7"><a href="#cb37-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb37-8"><a href="#cb37-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb37-10"><a href="#cb37-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb37-11"><a href="#cb37-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb37-12"><a href="#cb37-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="激光器件-laser-数据集" class="level4">
<h4 class="anchored" data-anchor-id="激光器件-laser-数据集">3.2.2 激光器件 Laser 数据集</h4>
<blockquote class="blockquote">
<p>数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</p>
</blockquote>
<p>激光器件的质量特征是其<strong>工作电流</strong>。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9255</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1147</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7168</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5110</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1250</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb42-2"><a href="#cb42-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb42-4"><a href="#cb42-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00203768 0.01268431</code></pre>
</div>
</div>
<p>计算可靠度并绘图，阈值设置参考 Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety <strong>193</strong>. 第6节案例分析</p>
<p>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</p>
<blockquote class="blockquote">
<p>可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3995107</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb46-5"><a href="#cb46-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb46-6"><a href="#cb46-6"></a>}</span>
<span id="cb46-7"><a href="#cb46-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb46-8"><a href="#cb46-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb46-10"><a href="#cb46-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb46-11"><a href="#cb46-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb46-12"><a href="#cb46-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-13"><a href="#cb46-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb46-15"><a href="#cb46-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="炭膜电阻器-carbon-film-resistors" class="level4">
<h4 class="anchored" data-anchor-id="炭膜电阻器-carbon-film-resistors">3.2.3 炭膜电阻器 carbon-film resistors</h4>
<blockquote class="blockquote">
<p>退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</p>
</blockquote>
<p>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</p>
<p>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Percent.Increase</th>
<th style="text-align: left;">Resistor.ID</th>
<th style="text-align: right;">DegreesC</th>
<th style="text-align: right;">Thousands.of.Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.32</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.38</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">4.341</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">8.084</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.22</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb49-2"><a href="#cb49-2"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb49-9"><a href="#cb49-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Wiener-notebook_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>后续参数估计和可靠度估计就先不做了。</p>
<!-- 类似的数据集还包括： -->
<!-- #### 3.3.4 惯导平台 interial navigition 数据 -->
<!-- > 数据来自于文献：Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability **61**(1): 50-67. -->
<!-- 惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。 -->
<!-- 下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。 -->
<!-- 图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。 -->
<!-- ![](images/paste-40CEA295.png) -->
<!-- ```{r} -->
<!-- interial_dat = read.csv("dataset/interial_navigition.csv") -->
<!-- knitr::kable(head(interial_dat)) -->
<!-- ``` -->
<!-- 该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。 -->
<!-- ```{r} -->
<!-- interial_new = interial_dat %>%  -->
<!--   pivot_longer(`Item1`:`Item5`,  -->
<!--     names_to = "Product",  -->
<!--     values_to = "Value") -->
<!-- interial_new %>%  -->
<!--   ggplot(aes(time,Value)) +  -->
<!--   geom_line(aes(col = Product)) + -->
<!--   geom_point(aes(col = Product,shape = Product)) +  -->
<!--   scale_color_viridis(option = "D",discrete = T) +  -->
<!--   scale_x_continuous(limits = c(0, 25),breaks = seq(0,25,2.5)) + -->
<!--   theme_bw() +    -->
<!--   ylab("Condition monitoring time (hours)") + -->
<!--   xlab("Gyropic drift (/h)") +  -->
<!--   theme(panel.grid = element_blank(), -->
<!--         legend.position = "right")  -->
<!-- ``` -->
<!-- #### 3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy -->
<!-- > 数据来自： (Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability 61(1): 50-67). -->
<!-- 它是飞机上常用的金属材料，这种材料的完整性通过**疲劳裂纹的长度**来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。 -->
<!-- 对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。**退化过程存在非线性**。 -->
<!-- ```{r} -->
<!-- Alloy_dat = read.csv("dataset/2017-T4 Aluminum Alloy.csv") -->
<!-- knitr::kable(head(Alloy_dat)) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- Alloy_new = Alloy_dat %>%  -->
<!--   pivot_longer(`Item1`:`Item4`,  -->
<!--     names_to = "Product",  -->
<!--     values_to = "Value") -->
<!-- Alloy_new %>%  -->
<!--   ggplot(aes(Cycle,Value)) +  -->
<!--   geom_line(aes(col = Product)) + -->
<!--   geom_point(aes(col = Product,shape = Product)) +  -->
<!--   scale_color_viridis(option = "D",discrete = T) + -->
<!--   theme_bw() +    -->
<!--   ylab("Condition monitoring time (hours)") + -->
<!--   xlab("Gyropic drift (/h)") +  -->
<!--   theme(panel.grid = element_blank(), -->
<!--         legend.position = "right")  -->
<!-- ``` -->
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb50" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1"></a><span class="co">---</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="an">title:</span><span class="co"> "退化过程模型综述"</span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="an">author:</span><span class="co"> "庄亮亮"</span></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co">  html:</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="co">    toc: TRUE</span></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="co">    toc-title: "目录"</span></span>
<span id="cb50-9"><a href="#cb50-9"></a><span class="co">    theme: cerulean</span></span>
<span id="cb50-10"><a href="#cb50-10"></a><span class="co">    code-tools: true</span></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="co">    highlight-style: cerulean.theme</span></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="co">---</span></span>
<span id="cb50-18"><a href="#cb50-18"></a></span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb50-20"><a href="#cb50-20"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="in">```</span></span>
<span id="cb50-22"><a href="#cb50-22"></a></span>
<span id="cb50-23"><a href="#cb50-23"></a><span class="fu">## 1. 介绍</span></span>
<span id="cb50-24"><a href="#cb50-24"></a></span>
<span id="cb50-25"><a href="#cb50-25"></a>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在**基于退化的可靠性模型**方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</span>
<span id="cb50-26"><a href="#cb50-26"></a></span>
<span id="cb50-27"><a href="#cb50-27"></a><span class="ss">1.  </span>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</span>
<span id="cb50-28"><a href="#cb50-28"></a></span>
<span id="cb50-29"><a href="#cb50-29"></a><span class="ss">2.  </span>基于 Wiener 过程的模型</span>
<span id="cb50-30"><a href="#cb50-30"></a></span>
<span id="cb50-31"><a href="#cb50-31"></a><span class="ss">3.  </span>基于 Gamma 过程的模型</span>
<span id="cb50-32"><a href="#cb50-32"></a></span>
<span id="cb50-33"><a href="#cb50-33"></a><span class="ss">4.  </span>累积损伤模型(主要是基于混合 Poisson 过程的模型）</span>
<span id="cb50-34"><a href="#cb50-34"></a></span>
<span id="cb50-35"><a href="#cb50-35"></a><span class="ss">5.  </span>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</span>
<span id="cb50-36"><a href="#cb50-36"></a></span>
<span id="cb50-37"><a href="#cb50-37"></a>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究**矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法**，以及**非参数和半参数方法**等，解决模型辨识和修正问题;</span>
<span id="cb50-38"><a href="#cb50-38"></a></span>
<span id="cb50-39"><a href="#cb50-39"></a>采用**似然比检验、Bayes 因子分析**等方法进行模型验证;</span>
<span id="cb50-40"><a href="#cb50-40"></a></span>
<span id="cb50-41"><a href="#cb50-41"></a>采用**均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)**等进行模型优良性检验。</span>
<span id="cb50-42"><a href="#cb50-42"></a></span>
<span id="cb50-43"><a href="#cb50-43"></a>在基于退化的可靠性技术应用方面，针对**机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）**等的退化失效过程，开展**退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计**：特别是加速退化试验方案设计的研究。</span>
<span id="cb50-44"><a href="#cb50-44"></a></span>
<span id="cb50-45"><a href="#cb50-45"></a><span class="fu">## 2. 退化轨道模型</span></span>
<span id="cb50-46"><a href="#cb50-46"></a></span>
<span id="cb50-47"><a href="#cb50-47"></a><span class="at">&gt; 暂时不考虑</span></span>
<span id="cb50-48"><a href="#cb50-48"></a></span>
<span id="cb50-49"><a href="#cb50-49"></a><span class="fu">## 3. Wiener 退化过程模型</span></span>
<span id="cb50-50"><a href="#cb50-50"></a></span>
<span id="cb50-51"><a href="#cb50-51"></a>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</span>
<span id="cb50-52"><a href="#cb50-52"></a></span>
<span id="cb50-53"><a href="#cb50-53"></a>Wiener 退化过程的**首达时间分布具有解析形式**，便于对**产品寿命**和**可靠度**的分析和计算。</span>
<span id="cb50-54"><a href="#cb50-54"></a></span>
<span id="cb50-55"><a href="#cb50-55"></a>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</span>
<span id="cb50-56"><a href="#cb50-56"></a></span>
<span id="cb50-57"><a href="#cb50-57"></a>通过对经典 Wiener 过程的参数引入**随机性**，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</span>
<span id="cb50-58"><a href="#cb50-58"></a></span>
<span id="cb50-59"><a href="#cb50-59"></a><span class="at">&gt; 对 Wiener 退化过程及其观测过程所构成的**状态空间模型**，可以采用 **Kalman 滤波技术**进行处理，为产品**在线寿命预测、视情维修决策**等提供了可行的算法和实现途径。</span></span>
<span id="cb50-60"><a href="#cb50-60"></a></span>
<span id="cb50-61"><a href="#cb50-61"></a><span class="fu">### 3.1 带漂移的 Wiener 过程</span></span>
<span id="cb50-62"><a href="#cb50-62"></a></span>
<span id="cb50-63"><a href="#cb50-63"></a>称 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是漂移参数为 $\mu$ 、扩散参数为 $\sigma$ 的 (一元) Wiener 过程, 若</span>
<span id="cb50-64"><a href="#cb50-64"></a></span>
<span id="cb50-65"><a href="#cb50-65"></a>(1) $X(0)=0$。</span>
<span id="cb50-66"><a href="#cb50-66"></a></span>
<span id="cb50-67"><a href="#cb50-67"></a>(2) $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 有平稳独立增量。</span>
<span id="cb50-68"><a href="#cb50-68"></a></span>
<span id="cb50-69"><a href="#cb50-69"></a>(3) $X(t)$ 服从均值为 $\mu t$,方差为 $\sigma^2 t$ 的正态分布。</span>
<span id="cb50-70"><a href="#cb50-70"></a></span>
<span id="cb50-71"><a href="#cb50-71"></a>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: $$</span>
<span id="cb50-72"><a href="#cb50-72"></a>X(t)=\mu t+\sigma B(t)</span>
<span id="cb50-73"><a href="#cb50-73"></a>$$ 式中: $<span class="sc">\{</span>B(t)<span class="sc">\}</span>, t \geqslant 0$ 是标准 Wiener 过程或标准布朗运动过程。</span>
<span id="cb50-74"><a href="#cb50-74"></a></span>
<span id="cb50-75"><a href="#cb50-75"></a>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</span>
<span id="cb50-76"><a href="#cb50-76"></a></span>
<span id="cb50-77"><a href="#cb50-77"></a>（1）时刻 $t \sim t+\Delta t$ 之间的增量服从正态分布, 即 $\Delta X=X(t+\Delta t)-X(t) \sim$ $N\left(\mu \Delta t, \sigma^2 \Delta t\right)$ 。</span>
<span id="cb50-78"><a href="#cb50-78"></a></span>
<span id="cb50-79"><a href="#cb50-79"></a>(2) 对任意两个不相交的时间区间 $\left<span class="co">[</span><span class="ot">t_1, t_2\right</span><span class="co">]</span>,\left<span class="co">[</span><span class="ot">t_3, t_4\right</span><span class="co">]</span>, t_1<span class="kw">&lt;t_2</span> <span class="er">\leqslant</span> <span class="er">t_3&lt;t_4$,</span> <span class="er">增量</span> <span class="er">$X\left(t_4\right)-X$</span> <span class="er">$\left(t_3\right)$</span> <span class="er">与</span> <span class="er">$X\left(t_2\right)-X\left(t_1\right)$</span> <span class="er">相互独立。</span></span>
<span id="cb50-80"><a href="#cb50-80"></a></span>
<span id="cb50-81"><a href="#cb50-81"></a><span class="ot">*</span><span class="er">*可靠度**</span></span>
<span id="cb50-82"><a href="#cb50-82"></a></span>
<span id="cb50-83"><a href="#cb50-83"></a><span class="er">如果产品的性能退化过程是一元</span> <span class="er">Wiener</span> <span class="er">过程，失效阈值为$l$。</span> <span class="er">则可靠度为</span> <span class="er">$$</span></span>
<span id="cb50-84"><a href="#cb50-84"></a><span class="ot">R</span><span class="er">(t)</span><span class="ot">=</span> <span class="st">1-F(t</span> <span class="er">;</span> <span class="er">\mu,</span> <span class="er">\sigma)</span><span class="ot">=</span><span class="st">\Phi\left(\frac{l-\mu</span> <span class="er">t}{\sigma</span> <span class="er">\sqrt{t}}\right)-\exp</span> <span class="er">\left(\frac{2</span> <span class="er">\mu</span> <span class="er">l}{\sigma^2}\right)</span> <span class="er">\Phi\left(\frac{-l-\mu</span> <span class="er">t}{\sigma</span> <span class="er">\sqrt{t}}\right)</span></span>
<span id="cb50-85"><a href="#cb50-85"></a><span class="er">$$</span></span>
<span id="cb50-86"><a href="#cb50-86"></a></span>
<span id="cb50-87"><a href="#cb50-87"></a><span class="ot">*</span><span class="er">*剩余使用寿命**</span></span>
<span id="cb50-88"><a href="#cb50-88"></a></span>
<span id="cb50-89"><a href="#cb50-89"></a><span class="er">假设其运行到时刻</span> <span class="er">$\tau$</span> <span class="er">仍末失效,</span> <span class="er">且当前性能退化量为</span> <span class="er">$x_\tau\left(x_\tau&lt;l\right)$,</span> <span class="er">则产品的剩余寿命</span> <span class="er">$T_1$</span> <span class="er">可以表示为</span> <span class="er">$$</span></span>
<span id="cb50-90"><a href="#cb50-90"></a><span class="ot">T_1=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)</span> <span class="er">\geqslant</span> <span class="er">l,</span> <span class="er">X(\tau)</span><span class="ot">=</span><span class="st">x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb50-91"><a href="#cb50-91"></a><span class="er">$$</span> <span class="er">由一元</span> <span class="er">Wiener</span> <span class="er">过程的独立增量性质和齐次马尔可夫性得到</span> <span class="er">$$</span></span>
<span id="cb50-92"><a href="#cb50-92"></a><span class="er">\begin{aligned}</span></span>
<span id="cb50-93"><a href="#cb50-93"></a><span class="ot">T_1</span> <span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)-X(\tau)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span> <span class="er">\\</span></span>
<span id="cb50-94"><a href="#cb50-94"></a><span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb50-95"><a href="#cb50-95"></a><span class="er">\end{aligned}</span></span>
<span id="cb50-96"><a href="#cb50-96"></a><span class="er">$$</span> <span class="er">可知剩余寿命</span> <span class="er">$T_1$</span> <span class="er">也是逆</span> <span class="er">Gaussian</span> <span class="er">分布,</span> <span class="er">其密度函数只需将寿命</span> <span class="er">$T$</span> <span class="er">密度函数中的失效阈值</span> <span class="er">$l$</span> <span class="er">替换为</span> <span class="er">$l-x_\tau$,</span> <span class="er">即</span> <span class="er">$$f_{T_1}(t)</span><span class="ot">=</span><span class="st">\frac{l-x_\tau}{\sqrt{2</span> <span class="er">\pi</span> <span class="er">\sigma^2</span> <span class="er">t^3}}</span> <span class="er">\exp</span> <span class="er">\left[-\frac{\left(l-x_\tau-\mu</span> <span class="er">t\right)^2}{2</span> <span class="er">\sigma^2</span> <span class="er">t}\right]$$</span></span>
<span id="cb50-97"><a href="#cb50-97"></a></span>
<span id="cb50-100"><a href="#cb50-100"></a><span class="in">```{r}</span></span>
<span id="cb50-101"><a href="#cb50-101"></a><span class="ot">library</span><span class="er">(ggplot2)</span></span>
<span id="cb50-102"><a href="#cb50-102"></a><span class="ot">library</span><span class="er">(tidyverse)</span></span>
<span id="cb50-103"><a href="#cb50-103"></a><span class="ot">library</span><span class="er">(viridis)</span></span>
<span id="cb50-104"><a href="#cb50-104"></a><span class="er">```</span></span>
<span id="cb50-105"><a href="#cb50-105"></a></span>
<span id="cb50-106"><a href="#cb50-106"></a><span class="ot">#</span><span class="er">###</span> <span class="er">3.1.1</span> <span class="er">数据模拟产生</span></span>
<span id="cb50-107"><a href="#cb50-107"></a></span>
<span id="cb50-110"><a href="#cb50-110"></a><span class="in">```{r}</span></span>
<span id="cb50-111"><a href="#cb50-111"></a><span class="ot">#</span> <span class="er">数据模拟产生</span></span>
<span id="cb50-112"><a href="#cb50-112"></a><span class="ot">sim_dat</span> <span class="ot">=</span> <span class="st">function(group</span> <span class="ot">=</span> <span class="st">6,</span> <span class="er">t</span> <span class="ot">=</span> <span class="st">1:200,</span> <span class="er">para</span> <span class="ot">=</span> <span class="st">c(1,0.1)){</span></span>
<span id="cb50-113"><a href="#cb50-113"></a><span class="ot">  #</span> <span class="er">para</span> <span class="er">指</span> <span class="er">mu,sigma</span></span>
<span id="cb50-114"><a href="#cb50-114"></a><span class="ot">  #</span> <span class="er">epoch</span> <span class="er">指测量次数，</span> <span class="er">group</span> <span class="er">指组数</span></span>
<span id="cb50-115"><a href="#cb50-115"></a><span class="ot">  delta_t</span> <span class="ot">=</span> <span class="st">diff(t)</span></span>
<span id="cb50-116"><a href="#cb50-116"></a><span class="ot">  epoch</span> <span class="ot">=</span> <span class="st">length(delta_t)</span></span>
<span id="cb50-117"><a href="#cb50-117"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">matrix(NA,epoch,group+1)</span></span>
<span id="cb50-118"><a href="#cb50-118"></a><span class="ot">  dat</span><span class="er">[,1]</span> <span class="ot">=</span> <span class="st">seq(1,epoch)</span></span>
<span id="cb50-119"><a href="#cb50-119"></a><span class="ot">  dat_unit</span> <span class="ot">=</span> <span class="st">numeric()</span></span>
<span id="cb50-120"><a href="#cb50-120"></a><span class="ot">  for</span><span class="er">(i</span> <span class="er">in</span> <span class="er">1:group){</span></span>
<span id="cb50-121"><a href="#cb50-121"></a><span class="ot">    for</span><span class="er">(j</span> <span class="er">in</span> <span class="er">1:epoch)</span> <span class="er">dat_unit[j]</span> <span class="ot">=</span> <span class="st">rnorm(1,para[1]*delta_t[j],sqrt(para[2]^2*delta_t[j]))</span></span>
<span id="cb50-122"><a href="#cb50-122"></a><span class="ot">    dat</span><span class="er">[,i+1]</span> <span class="ot">=</span> <span class="st">cumsum(dat_unit)</span></span>
<span id="cb50-123"><a href="#cb50-123"></a>  <span class="er">}</span></span>
<span id="cb50-124"><a href="#cb50-124"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">data.frame(dat)</span></span>
<span id="cb50-125"><a href="#cb50-125"></a><span class="ot">  dat1</span> <span class="ot">=</span> <span class="st">rbind(rep(0,group+1),dat)</span> <span class="er">#</span> <span class="er">加入初始值绘制点</span></span>
<span id="cb50-126"><a href="#cb50-126"></a><span class="ot">  colnames</span><span class="er">(dat1)</span> <span class="ot">=</span> <span class="st">c(</span><span class="er">"Time",paste(1:group,sep</span><span class="ot">=</span><span class="st">''</span><span class="er">))</span></span>
<span id="cb50-127"><a href="#cb50-127"></a><span class="ot">  return</span><span class="er">(dat1)</span></span>
<span id="cb50-128"><a href="#cb50-128"></a><span class="er">}</span></span>
<span id="cb50-129"><a href="#cb50-129"></a><span class="er">```</span></span>
<span id="cb50-130"><a href="#cb50-130"></a></span>
<span id="cb50-131"><a href="#cb50-131"></a><span class="er">绘制退化路径图</span></span>
<span id="cb50-132"><a href="#cb50-132"></a></span>
<span id="cb50-135"><a href="#cb50-135"></a><span class="in">```{r}</span></span>
<span id="cb50-136"><a href="#cb50-136"></a><span class="ot">#</span> <span class="er">绘制退化路径图</span></span>
<span id="cb50-137"><a href="#cb50-137"></a><span class="ot">plot_path</span> <span class="ot">=</span> <span class="st">function(data</span> <span class="ot">=</span> <span class="st">dat1){</span></span>
<span id="cb50-138"><a href="#cb50-138"></a><span class="ot">    #</span> <span class="er">画图</span></span>
<span id="cb50-139"><a href="#cb50-139"></a><span class="ot">  p</span> <span class="ot">=</span> <span class="st">data</span> <span class="er">%</span><span class="kw">&gt;</span>% pivot_longer(paste(1:ncol(data<span class="co">[</span><span class="ot">,-1</span><span class="co">]</span>)), </span>
<span id="cb50-140"><a href="#cb50-140"></a>                       names_to = "Group", </span>
<span id="cb50-141"><a href="#cb50-141"></a>                       values_to = "y") %&gt;% </span>
<span id="cb50-142"><a href="#cb50-142"></a>    ggplot(aes(Time,y,color = Group)) + </span>
<span id="cb50-143"><a href="#cb50-143"></a>    geom_line() + </span>
<span id="cb50-144"><a href="#cb50-144"></a>    scale_color_viridis(discrete = T) + </span>
<span id="cb50-145"><a href="#cb50-145"></a>    ylab("Degradation") #+</span>
<span id="cb50-146"><a href="#cb50-146"></a>    #theme_bw() +</span>
<span id="cb50-147"><a href="#cb50-147"></a>    #theme(panel.grid = element_blank())</span>
<span id="cb50-148"><a href="#cb50-148"></a>  print(p)</span>
<span id="cb50-149"><a href="#cb50-149"></a>}</span>
<span id="cb50-150"><a href="#cb50-150"></a><span class="in">```</span></span>
<span id="cb50-151"><a href="#cb50-151"></a></span>
<span id="cb50-154"><a href="#cb50-154"></a><span class="in">```{r}</span></span>
<span id="cb50-155"><a href="#cb50-155"></a><span class="in">group = 6</span></span>
<span id="cb50-156"><a href="#cb50-156"></a><span class="in">t = 1:200</span></span>
<span id="cb50-157"><a href="#cb50-157"></a><span class="in">para = c(2,2)</span></span>
<span id="cb50-158"><a href="#cb50-158"></a><span class="in">dat = sim_dat(group = group, t = t, para = para)</span></span>
<span id="cb50-159"><a href="#cb50-159"></a><span class="in">knitr::kable(head(dat))</span></span>
<span id="cb50-160"><a href="#cb50-160"></a><span class="in">plot_path(dat)</span></span>
<span id="cb50-161"><a href="#cb50-161"></a><span class="in">```</span></span>
<span id="cb50-162"><a href="#cb50-162"></a></span>
<span id="cb50-163"><a href="#cb50-163"></a><span class="fu">#### 3.1.2 统计推断</span></span>
<span id="cb50-164"><a href="#cb50-164"></a></span>
<span id="cb50-165"><a href="#cb50-165"></a>假设共有 $n$ 个样品进行性能退化试验。样品 $i$ 初始时刻 $t_{i 0}$ 退化量取值为 $X_{i 0}=0$, 在 时刻 $t_{i 1}, \cdots, t_{i m_i}$ 样品 $i$ 退化量为 $X_{i 1}, \cdots, X_{i m_i}$ 。记 $\Delta X_{i j}=X_{i j}-X_{i, j-1}$ 是样品 $i$ 在时刻 $t_{i, j-1} \sim t_{i j}$ 之间的退化增量, $\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n$ 为各样品的测量间隔。</span>
<span id="cb50-166"><a href="#cb50-166"></a></span>
<span id="cb50-167"><a href="#cb50-167"></a><span class="fu">##### 3.1.2.1 极大似然估计</span></span>
<span id="cb50-168"><a href="#cb50-168"></a></span>
<span id="cb50-169"><a href="#cb50-169"></a>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 $$</span>
<span id="cb50-170"><a href="#cb50-170"></a>\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)</span>
<span id="cb50-171"><a href="#cb50-171"></a>$$</span>
<span id="cb50-172"><a href="#cb50-172"></a></span>
<span id="cb50-173"><a href="#cb50-173"></a>于是由退化数据 $X_{i j}=x_{i j}$ (等价的, $\Delta X_{i j}=\Delta x_{i j}$ ) $, j=1,2, \cdots, m_i, i=1,2, \cdots, n$, 得到模型参数的似然函数为 $$</span>
<span id="cb50-174"><a href="#cb50-174"></a>L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left<span class="co">[</span><span class="ot">-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb50-175"><a href="#cb50-175"></a>$$ 由式可以直接求得漂移参数 $\mu$ 和扩散参数 $\sigma^2$ 的极大似然估计如下: $$</span>
<span id="cb50-176"><a href="#cb50-176"></a>\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left<span class="co">[</span><span class="ot">\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right</span><span class="co">]</span></span>
<span id="cb50-177"><a href="#cb50-177"></a>$$</span>
<span id="cb50-178"><a href="#cb50-178"></a></span>
<span id="cb50-181"><a href="#cb50-181"></a><span class="in">```{r}</span></span>
<span id="cb50-182"><a href="#cb50-182"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb50-183"><a href="#cb50-183"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb50-184"><a href="#cb50-184"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb50-185"><a href="#cb50-185"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb50-186"><a href="#cb50-186"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb50-187"><a href="#cb50-187"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb50-188"><a href="#cb50-188"></a>  }</span>
<span id="cb50-189"><a href="#cb50-189"></a>  <span class="fu">return</span>(re)</span>
<span id="cb50-190"><a href="#cb50-190"></a>}</span>
<span id="cb50-191"><a href="#cb50-191"></a><span class="in">```</span></span>
<span id="cb50-192"><a href="#cb50-192"></a></span>
<span id="cb50-195"><a href="#cb50-195"></a><span class="in">```{r}</span></span>
<span id="cb50-196"><a href="#cb50-196"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb50-197"><a href="#cb50-197"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb50-198"><a href="#cb50-198"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb50-199"><a href="#cb50-199"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb50-200"><a href="#cb50-200"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb50-201"><a href="#cb50-201"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb50-202"><a href="#cb50-202"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb50-203"><a href="#cb50-203"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb50-204"><a href="#cb50-204"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb50-205"><a href="#cb50-205"></a></span>
<span id="cb50-206"><a href="#cb50-206"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb50-207"><a href="#cb50-207"></a></span>
<span id="cb50-208"><a href="#cb50-208"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb50-209"><a href="#cb50-209"></a>}</span>
<span id="cb50-210"><a href="#cb50-210"></a></span>
<span id="cb50-211"><a href="#cb50-211"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb50-212"><a href="#cb50-212"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-213"><a href="#cb50-213"></a><span class="co"># mle_re</span></span>
<span id="cb50-214"><a href="#cb50-214"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb50-215"><a href="#cb50-215"></a><span class="co"># 区间估计</span></span>
<span id="cb50-216"><a href="#cb50-216"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb50-217"><a href="#cb50-217"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb50-218"><a href="#cb50-218"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb50-219"><a href="#cb50-219"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb50-220"><a href="#cb50-220"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span>
<span id="cb50-221"><a href="#cb50-221"></a><span class="in">```</span></span>
<span id="cb50-222"><a href="#cb50-222"></a></span>
<span id="cb50-223"><a href="#cb50-223"></a>为了得到产品可靠度的估计, 只要将 $\hat{\mu} 、 \hat{\sigma}^2$ 代人任务时间 $t$ 的可靠度的表达式。</span>
<span id="cb50-224"><a href="#cb50-224"></a></span>
<span id="cb50-225"><a href="#cb50-225"></a><span class="in">```{r,collapse=TRUE}</span></span>
<span id="cb50-226"><a href="#cb50-226"></a><span class="do">## 可靠度计算</span></span>
<span id="cb50-227"><a href="#cb50-227"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb50-228"><a href="#cb50-228"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb50-229"><a href="#cb50-229"></a>  <span class="fu">return</span>(R)</span>
<span id="cb50-230"><a href="#cb50-230"></a>}</span>
<span id="cb50-231"><a href="#cb50-231"></a></span>
<span id="cb50-232"><a href="#cb50-232"></a><span class="in">```</span></span>
<span id="cb50-233"><a href="#cb50-233"></a></span>
<span id="cb50-234"><a href="#cb50-234"></a>给个简单例子</span>
<span id="cb50-235"><a href="#cb50-235"></a></span>
<span id="cb50-238"><a href="#cb50-238"></a><span class="in">```{r}</span></span>
<span id="cb50-239"><a href="#cb50-239"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb50-240"><a href="#cb50-240"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb50-241"><a href="#cb50-241"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb50-242"><a href="#cb50-242"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb50-243"><a href="#cb50-243"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb50-244"><a href="#cb50-244"></a></span>
<span id="cb50-245"><a href="#cb50-245"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb50-246"><a href="#cb50-246"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb50-247"><a href="#cb50-247"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-248"><a href="#cb50-248"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb50-249"><a href="#cb50-249"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-250"><a href="#cb50-250"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span>
<span id="cb50-251"><a href="#cb50-251"></a><span class="in">```</span></span>
<span id="cb50-252"><a href="#cb50-252"></a></span>
<span id="cb50-253"><a href="#cb50-253"></a>剩余使用寿命</span>
<span id="cb50-254"><a href="#cb50-254"></a></span>
<span id="cb50-257"><a href="#cb50-257"></a><span class="in">```{r}</span></span>
<span id="cb50-258"><a href="#cb50-258"></a><span class="do">## 剩余使用寿命计算</span></span>
<span id="cb50-259"><a href="#cb50-259"></a>RUL_density <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">cur_time =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par){</span>
<span id="cb50-260"><a href="#cb50-260"></a>  RUL <span class="ot">=</span> (threshold <span class="sc">-</span> cur_time)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>mle_par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">3</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(threshold<span class="sc">-</span>cur_time <span class="sc">-</span> mle_par[<span class="dv">1</span>] <span class="sc">*</span> t)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> mle_par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> t)) </span>
<span id="cb50-261"><a href="#cb50-261"></a>  <span class="fu">return</span>(RUL)</span>
<span id="cb50-262"><a href="#cb50-262"></a>}</span>
<span id="cb50-263"><a href="#cb50-263"></a><span class="in">```</span></span>
<span id="cb50-264"><a href="#cb50-264"></a></span>
<span id="cb50-265"><a href="#cb50-265"></a>给一个简单例子，当前时刻为10，计算对应的RUL密度函数</span>
<span id="cb50-266"><a href="#cb50-266"></a></span>
<span id="cb50-269"><a href="#cb50-269"></a><span class="in">```{r}</span></span>
<span id="cb50-270"><a href="#cb50-270"></a>rul_den <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">cur_time =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb50-271"><a href="#cb50-271"></a><span class="fu">plot</span>(rul_den,<span class="at">type =</span> <span class="st">'l'</span>,<span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"RUL"</span>)</span>
<span id="cb50-272"><a href="#cb50-272"></a><span class="in">```</span></span>
<span id="cb50-273"><a href="#cb50-273"></a></span>
<span id="cb50-274"><a href="#cb50-274"></a>计算未来某些时刻（<span class="in">`fut_time  = c(50,55,60,65,70,75,80)`</span>）的RUL（<span class="in">`time_epoch = 1:100`</span>），并绘制3D图形。</span>
<span id="cb50-275"><a href="#cb50-275"></a></span>
<span id="cb50-278"><a href="#cb50-278"></a><span class="in">```{r}</span></span>
<span id="cb50-279"><a href="#cb50-279"></a>fut_time <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">55</span>,<span class="dv">60</span>,<span class="dv">65</span>,<span class="dv">70</span>,<span class="dv">75</span>,<span class="dv">80</span>)</span>
<span id="cb50-280"><a href="#cb50-280"></a>time_epoch <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb50-281"><a href="#cb50-281"></a>rul_den <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(time_epoch),<span class="fu">length</span>(fut_time))</span>
<span id="cb50-282"><a href="#cb50-282"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb50-283"><a href="#cb50-283"></a>  rul_den[,i] <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> time_epoch, <span class="at">cur_time =</span> fut_time[i], <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb50-284"><a href="#cb50-284"></a>}</span>
<span id="cb50-285"><a href="#cb50-285"></a><span class="fu">dim</span>(rul_den)</span>
<span id="cb50-286"><a href="#cb50-286"></a><span class="in">```</span></span>
<span id="cb50-287"><a href="#cb50-287"></a></span>
<span id="cb50-288"><a href="#cb50-288"></a>使用真实参数值计算RUL值。</span>
<span id="cb50-289"><a href="#cb50-289"></a></span>
<span id="cb50-292"><a href="#cb50-292"></a><span class="in">```{r}</span></span>
<span id="cb50-293"><a href="#cb50-293"></a><span class="co"># 真实数据</span></span>
<span id="cb50-294"><a href="#cb50-294"></a>true_rul_den <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(time_epoch),<span class="fu">length</span>(fut_time))</span>
<span id="cb50-295"><a href="#cb50-295"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb50-296"><a href="#cb50-296"></a>  true_rul_den[,i] <span class="ot">=</span> <span class="fu">RUL_density</span>(<span class="at">t =</span> time_epoch, <span class="at">cur_time =</span> fut_time[i], <span class="at">threshold =</span> <span class="dv">150</span>, <span class="at">par =</span> par)</span>
<span id="cb50-297"><a href="#cb50-297"></a>}</span>
<span id="cb50-298"><a href="#cb50-298"></a>real_RUL <span class="ot">=</span> <span class="fu">apply</span>(true_rul_den,<span class="dv">2</span>,which.max)</span>
<span id="cb50-299"><a href="#cb50-299"></a>real_RUL</span>
<span id="cb50-300"><a href="#cb50-300"></a><span class="in">```</span></span>
<span id="cb50-301"><a href="#cb50-301"></a></span>
<span id="cb50-304"><a href="#cb50-304"></a><span class="in">```{r}</span></span>
<span id="cb50-305"><a href="#cb50-305"></a><span class="co"># 未来时刻fut_time下的RUL值</span></span>
<span id="cb50-306"><a href="#cb50-306"></a>RUL_3D_density <span class="ot">=</span> <span class="cf">function</span>(fut_time,time_epoch,rul_den,</span>
<span id="cb50-307"><a href="#cb50-307"></a>                          threshold,real_RUL,</span>
<span id="cb50-308"><a href="#cb50-308"></a>                          <span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)){</span>
<span id="cb50-309"><a href="#cb50-309"></a>  <span class="fu">library</span>(plot3D)</span>
<span id="cb50-310"><a href="#cb50-310"></a>  col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#02B1e6"</span>, <span class="st">"#E81D22"</span>, <span class="st">"#F9BC15"</span>, <span class="st">"#8015f9"</span>, <span class="st">"#20e81d"</span>, <span class="st">"#e64602"</span>,<span class="st">"black"</span>)</span>
<span id="cb50-311"><a href="#cb50-311"></a>  <span class="fu">scatter3D</span>(time_epoch, <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(time_epoch)), rul_den[,<span class="dv">1</span>], <span class="at">bty =</span> <span class="st">"b2"</span>,<span class="at">colkey =</span> <span class="cn">FALSE</span>,</span>
<span id="cb50-312"><a href="#cb50-312"></a>          <span class="at">phi =</span> <span class="dv">14</span>,<span class="at">theta =</span> <span class="dv">55</span>,</span>
<span id="cb50-313"><a href="#cb50-313"></a>          <span class="at">pch =</span> <span class="dv">18</span>,<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">expand =</span><span class="fl">0.2</span>,<span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb50-314"><a href="#cb50-314"></a>          <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb50-315"><a href="#cb50-315"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(fut_time)<span class="sc">-</span><span class="dv">5</span>,<span class="fu">max</span>(fut_time)<span class="sc">+</span><span class="dv">5</span>),</span>
<span id="cb50-316"><a href="#cb50-316"></a>          <span class="at">zlim =</span> zlim,</span>
<span id="cb50-317"><a href="#cb50-317"></a>          <span class="at">xlab =</span> <span class="st">"RUL"</span>, <span class="at">ylab =</span> <span class="st">"Time"</span>, <span class="at">zlab =</span> <span class="st">"Kernel Distribution"</span>)</span>
<span id="cb50-318"><a href="#cb50-318"></a><span class="co"># 循环绘制3D图形</span></span>
<span id="cb50-319"><a href="#cb50-319"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb50-320"><a href="#cb50-320"></a>  <span class="co"># 密度函数</span></span>
<span id="cb50-321"><a href="#cb50-321"></a>  <span class="fu">scatter3D</span>(time_epoch, <span class="fu">rep</span>(fut_time[i],<span class="fu">length</span>(time_epoch)), rul_den[,i], </span>
<span id="cb50-322"><a href="#cb50-322"></a>            <span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">type =</span><span class="st">'l'</span>, <span class="at">col =</span> col[i], <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb50-323"><a href="#cb50-323"></a>  <span class="co"># 预测值</span></span>
<span id="cb50-324"><a href="#cb50-324"></a>   <span class="fu">scatter3D</span>(<span class="fu">which.max</span>(rul_den[,i]), fut_time[i], <span class="dv">0</span>, </span>
<span id="cb50-325"><a href="#cb50-325"></a>             <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">type =</span><span class="st">'h'</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb50-326"><a href="#cb50-326"></a>   <span class="co"># 真实值</span></span>
<span id="cb50-327"><a href="#cb50-327"></a>   <span class="fu">scatter3D</span>(real_RUL[i],fut_time[i], <span class="dv">0</span>,</span>
<span id="cb50-328"><a href="#cb50-328"></a>             <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">type =</span><span class="st">'h'</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">5</span>)</span>
<span id="cb50-329"><a href="#cb50-329"></a>}</span>
<span id="cb50-330"><a href="#cb50-330"></a><span class="fu">legend</span>(<span class="st">"top"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"RUL distribution"</span>,<span class="st">"Point estimation"</span>,<span class="st">"Real value"</span>),</span>
<span id="cb50-331"><a href="#cb50-331"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">16</span>,<span class="dv">5</span>), <span class="at">col =</span> <span class="fu">c</span>(col[<span class="dv">1</span>],<span class="st">"black"</span>,<span class="st">"red"</span>),<span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>)) <span class="co">#,inset = .05</span></span>
<span id="cb50-332"><a href="#cb50-332"></a><span class="co"># 7.8,6.4</span></span>
<span id="cb50-333"><a href="#cb50-333"></a>}</span>
<span id="cb50-334"><a href="#cb50-334"></a><span class="in">```</span></span>
<span id="cb50-335"><a href="#cb50-335"></a></span>
<span id="cb50-338"><a href="#cb50-338"></a><span class="in">```{r}</span></span>
<span id="cb50-339"><a href="#cb50-339"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb50-340"><a href="#cb50-340"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb50-341"><a href="#cb50-341"></a><span class="fu">RUL_3D_density</span>(fut_time,time_epoch,rul_den,threshold,real_RUL,<span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.08</span>))</span>
<span id="cb50-342"><a href="#cb50-342"></a><span class="in">```</span></span>
<span id="cb50-343"><a href="#cb50-343"></a></span>
<span id="cb50-344"><a href="#cb50-344"></a><span class="fu">##### 3.1.2.2 贝叶斯分析</span></span>
<span id="cb50-345"><a href="#cb50-345"></a></span>
<span id="cb50-346"><a href="#cb50-346"></a>基于 rstan 进行贝叶斯估计。详细的参考文献如下：</span>
<span id="cb50-347"><a href="#cb50-347"></a></span>
<span id="cb50-348"><a href="#cb50-348"></a><span class="ss">-   </span>最新、入门级别 <span class="co">[</span><span class="ot">rstan</span><span class="co">](https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html)</span> 资料。</span>
<span id="cb50-349"><a href="#cb50-349"></a></span>
<span id="cb50-350"><a href="#cb50-350"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">官网资料</span><span class="co">](https://mc-stan.org/users/interfaces/rstan)</span></span>
<span id="cb50-351"><a href="#cb50-351"></a></span>
<span id="cb50-352"><a href="#cb50-352"></a>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</span>
<span id="cb50-353"><a href="#cb50-353"></a></span>
<span id="cb50-354"><a href="#cb50-354"></a>$$</span>
<span id="cb50-355"><a href="#cb50-355"></a>\begin{aligned}</span>
<span id="cb50-356"><a href="#cb50-356"></a>&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),<span class="sc">\\</span></span>
<span id="cb50-357"><a href="#cb50-357"></a>&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),<span class="sc">\\</span></span>
<span id="cb50-358"><a href="#cb50-358"></a>&amp; \mu|w \sim N(d,\frac{c}{w}).</span>
<span id="cb50-359"><a href="#cb50-359"></a>\end{aligned}</span>
<span id="cb50-360"><a href="#cb50-360"></a>$$</span>
<span id="cb50-361"><a href="#cb50-361"></a></span>
<span id="cb50-362"><a href="#cb50-362"></a>其中，$a = b = 1, d = 0, c =100$。</span>
<span id="cb50-363"><a href="#cb50-363"></a></span>
<span id="cb50-364"><a href="#cb50-364"></a>构建模型（<span class="in">`wiener_linear.stan`</span>）</span>
<span id="cb50-365"><a href="#cb50-365"></a></span>
<span id="cb50-366"><a href="#cb50-366"></a><span class="in">``` markdown</span></span>
<span id="cb50-367"><a href="#cb50-367"></a>data {</span>
<span id="cb50-368"><a href="#cb50-368"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb50-369"><a href="#cb50-369"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb50-370"><a href="#cb50-370"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb50-371"><a href="#cb50-371"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb50-372"><a href="#cb50-372"></a>}</span>
<span id="cb50-373"><a href="#cb50-373"></a></span>
<span id="cb50-374"><a href="#cb50-374"></a>parameters {</span>
<span id="cb50-375"><a href="#cb50-375"></a>  real mu;</span>
<span id="cb50-376"><a href="#cb50-376"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb50-377"><a href="#cb50-377"></a>}</span>
<span id="cb50-378"><a href="#cb50-378"></a></span>
<span id="cb50-379"><a href="#cb50-379"></a>model {</span>
<span id="cb50-380"><a href="#cb50-380"></a>  w ~ gamma(1,1);</span>
<span id="cb50-381"><a href="#cb50-381"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb50-382"><a href="#cb50-382"></a>  for (i in 1:I){</span>
<span id="cb50-383"><a href="#cb50-383"></a>    for (j in 1:J) {</span>
<span id="cb50-384"><a href="#cb50-384"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb50-385"><a href="#cb50-385"></a>    }</span>
<span id="cb50-386"><a href="#cb50-386"></a>  }</span>
<span id="cb50-387"><a href="#cb50-387"></a>}</span>
<span id="cb50-388"><a href="#cb50-388"></a><span class="in">```</span></span>
<span id="cb50-389"><a href="#cb50-389"></a></span>
<span id="cb50-390"><a href="#cb50-390"></a><span class="at">&gt; 存在问题：这里的normal中，sigma是标准差还是方差？</span></span>
<span id="cb50-391"><a href="#cb50-391"></a></span>
<span id="cb50-392"><a href="#cb50-392"></a><span class="ss">-   </span>数据准备</span>
<span id="cb50-393"><a href="#cb50-393"></a></span>
<span id="cb50-394"><a href="#cb50-394"></a>准备$\Delta t_{ij}$ 和 $\Delta x_{ij}$的数据，并且标志出矩阵的维数。</span>
<span id="cb50-395"><a href="#cb50-395"></a></span>
<span id="cb50-398"><a href="#cb50-398"></a><span class="in">```{r}</span></span>
<span id="cb50-399"><a href="#cb50-399"></a><span class="co"># 数据准备</span></span>
<span id="cb50-400"><a href="#cb50-400"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb50-401"><a href="#cb50-401"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb50-402"><a href="#cb50-402"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb50-403"><a href="#cb50-403"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb50-404"><a href="#cb50-404"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb50-405"><a href="#cb50-405"></a><span class="fu">dim</span>(delta_y)</span>
<span id="cb50-406"><a href="#cb50-406"></a></span>
<span id="cb50-407"><a href="#cb50-407"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb50-408"><a href="#cb50-408"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb50-409"><a href="#cb50-409"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb50-410"><a href="#cb50-410"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb50-411"><a href="#cb50-411"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb50-412"><a href="#cb50-412"></a>)</span>
<span id="cb50-413"><a href="#cb50-413"></a><span class="fu">dim</span>(delta_y)</span>
<span id="cb50-414"><a href="#cb50-414"></a><span class="in">```</span></span>
<span id="cb50-415"><a href="#cb50-415"></a></span>
<span id="cb50-418"><a href="#cb50-418"></a><span class="in">```{r}</span></span>
<span id="cb50-419"><a href="#cb50-419"></a><span class="co">#| warning: false</span></span>
<span id="cb50-420"><a href="#cb50-420"></a><span class="co">#| message: false</span></span>
<span id="cb50-421"><a href="#cb50-421"></a><span class="co"># 后验抽样</span></span>
<span id="cb50-422"><a href="#cb50-422"></a><span class="fu">library</span>(rstan)</span>
<span id="cb50-423"><a href="#cb50-423"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb50-424"><a href="#cb50-424"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-425"><a href="#cb50-425"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb50-426"><a href="#cb50-426"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb50-427"><a href="#cb50-427"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb50-428"><a href="#cb50-428"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb50-429"><a href="#cb50-429"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb50-430"><a href="#cb50-430"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb50-431"><a href="#cb50-431"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb50-432"><a href="#cb50-432"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb50-433"><a href="#cb50-433"></a>)</span>
<span id="cb50-434"><a href="#cb50-434"></a><span class="in">```</span></span>
<span id="cb50-435"><a href="#cb50-435"></a></span>
<span id="cb50-436"><a href="#cb50-436"></a>输出各个参数的后验估计结果并进行绘制。</span>
<span id="cb50-437"><a href="#cb50-437"></a></span>
<span id="cb50-440"><a href="#cb50-440"></a><span class="in">```{r}</span></span>
<span id="cb50-441"><a href="#cb50-441"></a><span class="fu">print</span>(fit1,</span>
<span id="cb50-442"><a href="#cb50-442"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span>
<span id="cb50-443"><a href="#cb50-443"></a></span>
<span id="cb50-444"><a href="#cb50-444"></a><span class="fu">plot</span>(fit1)</span>
<span id="cb50-445"><a href="#cb50-445"></a></span>
<span id="cb50-446"><a href="#cb50-446"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb50-447"><a href="#cb50-447"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb50-448"><a href="#cb50-448"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-449"><a href="#cb50-449"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb50-450"><a href="#cb50-450"></a><span class="in">```</span></span>
<span id="cb50-451"><a href="#cb50-451"></a></span>
<span id="cb50-452"><a href="#cb50-452"></a>可以看出，效果较好。真实值为：$\mu = 2,w = 1 / \sigma^2 = 0.25$，估计值为：$\mu = 2,w = 1 / \sigma^2 = 0.5$。 估计值的$\sigma^2$ 有些问题，应该如何处理？</span>
<span id="cb50-453"><a href="#cb50-453"></a></span>
<span id="cb50-454"><a href="#cb50-454"></a><span class="fu">##### 3.1.2.3 客观贝叶斯分析</span></span>
<span id="cb50-455"><a href="#cb50-455"></a></span>
<span id="cb50-456"><a href="#cb50-456"></a>暂时还未找到，最经典的维纳过程客观贝叶斯分析。</span>
<span id="cb50-457"><a href="#cb50-457"></a></span>
<span id="cb50-458"><a href="#cb50-458"></a><span class="ss">-   </span>维纳（线性） + 随机效应：</span>
<span id="cb50-459"><a href="#cb50-459"></a></span>
<span id="cb50-460"><a href="#cb50-460"></a><span class="fu">##### 3.1.2.4 广义推断方法</span></span>
<span id="cb50-461"><a href="#cb50-461"></a></span>
<span id="cb50-462"><a href="#cb50-462"></a>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</span>
<span id="cb50-463"><a href="#cb50-463"></a></span>
<span id="cb50-464"><a href="#cb50-464"></a><span class="ss">-   </span>维纳（线性） + 随机效应：</span>
<span id="cb50-465"><a href="#cb50-465"></a></span>
<span id="cb50-466"><a href="#cb50-466"></a>Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety 193.</span>
<span id="cb50-467"><a href="#cb50-467"></a></span>
<span id="cb50-468"><a href="#cb50-468"></a><span class="ss">-   </span>维纳（线性）+ 加速寿命试验 + 随机效应：</span>
<span id="cb50-469"><a href="#cb50-469"></a></span>
<span id="cb50-470"><a href="#cb50-470"></a>Wang, X. F., et al. (2020). "Reliability analysis for accelerated degradation data based on the Wiener process with random effects." Quality and Reliability Engineering International 36(6): 1969-1981.</span>
<span id="cb50-471"><a href="#cb50-471"></a></span>
<span id="cb50-472"><a href="#cb50-472"></a>Hong, L., et al. (2018). "Interval estimation for Wiener processes based on accelerated degradation test data." IISE Transactions 50(12): 1043-1057.</span>
<span id="cb50-473"><a href="#cb50-473"></a></span>
<span id="cb50-474"><a href="#cb50-474"></a><span class="ss">-   </span>伽马 + 随机过程</span>
<span id="cb50-475"><a href="#cb50-475"></a></span>
<span id="cb50-476"><a href="#cb50-476"></a>Wang, X. F., et al. (2021). "Degradation data analysis based on gamma process with random effects." European Journal of Operational Research 292(3): 1200-1208.</span>
<span id="cb50-477"><a href="#cb50-477"></a></span>
<span id="cb50-478"><a href="#cb50-478"></a><span class="ss">-   </span>伽马 + 加速寿命试验</span>
<span id="cb50-479"><a href="#cb50-479"></a></span>
<span id="cb50-480"><a href="#cb50-480"></a>Jiang, P. H., et al. (2019). "Inference for constant-stress accelerated degradation test based on Gamma process." Applied Mathematical Modelling 67: 123-134.</span>
<span id="cb50-481"><a href="#cb50-481"></a></span>
<span id="cb50-482"><a href="#cb50-482"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 3.2 多应力和动态环境情形 --&gt;</span></span>
<span id="cb50-483"><a href="#cb50-483"></a></span>
<span id="cb50-484"><a href="#cb50-484"></a><span class="co">&lt;!-- **1. 多应力情形** --&gt;</span></span>
<span id="cb50-485"><a href="#cb50-485"></a></span>
<span id="cb50-486"><a href="#cb50-486"></a><span class="co">&lt;!-- 某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。 --&gt;</span></span>
<span id="cb50-487"><a href="#cb50-487"></a></span>
<span id="cb50-488"><a href="#cb50-488"></a><span class="co">&lt;!-- 假设在不同应力下, 一元 Wiener 过程模型的参数是应力 $S$ 的函数 $$ --&gt;</span></span>
<span id="cb50-489"><a href="#cb50-489"></a></span>
<span id="cb50-490"><a href="#cb50-490"></a><span class="co">&lt;!-- \mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right) --&gt;</span></span>
<span id="cb50-491"><a href="#cb50-491"></a></span>
<span id="cb50-492"><a href="#cb50-492"></a><span class="co">&lt;!-- $$ 式中: $\theta_\mu 、 \theta_\sigma$ 是末知参数向量。 --&gt;</span></span>
<span id="cb50-493"><a href="#cb50-493"></a></span>
<span id="cb50-494"><a href="#cb50-494"></a><span class="co">&lt;!-- 对不同类型应力, $\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)$ 的形式和参数不同。比如对漂移参数 $\mu$, 应力 为温度时通常采用阿伦尼斯模型进行描述 $$ --&gt;</span></span>
<span id="cb50-495"><a href="#cb50-495"></a></span>
<span id="cb50-496"><a href="#cb50-496"></a><span class="co">&lt;!-- \mu(S)=a \mathrm{e}^{-b / S} --&gt;</span></span>
<span id="cb50-497"><a href="#cb50-497"></a></span>
<span id="cb50-498"><a href="#cb50-498"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-499"><a href="#cb50-499"></a></span>
<span id="cb50-500"><a href="#cb50-500"></a><span class="co">&lt;!-- 如果应力是电压、功率等, 则通常采用幂律模型 $$ --&gt;</span></span>
<span id="cb50-501"><a href="#cb50-501"></a></span>
<span id="cb50-502"><a href="#cb50-502"></a><span class="co">&lt;!-- \mu(S)=a S^b --&gt;</span></span>
<span id="cb50-503"><a href="#cb50-503"></a></span>
<span id="cb50-504"><a href="#cb50-504"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-505"><a href="#cb50-505"></a></span>
<span id="cb50-506"><a href="#cb50-506"></a><span class="co">&lt;!-- 根据加速退化试验中应力的变化情况,加速退化试验又分别为**恒定应力加速退化试验**、**步进应力加速退化试验**和**序进应力加速退化试验**。 --&gt;</span></span>
<span id="cb50-507"><a href="#cb50-507"></a></span>
<span id="cb50-508"><a href="#cb50-508"></a><span class="co">&lt;!-- 恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。 --&gt;</span></span>
<span id="cb50-509"><a href="#cb50-509"></a></span>
<span id="cb50-510"><a href="#cb50-510"></a><span class="co">&lt;!-- 设产品在 $S_0, S_1, \cdots, S_s$ 共 $s+1$ 个应力下进行退化试验, 其中应力 $S_0$ 为正常工作应 力。应力 $S_i$ 下共得到 $n_i$ 个产品的性能退化数据, 其中对产品 $j$, 初始时刻 $t_{i j 0}$ 的退化量 为 $X_{i j 0}=0$, 分别在时刻 $t_{i j 1}, \cdots, t_{i j m_{i j}}$ 测量其性能退化量 $X_{i j 1}, \cdots, X_{i j m_{i j}}$, 其中 $i=0,1, \cdots, s, j=$ $1,2, \cdots, n_i$ 记 $\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}$, 其中 $k=1,2, \cdots, m_{i j}$ 。由各应力下 的退化数据 $\left\{\Delta x_{i j k}\right\}$ 得到模型参数的似然函数为 $$ --&gt;</span></span>
<span id="cb50-511"><a href="#cb50-511"></a></span>
<span id="cb50-512"><a href="#cb50-512"></a><span class="co">&lt;!-- L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k</span><span class="re">}}}</span><span class="co"> \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right] --&gt;</span></span>
<span id="cb50-513"><a href="#cb50-513"></a></span>
<span id="cb50-514"><a href="#cb50-514"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-515"><a href="#cb50-515"></a></span>
<span id="cb50-516"><a href="#cb50-516"></a><span class="co">&lt;!-- 则参数 $\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma$ 的极大似然估计 $\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma$ 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 $S_0$ 下参数 $\mu 、 \sigma^2$ 为 $$ --&gt;</span></span>
<span id="cb50-517"><a href="#cb50-517"></a></span>
<span id="cb50-518"><a href="#cb50-518"></a><span class="co">&lt;!-- \mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right) --&gt;</span></span>
<span id="cb50-519"><a href="#cb50-519"></a></span>
<span id="cb50-520"><a href="#cb50-520"></a><span class="co">&lt;!-- $$ 产品可靠度点估计可由式 (3.42)得到。 --&gt;</span></span>
<span id="cb50-521"><a href="#cb50-521"></a></span>
<span id="cb50-522"><a href="#cb50-522"></a><span class="co">&lt;!-- **2. 动态环境情形** --&gt;</span></span>
<span id="cb50-523"><a href="#cb50-523"></a></span>
<span id="cb50-524"><a href="#cb50-524"></a><span class="co">&lt;!-- 与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 $\{S$ $(t), t \geqslant 0\}$, 并且假设应力对退化速率的影响函数为 $\beta_0 \cdot h(S(t) ; b)$, 其中 $\beta_0$ 是基准应 力下的退化速率, 以 $b$ 为参数的函数 $h(S(t) ; b)$ 表示应力的影响, $b$ 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 $t$ 产品退化量取值为 $$ --&gt;</span></span>
<span id="cb50-525"><a href="#cb50-525"></a></span>
<span id="cb50-526"><a href="#cb50-526"></a><span class="co">&lt;!-- X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t) --&gt;</span></span>
<span id="cb50-527"><a href="#cb50-527"></a></span>
<span id="cb50-528"><a href="#cb50-528"></a><span class="co">&lt;!-- $$ 式中: $\{S(\tau), 0 \leqslant \tau \leqslant t\}$ 为 $[0, \tau]$ 内的应力; $\{B(t), t \geqslant 0\}$ 为标准 Wiener 过程; 模型待估 参数为 $$ --&gt;</span></span>
<span id="cb50-529"><a href="#cb50-529"></a></span>
<span id="cb50-530"><a href="#cb50-530"></a><span class="co">&lt;!-- \boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right) --&gt;</span></span>
<span id="cb50-531"><a href="#cb50-531"></a></span>
<span id="cb50-532"><a href="#cb50-532"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-533"><a href="#cb50-533"></a></span>
<span id="cb50-534"><a href="#cb50-534"></a><span class="co">&lt;!-- 设有 $n$ 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 $i$, 设 时刻 $t_{i k}$ 观测到的退化量为 $X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)$; 对环境进行连续观测, 时刻 $j$ 观测到应力取值为 $S_{i j}, j=1,2, \cdots$ 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 $t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots$ 。下面基于动态环境下的退化试验数据, 给出 模型参数的**极大似然估计**方法。 --&gt;</span></span>
<span id="cb50-535"><a href="#cb50-535"></a></span>
<span id="cb50-536"><a href="#cb50-536"></a><span class="co">&lt;!-- 根据模型式 $(3.51)$, 记 $\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)$, 对产品 $i$ 以及时刻 $t_{i k}$ 近似的有 $$ --&gt;</span></span>
<span id="cb50-537"><a href="#cb50-537"></a></span>
<span id="cb50-538"><a href="#cb50-538"></a><span class="co">&lt;!-- X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right) --&gt;</span></span>
<span id="cb50-539"><a href="#cb50-539"></a></span>
<span id="cb50-540"><a href="#cb50-540"></a><span class="co">&lt;!-- $$ 且有 $$ --&gt;</span></span>
<span id="cb50-541"><a href="#cb50-541"></a></span>
<span id="cb50-542"><a href="#cb50-542"></a><span class="co">&lt;!-- \begin{gathered} --&gt;</span></span>
<span id="cb50-543"><a href="#cb50-543"></a></span>
<span id="cb50-544"><a href="#cb50-544"></a><span class="co">&lt;!-- E\left[X_i\left(t_{i k}\right)\right]=\beta_0 \nu_{i k} \\ --&gt;</span></span>
<span id="cb50-545"><a href="#cb50-545"></a></span>
<span id="cb50-546"><a href="#cb50-546"></a><span class="co">&lt;!-- \operatorname{Cov}\left[X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right]=\sigma_B^2 \cdot \min \left\{t_{i k_1}, t_{i k_2}\right\} --&gt;</span></span>
<span id="cb50-547"><a href="#cb50-547"></a></span>
<span id="cb50-548"><a href="#cb50-548"></a><span class="co">&lt;!-- \end{gathered} --&gt;</span></span>
<span id="cb50-549"><a href="#cb50-549"></a></span>
<span id="cb50-550"><a href="#cb50-550"></a><span class="co">&lt;!-- $$ 如果考虑退化增量 $\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)$, 其中 $$ --&gt;</span></span>
<span id="cb50-551"><a href="#cb50-551"></a></span>
<span id="cb50-552"><a href="#cb50-552"></a><span class="co">&lt;!-- Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m --&gt;</span></span>
<span id="cb50-553"><a href="#cb50-553"></a></span>
<span id="cb50-554"><a href="#cb50-554"></a><span class="co">&lt;!-- $$ 记 $\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}$ 。容易知道 $\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)$, 其中 $$ --&gt;</span></span>
<span id="cb50-555"><a href="#cb50-555"></a></span>
<span id="cb50-556"><a href="#cb50-556"></a><span class="co">&lt;!-- \mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right) --&gt;</span></span>
<span id="cb50-557"><a href="#cb50-557"></a></span>
<span id="cb50-558"><a href="#cb50-558"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-559"><a href="#cb50-559"></a></span>
<span id="cb50-560"><a href="#cb50-560"></a><span class="co">&lt;!-- 其中 $$ --&gt;</span></span>
<span id="cb50-561"><a href="#cb50-561"></a></span>
<span id="cb50-562"><a href="#cb50-562"></a><span class="co">&lt;!-- \Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}} --&gt;</span></span>
<span id="cb50-563"><a href="#cb50-563"></a></span>
<span id="cb50-564"><a href="#cb50-564"></a><span class="co">&lt;!-- $$ 设退化试验数据为 $\boldsymbol{y}_i, i=1,2, \cdots, n$, 则似然函数为 $$ --&gt;</span></span>
<span id="cb50-565"><a href="#cb50-565"></a></span>
<span id="cb50-566"><a href="#cb50-566"></a><span class="co">&lt;!-- L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right\} --&gt;</span></span>
<span id="cb50-567"><a href="#cb50-567"></a></span>
<span id="cb50-568"><a href="#cb50-568"></a><span class="co">&lt;!-- $$ 对数似然函数为 $$ --&gt;</span></span>
<span id="cb50-569"><a href="#cb50-569"></a></span>
<span id="cb50-570"><a href="#cb50-570"></a><span class="co">&lt;!-- l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} --&gt;</span></span>
<span id="cb50-571"><a href="#cb50-571"></a></span>
<span id="cb50-572"><a href="#cb50-572"></a><span class="co">&lt;!-- $$ 取对数似然函数关 $\sigma_B$ 和 $\beta_0$ 的一阶偏导数,得到 $$ --&gt;</span></span>
<span id="cb50-573"><a href="#cb50-573"></a></span>
<span id="cb50-574"><a href="#cb50-574"></a><span class="co">&lt;!-- \frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} --&gt;</span></span>
<span id="cb50-575"><a href="#cb50-575"></a></span>
<span id="cb50-576"><a href="#cb50-576"></a><span class="co">&lt;!-- $$ 与 $$ --&gt;</span></span>
<span id="cb50-577"><a href="#cb50-577"></a></span>
<span id="cb50-578"><a href="#cb50-578"></a><span class="co">&lt;!-- \frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}} --&gt;</span></span>
<span id="cb50-579"><a href="#cb50-579"></a></span>
<span id="cb50-580"><a href="#cb50-580"></a><span class="co">&lt;!-- $$ 这样, 对特定的 $\sigma_B$ 和 $\beta_0$, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: $$ --&gt;</span></span>
<span id="cb50-581"><a href="#cb50-581"></a></span>
<span id="cb50-582"><a href="#cb50-582"></a><span class="co">&lt;!-- l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}} --&gt;</span></span>
<span id="cb50-583"><a href="#cb50-583"></a></span>
<span id="cb50-584"><a href="#cb50-584"></a><span class="co">&lt;!-- $$ 通过搜索得到 $b$ 的极大似然估计 $\hat{b}$, 并将其代人式 (3.52) 或式 (3.53), 就得到 $\sigma_B$ 和 $\beta_0$ 的极大似然估计。 --&gt;</span></span>
<span id="cb50-585"><a href="#cb50-585"></a></span>
<span id="cb50-586"><a href="#cb50-586"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 3.3 含随机效应情形 --&gt;</span></span>
<span id="cb50-587"><a href="#cb50-587"></a></span>
<span id="cb50-588"><a href="#cb50-588"></a><span class="co">&lt;!-- #### 3.3.1 二阶段的极大似然方法 --&gt;</span></span>
<span id="cb50-589"><a href="#cb50-589"></a></span>
<span id="cb50-590"><a href="#cb50-590"></a><span class="co">&lt;!-- 考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 $n$ 个样品的退化 试验数据对随机效应的分布参数 $\nu 、 \eta 、 \alpha 、 \beta$ 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。 --&gt;</span></span>
<span id="cb50-591"><a href="#cb50-591"></a></span>
<span id="cb50-592"><a href="#cb50-592"></a><span class="co">&lt;!-- 对产品 $i$, 分别在时刻 $t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}$ 对其进行 $m_i+1$ 次测量, $i=1,2, \cdots, n$, 得 到的测量数据为 $x_{i j}$ 。记 $\Delta x_{i j}=x_{i j}-x_{i, j-1}$, 即 $\Delta x_{i j}$ 为产品 $i$ 在 $t_{i j-1}$ 到 $t_{i j}$ 之间的退化量增量, 由式 (3.41), 给定试验数据 $\Delta x_{i j}$ 的情况下, 样品 $i$ 的退化过程模型参数 $\mu_i, \sigma_i^2$ 的极大似然估计为 $$ --&gt;</span></span>
<span id="cb50-593"><a href="#cb50-593"></a></span>
<span id="cb50-594"><a href="#cb50-594"></a><span class="co">&lt;!-- \hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right] --&gt;</span></span>
<span id="cb50-595"><a href="#cb50-595"></a></span>
<span id="cb50-596"><a href="#cb50-596"></a><span class="co">&lt;!-- $$ 式中 : $\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i$ 。 --&gt;</span></span>
<span id="cb50-597"><a href="#cb50-597"></a></span>
<span id="cb50-598"><a href="#cb50-598"></a><span class="co">&lt;!-- 由式 (3.56) 得到各产品的退化过程参数的估计 $\hat{\mu}_i 、 \hat{\sigma}_i^2$ 后, 可以拟合得到 $\mu$ 和 $D$ 的 分布参数。令 $\hat{D}_i=\hat{\sigma}_i^2$, 由于 $D^{-1}$ 服从参数为 $(\alpha, \beta)$ 的 $\mathrm{Gamma}$ 分布, 则根据极大似然估 计, $D$ 的分布参数 $\alpha \sqrt{ } \beta$ 可以通过求解下面的方程组得到: $$ --&gt;</span></span>
<span id="cb50-599"><a href="#cb50-599"></a></span>
<span id="cb50-600"><a href="#cb50-600"></a><span class="co">&lt;!-- \left\{\begin{array}{l} --&gt;</span></span>
<span id="cb50-601"><a href="#cb50-601"></a></span>
<span id="cb50-602"><a href="#cb50-602"></a><span class="co">&lt;!-- \ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) \\ --&gt;</span></span>
<span id="cb50-603"><a href="#cb50-603"></a></span>
<span id="cb50-604"><a href="#cb50-604"></a><span class="co">&lt;!-- \alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}} --&gt;</span></span>
<span id="cb50-605"><a href="#cb50-605"></a></span>
<span id="cb50-606"><a href="#cb50-606"></a><span class="co">&lt;!-- \end{array}\right. --&gt;</span></span>
<span id="cb50-607"><a href="#cb50-607"></a></span>
<span id="cb50-608"><a href="#cb50-608"></a><span class="co">&lt;!-- $$ 式中: $\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)$ 为 Digamma 函数, 文献 $[47]$ 给出了其准确计算方法。 --&gt;</span></span>
<span id="cb50-609"><a href="#cb50-609"></a></span>
<span id="cb50-610"><a href="#cb50-610"></a><span class="co">&lt;!-- 由于 $\mu \sim N(\nu, \eta D)$, 对单元 $i$, 近似认为参数 $\nu 、 \eta$ 的似然函数为 $$ --&gt;</span></span>
<span id="cb50-611"><a href="#cb50-611"></a></span>
<span id="cb50-612"><a href="#cb50-612"></a><span class="co">&lt;!-- l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right) --&gt;</span></span>
<span id="cb50-613"><a href="#cb50-613"></a></span>
<span id="cb50-614"><a href="#cb50-614"></a><span class="co">&lt;!-- $$ 于是总的似然函数为 $$ --&gt;</span></span>
<span id="cb50-615"><a href="#cb50-615"></a></span>
<span id="cb50-616"><a href="#cb50-616"></a><span class="co">&lt;!-- l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right) --&gt;</span></span>
<span id="cb50-617"><a href="#cb50-617"></a></span>
<span id="cb50-618"><a href="#cb50-618"></a><span class="co">&lt;!-- $$ 由极大似然方法得到 $$ --&gt;</span></span>
<span id="cb50-619"><a href="#cb50-619"></a></span>
<span id="cb50-620"><a href="#cb50-620"></a><span class="co">&lt;!-- \left\{\begin{array}{l} --&gt;</span></span>
<span id="cb50-621"><a href="#cb50-621"></a></span>
<span id="cb50-622"><a href="#cb50-622"></a><span class="co">&lt;!-- -\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 \\ --&gt;</span></span>
<span id="cb50-623"><a href="#cb50-623"></a></span>
<span id="cb50-624"><a href="#cb50-624"></a><span class="co">&lt;!-- -\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 --&gt;</span></span>
<span id="cb50-625"><a href="#cb50-625"></a></span>
<span id="cb50-626"><a href="#cb50-626"></a><span class="co">&lt;!-- \end{array}\right. --&gt;</span></span>
<span id="cb50-627"><a href="#cb50-627"></a></span>
<span id="cb50-628"><a href="#cb50-628"></a><span class="co">&lt;!-- $$ 解上面的方程组得到 $$ --&gt;</span></span>
<span id="cb50-629"><a href="#cb50-629"></a></span>
<span id="cb50-630"><a href="#cb50-630"></a><span class="co">&lt;!-- \left\{\begin{array}{l} --&gt;</span></span>
<span id="cb50-631"><a href="#cb50-631"></a></span>
<span id="cb50-632"><a href="#cb50-632"></a><span class="co">&lt;!-- \hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} \\ --&gt;</span></span>
<span id="cb50-633"><a href="#cb50-633"></a></span>
<span id="cb50-634"><a href="#cb50-634"></a><span class="co">&lt;!-- \hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right) --&gt;</span></span>
<span id="cb50-635"><a href="#cb50-635"></a></span>
<span id="cb50-636"><a href="#cb50-636"></a><span class="co">&lt;!-- \end{array}\right. --&gt;</span></span>
<span id="cb50-637"><a href="#cb50-637"></a></span>
<span id="cb50-638"><a href="#cb50-638"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-639"><a href="#cb50-639"></a></span>
<span id="cb50-640"><a href="#cb50-640"></a><span class="co">&lt;!-- #### 3.3.2 客观贝叶斯方法 --&gt;</span></span>
<span id="cb50-641"><a href="#cb50-641"></a></span>
<span id="cb50-642"><a href="#cb50-642"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 3.4 有测量误差情形 --&gt;</span></span>
<span id="cb50-643"><a href="#cb50-643"></a></span>
<span id="cb50-644"><a href="#cb50-644"></a><span class="co">&lt;!-- 假设 $Y(t)$ 和 $X(t)$ 分别表示观测的退化过程和真实退化过程在时刻 $t, t \geqslant 0$ 的退化水平, $X(t)$ 和 $Y(t)$ 可用下面的模型描述: $$ --&gt;</span></span>
<span id="cb50-645"><a href="#cb50-645"></a></span>
<span id="cb50-646"><a href="#cb50-646"></a><span class="co">&lt;!-- \left\{\begin{array}{l} --&gt;</span></span>
<span id="cb50-647"><a href="#cb50-647"></a></span>
<span id="cb50-648"><a href="#cb50-648"></a><span class="co">&lt;!-- X(t)=\beta \cdot t+\sigma_B \cdot B(t) \\ --&gt;</span></span>
<span id="cb50-649"><a href="#cb50-649"></a></span>
<span id="cb50-650"><a href="#cb50-650"></a><span class="co">&lt;!-- Y(t)=X(t)+\sigma_R \cdot \varepsilon(t) --&gt;</span></span>
<span id="cb50-651"><a href="#cb50-651"></a></span>
<span id="cb50-652"><a href="#cb50-652"></a><span class="co">&lt;!-- \end{array}\right. --&gt;</span></span>
<span id="cb50-653"><a href="#cb50-653"></a></span>
<span id="cb50-654"><a href="#cb50-654"></a><span class="co">&lt;!-- $$ 式中: $\beta$ 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 $\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)$ 是标准 Wiener 过程, $\sigma_B$ 为扩散参 数; $\varepsilon(t)$ 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。 --&gt;</span></span>
<span id="cb50-655"><a href="#cb50-655"></a></span>
<span id="cb50-656"><a href="#cb50-656"></a><span class="co">&lt;!-- 因此, 式 (3.61) 模型共有 4 个待估参数, 即 $$ --&gt;</span></span>
<span id="cb50-657"><a href="#cb50-657"></a></span>
<span id="cb50-658"><a href="#cb50-658"></a><span class="co">&lt;!-- \boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}} --&gt;</span></span>
<span id="cb50-659"><a href="#cb50-659"></a></span>
<span id="cb50-660"><a href="#cb50-660"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-661"><a href="#cb50-661"></a></span>
<span id="cb50-662"><a href="#cb50-662"></a><span class="co">&lt;!-- 假设对 $n$ 个产品进行退化试验。对单元 $i(i=1, \cdots, n)$ 进行 $m_i$ 次测量, 时刻 $t_{i j}$ 的测量值为 $$ --&gt;</span></span>
<span id="cb50-663"><a href="#cb50-663"></a></span>
<span id="cb50-664"><a href="#cb50-664"></a><span class="co">&lt;!-- Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i --&gt;</span></span>
<span id="cb50-665"><a href="#cb50-665"></a></span>
<span id="cb50-666"><a href="#cb50-666"></a><span class="co">&lt;!-- $$ 式中 : $\beta_i$ 是单元 $i$ 的平均退化速率, 对单元 $i$ 的所有测量是恒定不变的。 --&gt;</span></span>
<span id="cb50-667"><a href="#cb50-667"></a></span>
<span id="cb50-668"><a href="#cb50-668"></a><span class="co">&lt;!-- 定义时间间隔 $\Delta t_{i j}=t_{i j}-t_{i j-1}$, 观测的退化增量为 $\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1$, $2, \cdots, m_i$; 根据 Wiener 过程定义, $t_{i 0}=0, Y_i\left(t_{i 0}\right)=0$ 。为叙述方便, 令 $$ --&gt;</span></span>
<span id="cb50-669"><a href="#cb50-669"></a></span>
<span id="cb50-670"><a href="#cb50-670"></a><span class="co">&lt;!-- \Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}} --&gt;</span></span>
<span id="cb50-671"><a href="#cb50-671"></a></span>
<span id="cb50-672"><a href="#cb50-672"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-673"><a href="#cb50-673"></a></span>
<span id="cb50-674"><a href="#cb50-674"></a><span class="co">&lt;!-- 根据 Wiener 过程的独立增量性质, 得到 $$ --&gt;</span></span>
<span id="cb50-675"><a href="#cb50-675"></a></span>
<span id="cb50-676"><a href="#cb50-676"></a><span class="co">&lt;!-- \begin{gathered} --&gt;</span></span>
<span id="cb50-677"><a href="#cb50-677"></a></span>
<span id="cb50-678"><a href="#cb50-678"></a><span class="co">&lt;!-- E\left[\Delta \boldsymbol{Y}_i\right]=\mu_\beta \Delta \boldsymbol{t}_i \\ --&gt;</span></span>
<span id="cb50-679"><a href="#cb50-679"></a></span>
<span id="cb50-680"><a href="#cb50-680"></a><span class="co">&lt;!-- \operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i \\ --&gt;</span></span>
<span id="cb50-681"><a href="#cb50-681"></a></span>
<span id="cb50-682"><a href="#cb50-682"></a><span class="co">&lt;!-- \end{gathered} --&gt;</span></span>
<span id="cb50-683"><a href="#cb50-683"></a></span>
<span id="cb50-684"><a href="#cb50-684"></a><span class="co">&lt;!-- $$ 其中， $$ --&gt;</span></span>
<span id="cb50-685"><a href="#cb50-685"></a></span>
<span id="cb50-686"><a href="#cb50-686"></a><span class="co">&lt;!-- \boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc} --&gt;</span></span>
<span id="cb50-687"><a href="#cb50-687"></a></span>
<span id="cb50-688"><a href="#cb50-688"></a><span class="co">&lt;!-- 2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 \\ --&gt;</span></span>
<span id="cb50-689"><a href="#cb50-689"></a></span>
<span id="cb50-690"><a href="#cb50-690"></a><span class="co">&lt;!-- -1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 \\ --&gt;</span></span>
<span id="cb50-691"><a href="#cb50-691"></a></span>
<span id="cb50-692"><a href="#cb50-692"></a><span class="co">&lt;!-- 0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 \\ --&gt;</span></span>
<span id="cb50-693"><a href="#cb50-693"></a></span>
<span id="cb50-694"><a href="#cb50-694"></a><span class="co">&lt;!-- \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ --&gt;</span></span>
<span id="cb50-695"><a href="#cb50-695"></a></span>
<span id="cb50-696"><a href="#cb50-696"></a><span class="co">&lt;!-- 0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2 --&gt;</span></span>
<span id="cb50-697"><a href="#cb50-697"></a></span>
<span id="cb50-698"><a href="#cb50-698"></a><span class="co">&lt;!-- \end{array}\right] --&gt;</span></span>
<span id="cb50-699"><a href="#cb50-699"></a></span>
<span id="cb50-700"><a href="#cb50-700"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-701"><a href="#cb50-701"></a></span>
<span id="cb50-702"><a href="#cb50-702"></a><span class="co">&lt;!-- 设退化数据为 $\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n$, 则参数 $\boldsymbol{\theta}$ 的似然函数为 $$ --&gt;</span></span>
<span id="cb50-703"><a href="#cb50-703"></a></span>
<span id="cb50-704"><a href="#cb50-704"></a><span class="co">&lt;!-- L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right\} --&gt;</span></span>
<span id="cb50-705"><a href="#cb50-705"></a></span>
<span id="cb50-706"><a href="#cb50-706"></a><span class="co">&lt;!-- $$ 令 $\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i$, 其中 $\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i$ 定义 $$ --&gt;</span></span>
<span id="cb50-707"><a href="#cb50-707"></a></span>
<span id="cb50-708"><a href="#cb50-708"></a><span class="co">&lt;!-- \phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i --&gt;</span></span>
<span id="cb50-709"><a href="#cb50-709"></a></span>
<span id="cb50-710"><a href="#cb50-710"></a><span class="co">&lt;!-- $$ 取对数似然函数关于 $\mu_\beta$ 和 $\sigma_\beta^2$ 的一阶偏导数, 并利用下面的公式 $$ --&gt;</span></span>
<span id="cb50-711"><a href="#cb50-711"></a></span>
<span id="cb50-712"><a href="#cb50-712"></a><span class="co">&lt;!-- \begin{aligned} --&gt;</span></span>
<span id="cb50-713"><a href="#cb50-713"></a></span>
<span id="cb50-714"><a href="#cb50-714"></a><span class="co">&lt;!-- \left|\boldsymbol{\Sigma}_i\right| &amp;=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.\\ --&gt;</span></span>
<span id="cb50-715"><a href="#cb50-715"></a></span>
<span id="cb50-716"><a href="#cb50-716"></a><span class="co">&lt;!-- \boldsymbol{\Sigma}_i^{-1} &amp;=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 }) --&gt;</span></span>
<span id="cb50-717"><a href="#cb50-717"></a></span>
<span id="cb50-718"><a href="#cb50-718"></a><span class="co">&lt;!-- \end{aligned} --&gt;</span></span>
<span id="cb50-719"><a href="#cb50-719"></a></span>
<span id="cb50-720"><a href="#cb50-720"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-721"><a href="#cb50-721"></a></span>
<span id="cb50-722"><a href="#cb50-722"></a><span class="co">&lt;!-- 得到 $$ --&gt;</span></span>
<span id="cb50-723"><a href="#cb50-723"></a></span>
<span id="cb50-724"><a href="#cb50-724"></a><span class="co">&lt;!-- \frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i} --&gt;</span></span>
<span id="cb50-725"><a href="#cb50-725"></a></span>
<span id="cb50-726"><a href="#cb50-726"></a><span class="co">&lt;!-- $$ 和 $$ --&gt;</span></span>
<span id="cb50-727"><a href="#cb50-727"></a></span>
<span id="cb50-728"><a href="#cb50-728"></a><span class="co">&lt;!-- \frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i} --&gt;</span></span>
<span id="cb50-729"><a href="#cb50-729"></a></span>
<span id="cb50-730"><a href="#cb50-730"></a><span class="co">&lt;!-- $$ 于是, 对特定的 $\left(\sigma_B, \sigma_R\right)$ 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的如下限制极大似然估计: $$ --&gt;</span></span>
<span id="cb50-731"><a href="#cb50-731"></a></span>
<span id="cb50-732"><a href="#cb50-732"></a><span class="co">&lt;!-- \left\{\begin{array}{l} --&gt;</span></span>
<span id="cb50-733"><a href="#cb50-733"></a></span>
<span id="cb50-734"><a href="#cb50-734"></a><span class="co">&lt;!-- \hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} \\ --&gt;</span></span>
<span id="cb50-735"><a href="#cb50-735"></a></span>
<span id="cb50-736"><a href="#cb50-736"></a><span class="co">&lt;!-- \sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0 --&gt;</span></span>
<span id="cb50-737"><a href="#cb50-737"></a></span>
<span id="cb50-738"><a href="#cb50-738"></a><span class="co">&lt;!-- \end{array}\right. --&gt;</span></span>
<span id="cb50-739"><a href="#cb50-739"></a></span>
<span id="cb50-740"><a href="#cb50-740"></a><span class="co">&lt;!-- $$ 将上式代人 $\theta$ 的对数似然函数,则得到如下的截面似然函数: $$ --&gt;</span></span>
<span id="cb50-741"><a href="#cb50-741"></a></span>
<span id="cb50-742"><a href="#cb50-742"></a><span class="co">&lt;!-- \begin{aligned} --&gt;</span></span>
<span id="cb50-743"><a href="#cb50-743"></a></span>
<span id="cb50-744"><a href="#cb50-744"></a><span class="co">&lt;!-- l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) \\ --&gt;</span></span>
<span id="cb50-745"><a href="#cb50-745"></a></span>
<span id="cb50-746"><a href="#cb50-746"></a><span class="co">&lt;!-- &amp;-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) \\ --&gt;</span></span>
<span id="cb50-747"><a href="#cb50-747"></a></span>
<span id="cb50-748"><a href="#cb50-748"></a><span class="co">&lt;!-- &amp;+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i} --&gt;</span></span>
<span id="cb50-749"><a href="#cb50-749"></a></span>
<span id="cb50-750"><a href="#cb50-750"></a><span class="co">&lt;!-- \end{aligned} --&gt;</span></span>
<span id="cb50-751"><a href="#cb50-751"></a></span>
<span id="cb50-752"><a href="#cb50-752"></a><span class="co">&lt;!-- $$ 通过最大化上述截面似然函数, 得到 $\sigma_B$ 和 $\sigma_R$ 的极大似然估计 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$, 这可通过 2 维搜索算法实现。最后将 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$ 代人式 (3.64), 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的极大似然估计。 --&gt;</span></span>
<span id="cb50-753"><a href="#cb50-753"></a></span>
<span id="cb50-754"><a href="#cb50-754"></a><span class="co">&lt;!-- 当所有观测时间相同时, 诸 $\rho_i$ 相同, 记为 $\rho$, 可以得到 $\hat{\mu}_\beta$ 和 $\hat{\sigma}_\beta^2$ 的解析形式, 即 $$ --&gt;</span></span>
<span id="cb50-755"><a href="#cb50-755"></a></span>
<span id="cb50-756"><a href="#cb50-756"></a><span class="co">&lt;!-- \begin{gathered} --&gt;</span></span>
<span id="cb50-757"><a href="#cb50-757"></a></span>
<span id="cb50-758"><a href="#cb50-758"></a><span class="co">&lt;!-- \hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} \\ --&gt;</span></span>
<span id="cb50-759"><a href="#cb50-759"></a></span>
<span id="cb50-760"><a href="#cb50-760"></a><span class="co">&lt;!-- \hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho} --&gt;</span></span>
<span id="cb50-761"><a href="#cb50-761"></a></span>
<span id="cb50-762"><a href="#cb50-762"></a><span class="co">&lt;!-- \end{gathered} --&gt;</span></span>
<span id="cb50-763"><a href="#cb50-763"></a></span>
<span id="cb50-764"><a href="#cb50-764"></a><span class="co">&lt;!-- $$ 容易看出, $\hat{\mu}_{\beta, i}$ 实际上是单元 $i$ 的退化速率的加权最小二乘估计, $\hat{\sigma}_\beta^2$ 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: $$ --&gt;</span></span>
<span id="cb50-765"><a href="#cb50-765"></a></span>
<span id="cb50-766"><a href="#cb50-766"></a><span class="co">&lt;!-- \begin{aligned} --&gt;</span></span>
<span id="cb50-767"><a href="#cb50-767"></a></span>
<span id="cb50-768"><a href="#cb50-768"></a><span class="co">&lt;!-- l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| \\ --&gt;</span></span>
<span id="cb50-769"><a href="#cb50-769"></a></span>
<span id="cb50-770"><a href="#cb50-770"></a><span class="co">&lt;!-- &amp;-\frac{1}{2}\left\{\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right\} \\ --&gt;</span></span>
<span id="cb50-771"><a href="#cb50-771"></a></span>
<span id="cb50-772"><a href="#cb50-772"></a><span class="co">&lt;!-- &amp;-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right) --&gt;</span></span>
<span id="cb50-773"><a href="#cb50-773"></a></span>
<span id="cb50-774"><a href="#cb50-774"></a><span class="co">&lt;!-- \end{aligned} --&gt;</span></span>
<span id="cb50-775"><a href="#cb50-775"></a></span>
<span id="cb50-776"><a href="#cb50-776"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb50-777"><a href="#cb50-777"></a></span>
<span id="cb50-778"><a href="#cb50-778"></a><span class="fu">### 3.2 案例分析</span></span>
<span id="cb50-779"><a href="#cb50-779"></a></span>
<span id="cb50-780"><a href="#cb50-780"></a><span class="fu">#### 3.2.1 NASA 锂电池数据</span></span>
<span id="cb50-781"><a href="#cb50-781"></a></span>
<span id="cb50-782"><a href="#cb50-782"></a><span class="at">&gt; 数据来源于</span><span class="co">[</span><span class="ot">NASA Ames Prognostics Center of Excellence (PCoE)</span><span class="co">](https://c3.ndc.nasa.gov/dashlink/resources/133/)</span><span class="at">，但是找不到数据下载。最后是通过 </span><span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/psanabriaUC/BatteryDatasetImplementation)</span><span class="at"> 获得。</span></span>
<span id="cb50-783"><a href="#cb50-783"></a></span>
<span id="cb50-784"><a href="#cb50-784"></a>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即**充电**、**放电**和**测量 EIS**。</span>
<span id="cb50-785"><a href="#cb50-785"></a></span>
<span id="cb50-786"><a href="#cb50-786"></a>充电是以**恒流模**式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以**恒压模式**(CV)继续充电直到电流降到 20mA。</span>
<span id="cb50-787"><a href="#cb50-787"></a></span>
<span id="cb50-788"><a href="#cb50-788"></a>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</span>
<span id="cb50-789"><a href="#cb50-789"></a></span>
<span id="cb50-790"><a href="#cb50-790"></a>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</span>
<span id="cb50-791"><a href="#cb50-791"></a></span>
<span id="cb50-794"><a href="#cb50-794"></a><span class="in">```{r}</span></span>
<span id="cb50-795"><a href="#cb50-795"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb50-796"><a href="#cb50-796"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span>
<span id="cb50-797"><a href="#cb50-797"></a><span class="in">```</span></span>
<span id="cb50-798"><a href="#cb50-798"></a></span>
<span id="cb50-801"><a href="#cb50-801"></a><span class="in">```{r}</span></span>
<span id="cb50-802"><a href="#cb50-802"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb50-803"><a href="#cb50-803"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb50-804"><a href="#cb50-804"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-805"><a href="#cb50-805"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb50-806"><a href="#cb50-806"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span>
<span id="cb50-807"><a href="#cb50-807"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb50-808"><a href="#cb50-808"></a><span class="in">```</span></span>
<span id="cb50-809"><a href="#cb50-809"></a></span>
<span id="cb50-810"><a href="#cb50-810"></a>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</span>
<span id="cb50-811"><a href="#cb50-811"></a></span>
<span id="cb50-814"><a href="#cb50-814"></a><span class="in">```{r}</span></span>
<span id="cb50-815"><a href="#cb50-815"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb50-816"><a href="#cb50-816"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb50-817"><a href="#cb50-817"></a></span>
<span id="cb50-818"><a href="#cb50-818"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb50-819"><a href="#cb50-819"></a></span>
<span id="cb50-820"><a href="#cb50-820"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb50-821"><a href="#cb50-821"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb50-822"><a href="#cb50-822"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-823"><a href="#cb50-823"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb50-824"><a href="#cb50-824"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb50-825"><a href="#cb50-825"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb50-826"><a href="#cb50-826"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb50-827"><a href="#cb50-827"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-828"><a href="#cb50-828"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-829"><a href="#cb50-829"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-830"><a href="#cb50-830"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span>
<span id="cb50-831"><a href="#cb50-831"></a><span class="in">```</span></span>
<span id="cb50-832"><a href="#cb50-832"></a></span>
<span id="cb50-833"><a href="#cb50-833"></a>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</span>
<span id="cb50-834"><a href="#cb50-834"></a></span>
<span id="cb50-837"><a href="#cb50-837"></a><span class="in">```{r}</span></span>
<span id="cb50-838"><a href="#cb50-838"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb50-839"><a href="#cb50-839"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb50-840"><a href="#cb50-840"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb50-841"><a href="#cb50-841"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb50-842"><a href="#cb50-842"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb50-843"><a href="#cb50-843"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span>
<span id="cb50-844"><a href="#cb50-844"></a><span class="in">```</span></span>
<span id="cb50-845"><a href="#cb50-845"></a></span>
<span id="cb50-848"><a href="#cb50-848"></a><span class="in">```{r}</span></span>
<span id="cb50-849"><a href="#cb50-849"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb50-850"><a href="#cb50-850"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-851"><a href="#cb50-851"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb50-852"><a href="#cb50-852"></a>mle_par</span>
<span id="cb50-853"><a href="#cb50-853"></a><span class="in">```</span></span>
<span id="cb50-854"><a href="#cb50-854"></a></span>
<span id="cb50-855"><a href="#cb50-855"></a>计算可靠度并绘图</span>
<span id="cb50-856"><a href="#cb50-856"></a></span>
<span id="cb50-859"><a href="#cb50-859"></a><span class="in">```{r}</span></span>
<span id="cb50-860"><a href="#cb50-860"></a><span class="co"># 计算可靠度</span></span>
<span id="cb50-861"><a href="#cb50-861"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span>
<span id="cb50-862"><a href="#cb50-862"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb50-863"><a href="#cb50-863"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb50-864"><a href="#cb50-864"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb50-865"><a href="#cb50-865"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb50-866"><a href="#cb50-866"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb50-867"><a href="#cb50-867"></a>}</span>
<span id="cb50-868"><a href="#cb50-868"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb50-869"><a href="#cb50-869"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb50-870"><a href="#cb50-870"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb50-871"><a href="#cb50-871"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb50-872"><a href="#cb50-872"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb50-873"><a href="#cb50-873"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-874"><a href="#cb50-874"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb50-875"><a href="#cb50-875"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-876"><a href="#cb50-876"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb50-877"><a href="#cb50-877"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span>
<span id="cb50-878"><a href="#cb50-878"></a><span class="in">```</span></span>
<span id="cb50-879"><a href="#cb50-879"></a></span>
<span id="cb50-880"><a href="#cb50-880"></a><span class="fu">#### 3.2.2 激光器件 Laser 数据集</span></span>
<span id="cb50-881"><a href="#cb50-881"></a></span>
<span id="cb50-882"><a href="#cb50-882"></a><span class="at">&gt; 数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</span></span>
<span id="cb50-883"><a href="#cb50-883"></a></span>
<span id="cb50-884"><a href="#cb50-884"></a>激光器件的质量特征是其**工作电流**。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</span>
<span id="cb50-885"><a href="#cb50-885"></a></span>
<span id="cb50-888"><a href="#cb50-888"></a><span class="in">```{r}</span></span>
<span id="cb50-889"><a href="#cb50-889"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb50-890"><a href="#cb50-890"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span>
<span id="cb50-891"><a href="#cb50-891"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span>
<span id="cb50-892"><a href="#cb50-892"></a><span class="in">```</span></span>
<span id="cb50-893"><a href="#cb50-893"></a></span>
<span id="cb50-896"><a href="#cb50-896"></a><span class="in">```{r}</span></span>
<span id="cb50-897"><a href="#cb50-897"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb50-898"><a href="#cb50-898"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb50-899"><a href="#cb50-899"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb50-900"><a href="#cb50-900"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb50-901"><a href="#cb50-901"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb50-902"><a href="#cb50-902"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb50-903"><a href="#cb50-903"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb50-904"><a href="#cb50-904"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb50-905"><a href="#cb50-905"></a><span class="in">```</span></span>
<span id="cb50-906"><a href="#cb50-906"></a></span>
<span id="cb50-909"><a href="#cb50-909"></a><span class="in">```{r}</span></span>
<span id="cb50-910"><a href="#cb50-910"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb50-911"><a href="#cb50-911"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb50-912"><a href="#cb50-912"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb50-913"><a href="#cb50-913"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span>
<span id="cb50-914"><a href="#cb50-914"></a><span class="in">```</span></span>
<span id="cb50-915"><a href="#cb50-915"></a></span>
<span id="cb50-918"><a href="#cb50-918"></a><span class="in">```{r}</span></span>
<span id="cb50-919"><a href="#cb50-919"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb50-920"><a href="#cb50-920"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-921"><a href="#cb50-921"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb50-922"><a href="#cb50-922"></a>mle_par</span>
<span id="cb50-923"><a href="#cb50-923"></a><span class="in">```</span></span>
<span id="cb50-924"><a href="#cb50-924"></a></span>
<span id="cb50-925"><a href="#cb50-925"></a>计算可靠度并绘图，阈值设置参考 Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety **193**. 第6节案例分析</span>
<span id="cb50-926"><a href="#cb50-926"></a></span>
<span id="cb50-927"><a href="#cb50-927"></a>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</span>
<span id="cb50-928"><a href="#cb50-928"></a></span>
<span id="cb50-929"><a href="#cb50-929"></a><span class="at">&gt; 可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</span></span>
<span id="cb50-930"><a href="#cb50-930"></a></span>
<span id="cb50-933"><a href="#cb50-933"></a><span class="in">```{r}</span></span>
<span id="cb50-934"><a href="#cb50-934"></a><span class="co"># 计算可靠度</span></span>
<span id="cb50-935"><a href="#cb50-935"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb50-936"><a href="#cb50-936"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb50-937"><a href="#cb50-937"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb50-938"><a href="#cb50-938"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb50-939"><a href="#cb50-939"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb50-940"><a href="#cb50-940"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb50-941"><a href="#cb50-941"></a>}</span>
<span id="cb50-942"><a href="#cb50-942"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb50-943"><a href="#cb50-943"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb50-944"><a href="#cb50-944"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb50-945"><a href="#cb50-945"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb50-946"><a href="#cb50-946"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb50-947"><a href="#cb50-947"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-948"><a href="#cb50-948"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb50-949"><a href="#cb50-949"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-950"><a href="#cb50-950"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb50-951"><a href="#cb50-951"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb50-952"><a href="#cb50-952"></a></span>
<span id="cb50-953"><a href="#cb50-953"></a><span class="in">```</span></span>
<span id="cb50-954"><a href="#cb50-954"></a></span>
<span id="cb50-955"><a href="#cb50-955"></a><span class="fu">#### 3.2.3 炭膜电阻器 carbon-film resistors</span></span>
<span id="cb50-956"><a href="#cb50-956"></a></span>
<span id="cb50-957"><a href="#cb50-957"></a><span class="at">&gt; 退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</span></span>
<span id="cb50-958"><a href="#cb50-958"></a></span>
<span id="cb50-959"><a href="#cb50-959"></a>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</span>
<span id="cb50-960"><a href="#cb50-960"></a></span>
<span id="cb50-961"><a href="#cb50-961"></a>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</span>
<span id="cb50-962"><a href="#cb50-962"></a></span>
<span id="cb50-965"><a href="#cb50-965"></a><span class="in">```{r}</span></span>
<span id="cb50-966"><a href="#cb50-966"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb50-967"><a href="#cb50-967"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span>
<span id="cb50-968"><a href="#cb50-968"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb50-969"><a href="#cb50-969"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span>
<span id="cb50-970"><a href="#cb50-970"></a><span class="in">```</span></span>
<span id="cb50-971"><a href="#cb50-971"></a></span>
<span id="cb50-974"><a href="#cb50-974"></a><span class="in">```{r}</span></span>
<span id="cb50-975"><a href="#cb50-975"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb50-976"><a href="#cb50-976"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-977"><a href="#cb50-977"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb50-978"><a href="#cb50-978"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb50-979"><a href="#cb50-979"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb50-980"><a href="#cb50-980"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb50-981"><a href="#cb50-981"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb50-982"><a href="#cb50-982"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb50-983"><a href="#cb50-983"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb50-984"><a href="#cb50-984"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb50-985"><a href="#cb50-985"></a><span class="in">```</span></span>
<span id="cb50-986"><a href="#cb50-986"></a></span>
<span id="cb50-987"><a href="#cb50-987"></a>后续参数估计和可靠度估计就先不做了。</span>
<span id="cb50-988"><a href="#cb50-988"></a></span>
<span id="cb50-989"><a href="#cb50-989"></a><span class="co">&lt;!-- 类似的数据集还包括： --&gt;</span></span>
<span id="cb50-990"><a href="#cb50-990"></a></span>
<span id="cb50-991"><a href="#cb50-991"></a><span class="co">&lt;!-- #### 3.3.4 惯导平台 interial navigition 数据 --&gt;</span></span>
<span id="cb50-992"><a href="#cb50-992"></a></span>
<span id="cb50-993"><a href="#cb50-993"></a><span class="co">&lt;!-- &gt; 数据来自于文献：Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability **61**(1): 50-67. --&gt;</span></span>
<span id="cb50-994"><a href="#cb50-994"></a></span>
<span id="cb50-995"><a href="#cb50-995"></a><span class="co">&lt;!-- 惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。 --&gt;</span></span>
<span id="cb50-996"><a href="#cb50-996"></a></span>
<span id="cb50-997"><a href="#cb50-997"></a><span class="co">&lt;!-- 下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。 --&gt;</span></span>
<span id="cb50-998"><a href="#cb50-998"></a></span>
<span id="cb50-999"><a href="#cb50-999"></a><span class="co">&lt;!-- 图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。 --&gt;</span></span>
<span id="cb50-1000"><a href="#cb50-1000"></a></span>
<span id="cb50-1001"><a href="#cb50-1001"></a><span class="co">&lt;!-- ![](images/paste-40CEA295.png) --&gt;</span></span>
<span id="cb50-1002"><a href="#cb50-1002"></a></span>
<span id="cb50-1003"><a href="#cb50-1003"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb50-1004"><a href="#cb50-1004"></a></span>
<span id="cb50-1005"><a href="#cb50-1005"></a><span class="co">&lt;!-- interial_dat = read.csv("dataset/interial_navigition.csv") --&gt;</span></span>
<span id="cb50-1006"><a href="#cb50-1006"></a></span>
<span id="cb50-1007"><a href="#cb50-1007"></a><span class="co">&lt;!-- knitr::kable(head(interial_dat)) --&gt;</span></span>
<span id="cb50-1008"><a href="#cb50-1008"></a></span>
<span id="cb50-1009"><a href="#cb50-1009"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb50-1010"><a href="#cb50-1010"></a></span>
<span id="cb50-1011"><a href="#cb50-1011"></a><span class="co">&lt;!-- 该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。 --&gt;</span></span>
<span id="cb50-1012"><a href="#cb50-1012"></a></span>
<span id="cb50-1013"><a href="#cb50-1013"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb50-1014"><a href="#cb50-1014"></a></span>
<span id="cb50-1015"><a href="#cb50-1015"></a><span class="co">&lt;!-- interial_new = interial_dat %&gt;%  --&gt;</span></span>
<span id="cb50-1016"><a href="#cb50-1016"></a></span>
<span id="cb50-1017"><a href="#cb50-1017"></a><span class="co">&lt;!--   pivot_longer(`Item1`:`Item5`,  --&gt;</span></span>
<span id="cb50-1018"><a href="#cb50-1018"></a></span>
<span id="cb50-1019"><a href="#cb50-1019"></a><span class="co">&lt;!--     names_to = "Product",  --&gt;</span></span>
<span id="cb50-1020"><a href="#cb50-1020"></a></span>
<span id="cb50-1021"><a href="#cb50-1021"></a><span class="co">&lt;!--     values_to = "Value") --&gt;</span></span>
<span id="cb50-1022"><a href="#cb50-1022"></a></span>
<span id="cb50-1023"><a href="#cb50-1023"></a><span class="co">&lt;!-- interial_new %&gt;%  --&gt;</span></span>
<span id="cb50-1024"><a href="#cb50-1024"></a></span>
<span id="cb50-1025"><a href="#cb50-1025"></a><span class="co">&lt;!--   ggplot(aes(time,Value)) +  --&gt;</span></span>
<span id="cb50-1026"><a href="#cb50-1026"></a></span>
<span id="cb50-1027"><a href="#cb50-1027"></a><span class="co">&lt;!--   geom_line(aes(col = Product)) + --&gt;</span></span>
<span id="cb50-1028"><a href="#cb50-1028"></a></span>
<span id="cb50-1029"><a href="#cb50-1029"></a><span class="co">&lt;!--   geom_point(aes(col = Product,shape = Product)) +  --&gt;</span></span>
<span id="cb50-1030"><a href="#cb50-1030"></a></span>
<span id="cb50-1031"><a href="#cb50-1031"></a><span class="co">&lt;!--   scale_color_viridis(option = "D",discrete = T) +  --&gt;</span></span>
<span id="cb50-1032"><a href="#cb50-1032"></a></span>
<span id="cb50-1033"><a href="#cb50-1033"></a><span class="co">&lt;!--   scale_x_continuous(limits = c(0, 25),breaks = seq(0,25,2.5)) + --&gt;</span></span>
<span id="cb50-1034"><a href="#cb50-1034"></a></span>
<span id="cb50-1035"><a href="#cb50-1035"></a><span class="co">&lt;!--   theme_bw() +    --&gt;</span></span>
<span id="cb50-1036"><a href="#cb50-1036"></a></span>
<span id="cb50-1037"><a href="#cb50-1037"></a><span class="co">&lt;!--   ylab("Condition monitoring time (hours)") + --&gt;</span></span>
<span id="cb50-1038"><a href="#cb50-1038"></a></span>
<span id="cb50-1039"><a href="#cb50-1039"></a><span class="co">&lt;!--   xlab("Gyropic drift (/h)") +  --&gt;</span></span>
<span id="cb50-1040"><a href="#cb50-1040"></a></span>
<span id="cb50-1041"><a href="#cb50-1041"></a><span class="co">&lt;!--   theme(panel.grid = element_blank(), --&gt;</span></span>
<span id="cb50-1042"><a href="#cb50-1042"></a></span>
<span id="cb50-1043"><a href="#cb50-1043"></a><span class="co">&lt;!--         legend.position = "right")  --&gt;</span></span>
<span id="cb50-1044"><a href="#cb50-1044"></a></span>
<span id="cb50-1045"><a href="#cb50-1045"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb50-1046"><a href="#cb50-1046"></a></span>
<span id="cb50-1047"><a href="#cb50-1047"></a><span class="co">&lt;!-- #### 3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy --&gt;</span></span>
<span id="cb50-1048"><a href="#cb50-1048"></a></span>
<span id="cb50-1049"><a href="#cb50-1049"></a><span class="co">&lt;!-- &gt; 数据来自： (Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability 61(1): 50-67). --&gt;</span></span>
<span id="cb50-1050"><a href="#cb50-1050"></a></span>
<span id="cb50-1051"><a href="#cb50-1051"></a><span class="co">&lt;!-- 它是飞机上常用的金属材料，这种材料的完整性通过**疲劳裂纹的长度**来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。 --&gt;</span></span>
<span id="cb50-1052"><a href="#cb50-1052"></a></span>
<span id="cb50-1053"><a href="#cb50-1053"></a><span class="co">&lt;!-- 对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。**退化过程存在非线性**。 --&gt;</span></span>
<span id="cb50-1054"><a href="#cb50-1054"></a></span>
<span id="cb50-1055"><a href="#cb50-1055"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb50-1056"><a href="#cb50-1056"></a></span>
<span id="cb50-1057"><a href="#cb50-1057"></a><span class="co">&lt;!-- Alloy_dat = read.csv("dataset/2017-T4 Aluminum Alloy.csv") --&gt;</span></span>
<span id="cb50-1058"><a href="#cb50-1058"></a></span>
<span id="cb50-1059"><a href="#cb50-1059"></a><span class="co">&lt;!-- knitr::kable(head(Alloy_dat)) --&gt;</span></span>
<span id="cb50-1060"><a href="#cb50-1060"></a></span>
<span id="cb50-1061"><a href="#cb50-1061"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb50-1062"><a href="#cb50-1062"></a></span>
<span id="cb50-1063"><a href="#cb50-1063"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb50-1064"><a href="#cb50-1064"></a></span>
<span id="cb50-1065"><a href="#cb50-1065"></a><span class="co">&lt;!-- Alloy_new = Alloy_dat %&gt;%  --&gt;</span></span>
<span id="cb50-1066"><a href="#cb50-1066"></a></span>
<span id="cb50-1067"><a href="#cb50-1067"></a><span class="co">&lt;!--   pivot_longer(`Item1`:`Item4`,  --&gt;</span></span>
<span id="cb50-1068"><a href="#cb50-1068"></a></span>
<span id="cb50-1069"><a href="#cb50-1069"></a><span class="co">&lt;!--     names_to = "Product",  --&gt;</span></span>
<span id="cb50-1070"><a href="#cb50-1070"></a></span>
<span id="cb50-1071"><a href="#cb50-1071"></a><span class="co">&lt;!--     values_to = "Value") --&gt;</span></span>
<span id="cb50-1072"><a href="#cb50-1072"></a></span>
<span id="cb50-1073"><a href="#cb50-1073"></a><span class="co">&lt;!-- Alloy_new %&gt;%  --&gt;</span></span>
<span id="cb50-1074"><a href="#cb50-1074"></a></span>
<span id="cb50-1075"><a href="#cb50-1075"></a><span class="co">&lt;!--   ggplot(aes(Cycle,Value)) +  --&gt;</span></span>
<span id="cb50-1076"><a href="#cb50-1076"></a></span>
<span id="cb50-1077"><a href="#cb50-1077"></a><span class="co">&lt;!--   geom_line(aes(col = Product)) + --&gt;</span></span>
<span id="cb50-1078"><a href="#cb50-1078"></a></span>
<span id="cb50-1079"><a href="#cb50-1079"></a><span class="co">&lt;!--   geom_point(aes(col = Product,shape = Product)) +  --&gt;</span></span>
<span id="cb50-1080"><a href="#cb50-1080"></a></span>
<span id="cb50-1081"><a href="#cb50-1081"></a><span class="co">&lt;!--   scale_color_viridis(option = "D",discrete = T) + --&gt;</span></span>
<span id="cb50-1082"><a href="#cb50-1082"></a></span>
<span id="cb50-1083"><a href="#cb50-1083"></a><span class="co">&lt;!--   theme_bw() +    --&gt;</span></span>
<span id="cb50-1084"><a href="#cb50-1084"></a></span>
<span id="cb50-1085"><a href="#cb50-1085"></a><span class="co">&lt;!--   ylab("Condition monitoring time (hours)") + --&gt;</span></span>
<span id="cb50-1086"><a href="#cb50-1086"></a></span>
<span id="cb50-1087"><a href="#cb50-1087"></a><span class="co">&lt;!--   xlab("Gyropic drift (/h)") +  --&gt;</span></span>
<span id="cb50-1088"><a href="#cb50-1088"></a></span>
<span id="cb50-1089"><a href="#cb50-1089"></a><span class="co">&lt;!--   theme(panel.grid = element_blank(), --&gt;</span></span>
<span id="cb50-1090"><a href="#cb50-1090"></a></span>
<span id="cb50-1091"><a href="#cb50-1091"></a><span class="co">&lt;!--         legend.position = "right")  --&gt;</span></span>
<span id="cb50-1092"><a href="#cb50-1092"></a></span>
<span id="cb50-1093"><a href="#cb50-1093"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>