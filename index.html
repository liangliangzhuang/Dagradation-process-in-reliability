<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="庄亮亮、吴温慧">

<title>退化过程模型综述</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#介绍" id="toc-介绍" class="nav-link active" data-scroll-target="#介绍">1. 介绍</a></li>
  <li><a href="#退化轨道模型" id="toc-退化轨道模型" class="nav-link" data-scroll-target="#退化轨道模型">2. 退化轨道模型</a></li>
  <li><a href="#wiener-退化过程模型" id="toc-wiener-退化过程模型" class="nav-link" data-scroll-target="#wiener-退化过程模型">3. Wiener 退化过程模型</a>
  <ul>
  <li><a href="#带漂移的-wiener-过程" id="toc-带漂移的-wiener-过程" class="nav-link" data-scroll-target="#带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</a>
  <ul>
  <li><a href="#数据模拟产生" id="toc-数据模拟产生" class="nav-link" data-scroll-target="#数据模拟产生">3.1.1 数据模拟产生</a></li>
  <li><a href="#统计推断" id="toc-统计推断" class="nav-link" data-scroll-target="#统计推断">3.1.2 统计推断</a>
  <ul class="collapse">
  <li><a href="#极大似然估计" id="toc-极大似然估计" class="nav-link" data-scroll-target="#极大似然估计">3.1.2.1 极大似然估计</a></li>
  <li><a href="#贝叶斯分析" id="toc-贝叶斯分析" class="nav-link" data-scroll-target="#贝叶斯分析">3.1.2.2 贝叶斯分析</a></li>
  <li><a href="#客观贝叶斯分析" id="toc-客观贝叶斯分析" class="nav-link" data-scroll-target="#客观贝叶斯分析">3.1.2.3 客观贝叶斯分析</a></li>
  <li><a href="#广义推断方法" id="toc-广义推断方法" class="nav-link" data-scroll-target="#广义推断方法">3.1.2.4 广义推断方法</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#多应力和动态环境情形" id="toc-多应力和动态环境情形" class="nav-link" data-scroll-target="#多应力和动态环境情形">3.2 多应力和动态环境情形</a></li>
  <li><a href="#含随机效应情形" id="toc-含随机效应情形" class="nav-link" data-scroll-target="#含随机效应情形">3.3 含随机效应情形</a>
  <ul>
  <li><a href="#二阶段的极大似然方法" id="toc-二阶段的极大似然方法" class="nav-link" data-scroll-target="#二阶段的极大似然方法">3.3.1 二阶段的极大似然方法</a></li>
  <li><a href="#客观贝叶斯方法" id="toc-客观贝叶斯方法" class="nav-link" data-scroll-target="#客观贝叶斯方法">3.3.2 客观贝叶斯方法</a></li>
  </ul></li>
  <li><a href="#有测量误差情形" id="toc-有测量误差情形" class="nav-link" data-scroll-target="#有测量误差情形">3.4 有测量误差情形</a></li>
  <li><a href="#案例分析" id="toc-案例分析" class="nav-link" data-scroll-target="#案例分析">3.3 案例分析</a>
  <ul>
  <li><a href="#nasa-锂电池数据" id="toc-nasa-锂电池数据" class="nav-link" data-scroll-target="#nasa-锂电池数据">3.3.1 NASA 锂电池数据</a></li>
  <li><a href="#激光器件-laser-数据集" id="toc-激光器件-laser-数据集" class="nav-link" data-scroll-target="#激光器件-laser-数据集">3.3.2 激光器件 Laser 数据集</a></li>
  <li><a href="#炭膜电阻器-carbon-film-resistors" id="toc-炭膜电阻器-carbon-film-resistors" class="nav-link" data-scroll-target="#炭膜电阻器-carbon-film-resistors">3.3.3 炭膜电阻器 carbon-film resistors</a></li>
  <li><a href="#惯导平台-interial-navigition-数据" id="toc-惯导平台-interial-navigition-数据" class="nav-link" data-scroll-target="#惯导平台-interial-navigition-数据">3.3.4 惯导平台 interial navigition 数据</a></li>
  <li><a href="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" id="toc-铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="nav-link" data-scroll-target="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#gamma退化过程模型" id="toc-gamma退化过程模型" class="nav-link" data-scroll-target="#gamma退化过程模型">4. Gamma退化过程模型</a>
  <ul>
  <li><a href="#简单gamma-退化过程" id="toc-简单gamma-退化过程" class="nav-link" data-scroll-target="#简单gamma-退化过程">4.1 简单Gamma 退化过程</a>
  <ul>
  <li><a href="#数据模拟产生-1" id="toc-数据模拟产生-1" class="nav-link" data-scroll-target="#数据模拟产生-1">4.1.1 数据模拟产生</a></li>
  <li><a href="#统计推断-1" id="toc-统计推断-1" class="nav-link" data-scroll-target="#统计推断-1">4.1.2 统计推断</a>
  <ul class="collapse">
  <li><a href="#矩估计" id="toc-矩估计" class="nav-link" data-scroll-target="#矩估计">4.1.2.1 矩估计</a></li>
  <li><a href="#极大似然估计-1" id="toc-极大似然估计-1" class="nav-link" data-scroll-target="#极大似然估计-1">4.1.2.2 极大似然估计</a></li>
  <li><a href="#广义推断方法-1" id="toc-广义推断方法-1" class="nav-link" data-scroll-target="#广义推断方法-1">4.1.2.3 广义推断方法</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#含协变量影响及随机效应情形" id="toc-含协变量影响及随机效应情形" class="nav-link" data-scroll-target="#含协变量影响及随机效应情形">4.2 含协变量影响及随机效应情形</a></li>
  <li><a href="#有测量误差情形-1" id="toc-有测量误差情形-1" class="nav-link" data-scroll-target="#有测量误差情形-1">4.3 有测量误差情形</a></li>
  <li><a href="#案例分析-1" id="toc-案例分析-1" class="nav-link" data-scroll-target="#案例分析-1">4.4 案例分析</a>
  <ul>
  <li><a href="#wear-data" id="toc-wear-data" class="nav-link" data-scroll-target="#wear-data">4.4.1 wear data</a></li>
  <li><a href="#crack-of-titanium" id="toc-crack-of-titanium" class="nav-link" data-scroll-target="#crack-of-titanium">4.4.2 Crack of Titanium</a></li>
  <li><a href="#lithium-ion-batteries" id="toc-lithium-ion-batteries" class="nav-link" data-scroll-target="#lithium-ion-batteries">4.4.3 Lithium-ion batteries</a></li>
  <li><a href="#fatigue-crack-data" id="toc-fatigue-crack-data" class="nav-link" data-scroll-target="#fatigue-crack-data">4.4.4 fatigue crack data</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">退化过程模型综述</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>庄亮亮、吴温慧 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="介绍" class="level2">
<h2 class="anchored" data-anchor-id="介绍">1. 介绍</h2>
<p>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在<strong>基于退化的可靠性模型</strong>方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</p>
<ol type="1">
<li><p>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</p></li>
<li><p>基于 Wiener 过程的模型</p></li>
<li><p>基于 Gamma 过程的模型</p></li>
<li><p>累积损伤模型(主要是基于混合 Poisson 过程的模型）</p></li>
<li><p>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</p></li>
</ol>
<p>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究<strong>矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法</strong>，以及<strong>非参数和半参数方法</strong>等，解决模型辨识和修正问题;</p>
<p>采用<strong>似然比检验、Bayes 因子分析</strong>等方法进行模型验证;</p>
<p>采用<strong>均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)</strong>等进行模型优良性检验。</p>
<p>在基于退化的可靠性技术应用方面，针对<strong>机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）</strong>等的退化失效过程，开展<strong>退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计</strong>：特别是加速退化试验方案设计的研究。</p>
</section>
<section id="退化轨道模型" class="level2">
<h2 class="anchored" data-anchor-id="退化轨道模型">2. 退化轨道模型</h2>
<blockquote class="blockquote">
<p>暂时不考虑</p>
</blockquote>
</section>
<section id="wiener-退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="wiener-退化过程模型">3. Wiener 退化过程模型</h2>
<p>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</p>
<p>Wiener 退化过程的<strong>首达时间分布具有解析形式</strong>，便于对<strong>产品寿命</strong>和<strong>可靠度</strong>的分析和计算。</p>
<p>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</p>
<p>通过对经典 Wiener 过程的参数引入<strong>随机性</strong>，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</p>
<blockquote class="blockquote">
<p>对 Wiener 退化过程及其观测过程所构成的<strong>状态空间模型</strong>，可以采用 <strong>Kalman 滤波技术</strong>进行处理，为产品<strong>在线寿命预测、视情维修决策</strong>等提供了可行的算法和实现途径。</p>
</blockquote>
<section id="带漂移的-wiener-过程" class="level3">
<h3 class="anchored" data-anchor-id="带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</h3>
<p>称 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是漂移参数为 <span class="math inline">\(\mu\)</span> 、扩散参数为 <span class="math inline">\(\sigma\)</span> 的 (一元) Wiener 过程, 若</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span>。</p></li>
<li><p><span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 有平稳独立增量。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 服从均值为 <span class="math inline">\(\mu t\)</span>,方差为 <span class="math inline">\(\sigma^2 t\)</span> 的正态分布。</p></li>
</ol>
<p>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: <span class="math display">\[
X(t)=\mu t+\sigma B(t)
\]</span> 式中: <span class="math inline">\(\{B(t)\}, t \geqslant 0\)</span> 是标准 Wiener 过程或标准布朗运动过程。</p>
<p>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</p>
<p>（1）时刻 <span class="math inline">\(t \sim t+\Delta t\)</span> 之间的增量服从正态分布, 即 <span class="math inline">\(\Delta X=X(t+\Delta t)-X(t) \sim\)</span> <span class="math inline">\(N\left(\mu \Delta t, \sigma^2 \Delta t\right)\)</span> 。</p>
<ol start="2" type="1">
<li>对任意两个不相交的时间区间 <span class="math inline">\(\left[t_1, t_2\right],\left[t_3, t_4\right], t_1&lt;t_2 \leqslant t_3&lt;t_4\)</span>, 增量 <span class="math inline">\(X\left(t_4\right)-X\)</span> <span class="math inline">\(\left(t_3\right)\)</span> 与 <span class="math inline">\(X\left(t_2\right)-X\left(t_1\right)\)</span> 相互独立。</li>
</ol>
<p>如果产品的性能退化过程是一元 Wiener 过程,假设其运行到时刻 <span class="math inline">\(\tau\)</span> 仍末失效, 且 当前性能退化量为 <span class="math inline">\(x_\tau\left(x_\tau&lt;l\right)\)</span>, 则产品的剩余寿命 <span class="math inline">\(T_1\)</span> 可以表示为 <span class="math display">\[
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
\]</span> 由一元 Wiener 过程的独立增量性质和齐次马尔可夫性得到 <span class="math display">\[
\begin{aligned}
T_1 &amp;=\inf \left\{t \mid X(t+\tau)-X(\tau) \geqslant l-x_\tau, t \geqslant 0\right\} \\
&amp;=\inf \left\{t \mid X(t) \geqslant l-x_\tau, t \geqslant 0\right\}
\end{aligned}
\]</span> 可知剩余寿命 <span class="math inline">\(T_1\)</span> 也是逆 Gaussian 分布, 其密度函数只需将寿命 <span class="math inline">\(T\)</span> 密度函数中的失效阈值 <span class="math inline">\(l\)</span> 替换为 <span class="math inline">\(l-x_\tau\)</span>, 即 <span class="math display">\[f_{T_1}(t)=\frac{l-x_\tau}{\sqrt{2 \pi \sigma^2 t^3}} \exp \left[-\frac{\left(l-x_\tau-\mu t\right)^2}{2 \sigma^2 t}\right]\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="数据模拟产生" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生">3.1.1 数据模拟产生</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)){</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="co"># para 指 mu,sigma</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb2-7"><a href="#cb2-7"></a>  dat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb2-9"><a href="#cb2-9"></a>  dat_unit <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) dat_unit[j] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],<span class="fu">sqrt</span>(para[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_t[j]))</span>
<span id="cb2-12"><a href="#cb2-12"></a>    dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit)</span>
<span id="cb2-13"><a href="#cb2-13"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb2-15"><a href="#cb2-15"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="fu">return</span>(dat1)</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>绘制退化路径图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="co"># 画图</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb3-5"><a href="#cb3-5"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb3-6"><a href="#cb3-6"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="fu">print</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb4-5"><a href="#cb4-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.561012</td>
<td style="text-align: right;">2.952760</td>
<td style="text-align: right;">-0.385809</td>
<td style="text-align: right;">1.1698654</td>
<td style="text-align: right;">3.383265</td>
<td style="text-align: right;">0.8870915</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.506914</td>
<td style="text-align: right;">4.794273</td>
<td style="text-align: right;">1.591227</td>
<td style="text-align: right;">0.1169029</td>
<td style="text-align: right;">4.143992</td>
<td style="text-align: right;">2.6456401</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.007138</td>
<td style="text-align: right;">6.530442</td>
<td style="text-align: right;">2.641289</td>
<td style="text-align: right;">3.1417999</td>
<td style="text-align: right;">5.192061</td>
<td style="text-align: right;">4.3096412</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.331079</td>
<td style="text-align: right;">8.041902</td>
<td style="text-align: right;">3.182688</td>
<td style="text-align: right;">2.9852054</td>
<td style="text-align: right;">4.820246</td>
<td style="text-align: right;">4.1381689</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">3.988613</td>
<td style="text-align: right;">10.207204</td>
<td style="text-align: right;">5.005252</td>
<td style="text-align: right;">3.3908455</td>
<td style="text-align: right;">6.003774</td>
<td style="text-align: right;">5.6082122</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">plot_path</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="统计推断" class="level4">
<h4 class="anchored" data-anchor-id="统计推断">3.1.2 统计推断</h4>
<p>假设共有 <span class="math inline">\(n\)</span> 个样品进行性能退化试验。样品 <span class="math inline">\(i\)</span> 初始时刻 <span class="math inline">\(t_{i 0}\)</span> 退化量取值为 <span class="math inline">\(X_{i 0}=0\)</span>, 在 时刻 <span class="math inline">\(t_{i 1}, \cdots, t_{i m_i}\)</span> 样品 <span class="math inline">\(i\)</span> 退化量为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span> 。记 <span class="math inline">\(\Delta X_{i j}=X_{i j}-X_{i, j-1}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{i, j-1} \sim t_{i j}\)</span> 之间的退化增量, <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 为各样品的测量间隔。</p>
<section id="极大似然估计" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计">3.1.2.1 极大似然估计</h5>
<p>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 <span class="math display">\[
\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)
\]</span></p>
<p>于是由退化数据 <span class="math inline">\(X_{i j}=x_{i j}\)</span> (等价的, <span class="math inline">\(\Delta X_{i j}=\Delta x_{i j}\)</span> ) <span class="math inline">\(, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span>, 得到模型参数的似然函数为 <span class="math display">\[
L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left[-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right]
\]</span> 由式可以直接求得漂移参数 <span class="math inline">\(\mu\)</span> 和扩散参数 <span class="math inline">\(\sigma^2\)</span> 的极大似然估计如下: <span class="math display">\[
\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left[\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right]
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb6-6"><a href="#cb6-6"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb6-7"><a href="#cb6-7"></a>  }</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">return</span>(re)</span>
<span id="cb6-9"><a href="#cb6-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb7-5"><a href="#cb7-5"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb7-14"><a href="#cb7-14"></a>}</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb7-17"><a href="#cb7-17"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># mle_re</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># 区间估计</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">low</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">up</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.957</td>
<td style="text-align: right;">1.014</td>
<td style="text-align: right;">1.071</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.963</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: right;">1.043</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>为了得到产品可靠度的估计, 只要将 <span class="math inline">\(\hat{\mu} 、 \hat{\sigma}^2\)</span> 代人任务时间 <span class="math inline">\(t\)</span> 的可靠度的表达式, 即 可得到可靠度的点估计为 <span class="math display">\[
R(t)=1-F(t ; \hat{\mu}, \hat{\sigma})=\Phi\left(\frac{l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)-\exp \left(\frac{2 \hat{\mu} l}{\hat{\sigma}^2}\right) \Phi\left(\frac{-l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb8-3"><a href="#cb8-3"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">return</span>(R)</span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>给个简单例子</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb9-4"><a href="#cb9-4"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb9-5"><a href="#cb9-5"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="贝叶斯分析" class="level5">
<h5 class="anchored" data-anchor-id="贝叶斯分析">3.1.2.2 贝叶斯分析</h5>
<p>基于 rstan 进行贝叶斯估计。详细的参考文献如下：</p>
<ul>
<li><p>最新、入门级别 <a href="https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html">rstan</a> 资料。</p></li>
<li><p><a href="https://mc-stan.org/users/interfaces/rstan">官网资料</a></p></li>
</ul>
<p>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),\\
&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),\\
&amp; \mu|w \sim N(d,\frac{c}{w}).
\end{aligned}
\]</span></p>
<p>其中，<span class="math inline">\(a = b = 1, d = 0, c =100\)</span>。</p>
<p>构建模型（<code>wiener_linear.stan</code>）</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a>data {</span>
<span id="cb10-2"><a href="#cb10-2"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb10-3"><a href="#cb10-3"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb10-4"><a href="#cb10-4"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb10-5"><a href="#cb10-5"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb10-6"><a href="#cb10-6"></a>}</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>parameters {</span>
<span id="cb10-9"><a href="#cb10-9"></a>  real mu;</span>
<span id="cb10-10"><a href="#cb10-10"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb10-11"><a href="#cb10-11"></a>}</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a>model {</span>
<span id="cb10-14"><a href="#cb10-14"></a>  w ~ gamma(1,1);</span>
<span id="cb10-15"><a href="#cb10-15"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb10-16"><a href="#cb10-16"></a>  for (i in 1:I){</span>
<span id="cb10-17"><a href="#cb10-17"></a>    for (j in 1:J) {</span>
<span id="cb10-18"><a href="#cb10-18"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb10-19"><a href="#cb10-19"></a>    }</span>
<span id="cb10-20"><a href="#cb10-20"></a>  }</span>
<span id="cb10-21"><a href="#cb10-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>存在问题：这里的normal中，sigma是标准差还是方差？</p>
</blockquote>
<ul>
<li>数据准备</li>
</ul>
<p>准备<span class="math inline">\(\Delta t_{ij}\)</span> 和 <span class="math inline">\(\Delta x_{ij}\)</span>的数据，并且标志出矩阵的维数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># 数据准备</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb11-5"><a href="#cb11-5"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="fu">dim</span>(delta_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 199   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb13-6"><a href="#cb13-6"></a>)</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="fu">dim</span>(delta_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 199   6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># 后验抽样</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">library</span>(rstan)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>输出各个参数的后验估计结果并进行绘制。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">print</span>(fit1,</span>
<span id="cb16-2"><a href="#cb16-2"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inference for Stan model: wiener_linear.
1 chains, each with iter=2000; warmup=1000; thin=1; 
post-warmup draws per chain=1000, total post-warmup draws=1000.

        mean se_mean   sd     10%     50%     90% n_eff Rhat
mu      1.01    0.00 0.03    0.98    1.01    1.05  1010    1
w       1.00    0.00 0.02    0.97    1.00    1.02   629    1
lp__ -607.11    0.04 0.94 -608.30 -606.84 -606.28   452    1

Samples were drawn using NUTS(diag_e) at Thu Feb  2 16:34:07 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">plot</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb19-2"><a href="#cb19-2"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb19-3"><a href="#cb19-3"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>可以看出，效果较好。真实值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.25\)</span>，估计值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.5\)</span>。 估计值的<span class="math inline">\(\sigma^2\)</span> 有些问题，应该如何处理？</p>
</section>
<section id="客观贝叶斯分析" class="level5">
<h5 class="anchored" data-anchor-id="客观贝叶斯分析">3.1.2.3 客观贝叶斯分析</h5>
<p>暂时还未找到，最经典的维纳过程客观贝叶斯分析。</p>
<ul>
<li>维纳（线性） + 随机效应：</li>
</ul>
</section>
<section id="广义推断方法" class="level5">
<h5 class="anchored" data-anchor-id="广义推断方法">3.1.2.4 广义推断方法</h5>
<p>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</p>
<ul>
<li>维纳（线性） + 随机效应：</li>
</ul>
<p>Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety 193.</p>
<ul>
<li>维纳（线性）+ 加速寿命试验 + 随机效应：</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2020). “Reliability analysis for accelerated degradation data based on the Wiener process with random effects.” Quality and Reliability Engineering International 36(6): 1969-1981.</p>
<p>Hong, L., et al.&nbsp;(2018). “Interval estimation for Wiener processes based on accelerated degradation test data.” IISE Transactions 50(12): 1043-1057.</p>
<ul>
<li>伽马 + 随机过程</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2021). “Degradation data analysis based on gamma process with random effects.” European Journal of Operational Research 292(3): 1200-1208.</p>
<ul>
<li>伽马 + 加速寿命试验</li>
</ul>
<p>Jiang, P. H., et al.&nbsp;(2019). “Inference for constant-stress accelerated degradation test based on Gamma process.” Applied Mathematical Modelling 67: 123-134.</p>
</section>
</section>
</section>
<section id="多应力和动态环境情形" class="level3">
<h3 class="anchored" data-anchor-id="多应力和动态环境情形">3.2 多应力和动态环境情形</h3>
<p><strong>1. 多应力情形</strong></p>
<p>某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。</p>
<p>假设在不同应力下, 一元 Wiener 过程模型的参数是应力 <span class="math inline">\(S\)</span> 的函数 <span class="math display">\[
\mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right)
\]</span> 式中: <span class="math inline">\(\theta_\mu 、 \theta_\sigma\)</span> 是末知参数向量。</p>
<p>对不同类型应力, <span class="math inline">\(\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)\)</span> 的形式和参数不同。比如对漂移参数 <span class="math inline">\(\mu\)</span>, 应力 为温度时通常采用阿伦尼斯模型进行描述 <span class="math display">\[
\mu(S)=a \mathrm{e}^{-b / S}
\]</span></p>
<p>如果应力是电压、功率等, 则通常采用幂律模型 <span class="math display">\[
\mu(S)=a S^b
\]</span></p>
<p>根据加速退化试验中应力的变化情况,加速退化试验又分别为<strong>恒定应力加速退化试验</strong>、<strong>步进应力加速退化试验</strong>和<strong>序进应力加速退化试验</strong>。</p>
<p>恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。</p>
<p>设产品在 <span class="math inline">\(S_0, S_1, \cdots, S_s\)</span> 共 <span class="math inline">\(s+1\)</span> 个应力下进行退化试验, 其中应力 <span class="math inline">\(S_0\)</span> 为正常工作应 力。应力 <span class="math inline">\(S_i\)</span> 下共得到 <span class="math inline">\(n_i\)</span> 个产品的性能退化数据, 其中对产品 <span class="math inline">\(j\)</span>, 初始时刻 <span class="math inline">\(t_{i j 0}\)</span> 的退化量 为 <span class="math inline">\(X_{i j 0}=0\)</span>, 分别在时刻 <span class="math inline">\(t_{i j 1}, \cdots, t_{i j m_{i j}}\)</span> 测量其性能退化量 <span class="math inline">\(X_{i j 1}, \cdots, X_{i j m_{i j}}\)</span>, 其中 <span class="math inline">\(i=0,1, \cdots, s, j=\)</span> <span class="math inline">\(1,2, \cdots, n_i\)</span> 记 <span class="math inline">\(\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}\)</span>, 其中 <span class="math inline">\(k=1,2, \cdots, m_{i j}\)</span> 。由各应力下 的退化数据 <span class="math inline">\(\left\{\Delta x_{i j k}\right\}\)</span> 得到模型参数的似然函数为 <span class="math display">\[
L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k}}} \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right]
\]</span></p>
<p>则参数 <span class="math inline">\(\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma\)</span> 的极大似然估计 <span class="math inline">\(\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma\)</span> 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 <span class="math inline">\(S_0\)</span> 下参数 <span class="math inline">\(\mu 、 \sigma^2\)</span> 为 <span class="math display">\[
\mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right)
\]</span> 产品可靠度点估计可由式 (3.42)得到。</p>
<p><strong>2. 动态环境情形</strong></p>
<p>与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 <span class="math inline">\(\{S\)</span> <span class="math inline">\((t), t \geqslant 0\}\)</span>, 并且假设应力对退化速率的影响函数为 <span class="math inline">\(\beta_0 \cdot h(S(t) ; b)\)</span>, 其中 <span class="math inline">\(\beta_0\)</span> 是基准应 力下的退化速率, 以 <span class="math inline">\(b\)</span> 为参数的函数 <span class="math inline">\(h(S(t) ; b)\)</span> 表示应力的影响, <span class="math inline">\(b\)</span> 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 <span class="math inline">\(t\)</span> 产品退化量取值为 <span class="math display">\[
X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t)
\]</span> 式中: <span class="math inline">\(\{S(\tau), 0 \leqslant \tau \leqslant t\}\)</span> 为 <span class="math inline">\([0, \tau]\)</span> 内的应力; <span class="math inline">\(\{B(t), t \geqslant 0\}\)</span> 为标准 Wiener 过程; 模型待估 参数为 <span class="math display">\[
\boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right)
\]</span></p>
<p>设有 <span class="math inline">\(n\)</span> 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 <span class="math inline">\(i\)</span>, 设 时刻 <span class="math inline">\(t_{i k}\)</span> 观测到的退化量为 <span class="math inline">\(X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)\)</span>; 对环境进行连续观测, 时刻 <span class="math inline">\(j\)</span> 观测到应力取值为 <span class="math inline">\(S_{i j}, j=1,2, \cdots\)</span> 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 <span class="math inline">\(t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots\)</span> 。下面基于动态环境下的退化试验数据, 给出 模型参数的<strong>极大似然估计</strong>方法。</p>
<p>根据模型式 <span class="math inline">\((3.51)\)</span>, 记 <span class="math inline">\(\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)\)</span>, 对产品 <span class="math inline">\(i\)</span> 以及时刻 <span class="math inline">\(t_{i k}\)</span> 近似的有 <span class="math display">\[
X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right)
\]</span> 且有 <span class="math display">\[
\begin{gathered}
E\left[X_i\left(t_{i k}\right)\right]=\beta_0 \nu_{i k} \\
\operatorname{Cov}\left[X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right]=\sigma_B^2 \cdot \min \left\{t_{i k_1}, t_{i k_2}\right\}
\end{gathered}
\]</span> 如果考虑退化增量 <span class="math inline">\(\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)\)</span>, 其中 <span class="math display">\[
Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m
\]</span> 记 <span class="math inline">\(\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}\)</span> 。容易知道 <span class="math inline">\(\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)\)</span>, 其中 <span class="math display">\[
\mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right)
\]</span></p>
<p>其中 <span class="math display">\[
\Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}}
\]</span> 设退化试验数据为 <span class="math inline">\(\boldsymbol{y}_i, i=1,2, \cdots, n\)</span>, 则似然函数为 <span class="math display">\[
L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right\}
\]</span> 对数似然函数为 <span class="math display">\[
l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 取对数似然函数关 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span> 的一阶偏导数,得到 <span class="math display">\[
\frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 与 <span class="math display">\[
\frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}}
\]</span> 这样, 对特定的 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span>, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: <span class="math display">\[
l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 通过搜索得到 <span class="math inline">\(b\)</span> 的极大似然估计 <span class="math inline">\(\hat{b}\)</span>, 并将其代人式 (3.52) 或式 (3.53), 就得到 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span> 的极大似然估计。</p>
</section>
<section id="含随机效应情形" class="level3">
<h3 class="anchored" data-anchor-id="含随机效应情形">3.3 含随机效应情形</h3>
<section id="二阶段的极大似然方法" class="level4">
<h4 class="anchored" data-anchor-id="二阶段的极大似然方法">3.3.1 二阶段的极大似然方法</h4>
<p>考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 <span class="math inline">\(n\)</span> 个样品的退化 试验数据对随机效应的分布参数 <span class="math inline">\(\nu 、 \eta 、 \alpha 、 \beta\)</span> 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。</p>
<p>对产品 <span class="math inline">\(i\)</span>, 分别在时刻 <span class="math inline">\(t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}\)</span> 对其进行 <span class="math inline">\(m_i+1\)</span> 次测量, <span class="math inline">\(i=1,2, \cdots, n\)</span>, 得 到的测量数据为 <span class="math inline">\(x_{i j}\)</span> 。记 <span class="math inline">\(\Delta x_{i j}=x_{i j}-x_{i, j-1}\)</span>, 即 <span class="math inline">\(\Delta x_{i j}\)</span> 为产品 <span class="math inline">\(i\)</span> 在 <span class="math inline">\(t_{i j-1}\)</span> 到 <span class="math inline">\(t_{i j}\)</span> 之间的退化量增量, 由式 (3.41), 给定试验数据 <span class="math inline">\(\Delta x_{i j}\)</span> 的情况下, 样品 <span class="math inline">\(i\)</span> 的退化过程模型参数 <span class="math inline">\(\mu_i, \sigma_i^2\)</span> 的极大似然估计为 <span class="math display">\[
\hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right]
\]</span> 式中 : <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i\)</span> 。</p>
<p>由式 (3.56) 得到各产品的退化过程参数的估计 <span class="math inline">\(\hat{\mu}_i 、 \hat{\sigma}_i^2\)</span> 后, 可以拟合得到 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(D\)</span> 的 分布参数。令 <span class="math inline">\(\hat{D}_i=\hat{\sigma}_i^2\)</span>, 由于 <span class="math inline">\(D^{-1}\)</span> 服从参数为 <span class="math inline">\((\alpha, \beta)\)</span> 的 <span class="math inline">\(\mathrm{Gamma}\)</span> 分布, 则根据极大似然估 计, <span class="math inline">\(D\)</span> 的分布参数 <span class="math inline">\(\alpha \sqrt{ } \beta\)</span> 可以通过求解下面的方程组得到: <span class="math display">\[
\left\{\begin{array}{l}
\ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) \\
\alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}}
\end{array}\right.
\]</span> 式中: <span class="math inline">\(\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)\)</span> 为 Digamma 函数, 文献 <span class="math inline">\([47]\)</span> 给出了其准确计算方法。</p>
<p>由于 <span class="math inline">\(\mu \sim N(\nu, \eta D)\)</span>, 对单元 <span class="math inline">\(i\)</span>, 近似认为参数 <span class="math inline">\(\nu 、 \eta\)</span> 的似然函数为 <span class="math display">\[
l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right)
\]</span> 于是总的似然函数为 <span class="math display">\[
l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)
\]</span> 由极大似然方法得到 <span class="math display">\[
\left\{\begin{array}{l}
-\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 \\
-\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0
\end{array}\right.
\]</span> 解上面的方程组得到 <span class="math display">\[
\left\{\begin{array}{l}
\hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} \\
\hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)
\end{array}\right.
\]</span></p>
</section>
<section id="客观贝叶斯方法" class="level4">
<h4 class="anchored" data-anchor-id="客观贝叶斯方法">3.3.2 客观贝叶斯方法</h4>
</section>
</section>
<section id="有测量误差情形" class="level3">
<h3 class="anchored" data-anchor-id="有测量误差情形">3.4 有测量误差情形</h3>
<p>假设 <span class="math inline">\(Y(t)\)</span> 和 <span class="math inline">\(X(t)\)</span> 分别表示观测的退化过程和真实退化过程在时刻 <span class="math inline">\(t, t \geqslant 0\)</span> 的退化水平, <span class="math inline">\(X(t)\)</span> 和 <span class="math inline">\(Y(t)\)</span> 可用下面的模型描述: <span class="math display">\[
\left\{\begin{array}{l}
X(t)=\beta \cdot t+\sigma_B \cdot B(t) \\
Y(t)=X(t)+\sigma_R \cdot \varepsilon(t)
\end{array}\right.
\]</span> 式中: <span class="math inline">\(\beta\)</span> 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 <span class="math inline">\(\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)\)</span> 是标准 Wiener 过程, <span class="math inline">\(\sigma_B\)</span> 为扩散参 数; <span class="math inline">\(\varepsilon(t)\)</span> 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。</p>
<p>因此, 式 (3.61) 模型共有 4 个待估参数, 即 <span class="math display">\[
\boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}}
\]</span></p>
<p>假设对 <span class="math inline">\(n\)</span> 个产品进行退化试验。对单元 <span class="math inline">\(i(i=1, \cdots, n)\)</span> 进行 <span class="math inline">\(m_i\)</span> 次测量, 时刻 <span class="math inline">\(t_{i j}\)</span> 的测量值为 <span class="math display">\[
Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i
\]</span> 式中 : <span class="math inline">\(\beta_i\)</span> 是单元 <span class="math inline">\(i\)</span> 的平均退化速率, 对单元 <span class="math inline">\(i\)</span> 的所有测量是恒定不变的。</p>
<p>定义时间间隔 <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}\)</span>, 观测的退化增量为 <span class="math inline">\(\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1\)</span>, <span class="math inline">\(2, \cdots, m_i\)</span>; 根据 Wiener 过程定义, <span class="math inline">\(t_{i 0}=0, Y_i\left(t_{i 0}\right)=0\)</span> 。为叙述方便, 令 <span class="math display">\[
\Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}}
\]</span></p>
<p>根据 Wiener 过程的独立增量性质, 得到 <span class="math display">\[
\begin{gathered}
E\left[\Delta \boldsymbol{Y}_i\right]=\mu_\beta \Delta \boldsymbol{t}_i \\
\operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i \\
\end{gathered}
\]</span> 其中， <span class="math display">\[
\boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc}
2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 \\
0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2
\end{array}\right]
\]</span></p>
<p>设退化数据为 <span class="math inline">\(\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n\)</span>, 则参数 <span class="math inline">\(\boldsymbol{\theta}\)</span> 的似然函数为 <span class="math display">\[
L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right\}
\]</span> 令 <span class="math inline">\(\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i\)</span>, 其中 <span class="math inline">\(\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i\)</span> 定义 <span class="math display">\[
\phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i
\]</span> 取对数似然函数关于 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta^2\)</span> 的一阶偏导数, 并利用下面的公式 <span class="math display">\[
\begin{aligned}
\left|\boldsymbol{\Sigma}_i\right| &amp;=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.\\
\boldsymbol{\Sigma}_i^{-1} &amp;=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 })
\end{aligned}
\]</span></p>
<p>得到 <span class="math display">\[
\frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}
\]</span> 和 <span class="math display">\[
\frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i}
\]</span> 于是, 对特定的 <span class="math inline">\(\left(\sigma_B, \sigma_R\right)\)</span> 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta\)</span> 的如下限制极大似然估计: <span class="math display">\[
\left\{\begin{array}{l}
\hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} \\
\sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0
\end{array}\right.
\]</span> 将上式代人 <span class="math inline">\(\theta\)</span> 的对数似然函数,则得到如下的截面似然函数: <span class="math display">\[
\begin{aligned}
l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) \\
&amp;-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) \\
&amp;+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i}
\end{aligned}
\]</span> 通过最大化上述截面似然函数, 得到 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\sigma_R\)</span> 的极大似然估计 <span class="math inline">\(\left(\hat{\sigma}_B, \hat{\sigma}_R\right)\)</span>, 这可通过 2 维搜索算法实现。最后将 <span class="math inline">\(\left(\hat{\sigma}_B, \hat{\sigma}_R\right)\)</span> 代人式 (3.64), 得到 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta\)</span> 的极大似然估计。</p>
<p>当所有观测时间相同时, 诸 <span class="math inline">\(\rho_i\)</span> 相同, 记为 <span class="math inline">\(\rho\)</span>, 可以得到 <span class="math inline">\(\hat{\mu}_\beta\)</span> 和 <span class="math inline">\(\hat{\sigma}_\beta^2\)</span> 的解析形式, 即 <span class="math display">\[
\begin{gathered}
\hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} \\
\hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho}
\end{gathered}
\]</span> 容易看出, <span class="math inline">\(\hat{\mu}_{\beta, i}\)</span> 实际上是单元 <span class="math inline">\(i\)</span> 的退化速率的加权最小二乘估计, <span class="math inline">\(\hat{\sigma}_\beta^2\)</span> 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: <span class="math display">\[
\begin{aligned}
l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| \\
&amp;-\frac{1}{2}\left\{\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right\} \\
&amp;-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right)
\end{aligned}
\]</span></p>
</section>
<section id="案例分析" class="level3">
<h3 class="anchored" data-anchor-id="案例分析">3.3 案例分析</h3>
<section id="nasa-锂电池数据" class="level4">
<h4 class="anchored" data-anchor-id="nasa-锂电池数据">3.3.1 NASA 锂电池数据</h4>
<blockquote class="blockquote">
<p>数据来源于<a href="https://c3.ndc.nasa.gov/dashlink/resources/133/">NASA Ames Prognostics Center of Excellence (PCoE)</a>，但是找不到数据下载。最后是通过 <a href="https://github.com/psanabriaUC/BatteryDatasetImplementation">Github</a> 获得。</p>
</blockquote>
<p>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即<strong>充电</strong>、<strong>放电</strong>和<strong>测量 EIS</strong>。</p>
<p>充电是以<strong>恒流模</strong>式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以<strong>恒压模式</strong>(CV)继续充电直到电流降到 20mA。</p>
<p>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</p>
<p>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Voltage_measured</th>
<th style="text-align: right;">Current_measured</th>
<th style="text-align: right;">Temperature_measured</th>
<th style="text-align: right;">Current_charge</th>
<th style="text-align: right;">Voltage_charge</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Capacity</th>
<th style="text-align: right;">id_cycle</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">ambient_temperature</th>
<th style="text-align: right;">time</th>
<th style="text-align: left;">Battery</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.974871</td>
<td style="text-align: right;">-2.012528</td>
<td style="text-align: right;">24.38909</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.062</td>
<td style="text-align: right;">35.703</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.951717</td>
<td style="text-align: right;">-2.013979</td>
<td style="text-align: right;">24.54475</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.030</td>
<td style="text-align: right;">53.781</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.934353</td>
<td style="text-align: right;">-2.011144</td>
<td style="text-align: right;">24.73139</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.011</td>
<td style="text-align: right;">71.922</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.920058</td>
<td style="text-align: right;">-2.013007</td>
<td style="text-align: right;">24.90982</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.991</td>
<td style="text-align: right;">90.094</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.907904</td>
<td style="text-align: right;">-2.014400</td>
<td style="text-align: right;">25.10588</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.977</td>
<td style="text-align: right;">108.281</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.897036</td>
<td style="text-align: right;">-2.011603</td>
<td style="text-align: right;">25.31702</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.967</td>
<td style="text-align: right;">126.453</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb23-2"><a href="#cb23-2"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb25-2"><a href="#cb25-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb25-4"><a href="#cb25-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003751909 0.017612386</code></pre>
</div>
</div>
<p>计算可靠度并绘图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6048919 0.9074667 0.6817691 0.6014642</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb29-5"><a href="#cb29-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb29-6"><a href="#cb29-6"></a>}</span>
<span id="cb29-7"><a href="#cb29-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb29-8"><a href="#cb29-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb29-10"><a href="#cb29-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb29-11"><a href="#cb29-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb29-12"><a href="#cb29-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-13"><a href="#cb29-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb29-15"><a href="#cb29-15"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="激光器件-laser-数据集" class="level4">
<h4 class="anchored" data-anchor-id="激光器件-laser-数据集">3.3.2 激光器件 Laser 数据集</h4>
<blockquote class="blockquote">
<p>数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</p>
</blockquote>
<p>激光器件的质量特征是其<strong>工作电流</strong>。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9255</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1147</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7168</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5110</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1250</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb33-3"><a href="#cb33-3"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb34-2"><a href="#cb34-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb34-4"><a href="#cb34-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00203768 0.01268431</code></pre>
</div>
</div>
<p>计算可靠度并绘图，阈值设置参考 Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety <strong>193</strong>. 第6节案例分析</p>
<p>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</p>
<blockquote class="blockquote">
<p>可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3995107</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb38-5"><a href="#cb38-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb38-6"><a href="#cb38-6"></a>}</span>
<span id="cb38-7"><a href="#cb38-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb38-8"><a href="#cb38-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb38-10"><a href="#cb38-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb38-11"><a href="#cb38-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb38-12"><a href="#cb38-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-13"><a href="#cb38-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb38-15"><a href="#cb38-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb38-16"><a href="#cb38-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="炭膜电阻器-carbon-film-resistors" class="level4">
<h4 class="anchored" data-anchor-id="炭膜电阻器-carbon-film-resistors">3.3.3 炭膜电阻器 carbon-film resistors</h4>
<blockquote class="blockquote">
<p>退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</p>
</blockquote>
<p>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</p>
<p>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Percent.Increase</th>
<th style="text-align: left;">Resistor.ID</th>
<th style="text-align: right;">DegreesC</th>
<th style="text-align: right;">Thousands.of.Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.32</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.38</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">4.341</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">8.084</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.22</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb41-2"><a href="#cb41-2"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>后续参数估计和可靠度估计就先不做了。</p>
<p>类似的数据集还包括：</p>
</section>
<section id="惯导平台-interial-navigition-数据" class="level4">
<h4 class="anchored" data-anchor-id="惯导平台-interial-navigition-数据">3.3.4 惯导平台 interial navigition 数据</h4>
<blockquote class="blockquote">
<p>数据来自于文献：Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability <strong>61</strong>(1): 50-67.</p>
</blockquote>
<p>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</p>
<p>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</p>
<p>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</p>
<p><img src="images/paste-40CEA295.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
<th style="text-align: right;">Item5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.0507</td>
<td style="text-align: right;">0.1300</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.1052</td>
<td style="text-align: right;">0.0928</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">0.1789</td>
<td style="text-align: right;">0.2554</td>
<td style="text-align: right;">0.0309</td>
<td style="text-align: right;">0.1996</td>
<td style="text-align: right;">0.2633</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0.2059</td>
<td style="text-align: right;">0.3153</td>
<td style="text-align: right;">0.0077</td>
<td style="text-align: right;">0.2927</td>
<td style="text-align: right;">0.3010</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">0.2548</td>
<td style="text-align: right;">0.3966</td>
<td style="text-align: right;">0.1510</td>
<td style="text-align: right;">0.3060</td>
<td style="text-align: right;">0.3515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">0.3117</td>
<td style="text-align: right;">0.2424</td>
<td style="text-align: right;">0.1162</td>
<td style="text-align: right;">0.2860</td>
<td style="text-align: right;">0.2818</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">0.5236</td>
<td style="text-align: right;">0.3473</td>
<td style="text-align: right;">0.0237</td>
<td style="text-align: right;">0.2918</td>
<td style="text-align: right;">0.4375</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb43-3"><a href="#cb43-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb43-4"><a href="#cb43-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb43-8"><a href="#cb43-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb43-10"><a href="#cb43-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb43-11"><a href="#cb43-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb43-13"><a href="#cb43-13"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb43-15"><a href="#cb43-15"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-16"><a href="#cb43-16"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="level4">
<h4 class="anchored" data-anchor-id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</h4>
<blockquote class="blockquote">
<p>数据来自： (Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability 61(1): 50-67).</p>
</blockquote>
<p>它是飞机上常用的金属材料，这种材料的完整性通过<strong>疲劳裂纹的长度</strong>来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</p>
<p>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。<strong>退化过程存在非线性</strong>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Cycle</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb45-4"><a href="#cb45-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb45-5"><a href="#cb45-5"></a></span>
<span id="cb45-6"><a href="#cb45-6"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb45-12"><a href="#cb45-12"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb45-14"><a href="#cb45-14"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb45-15"><a href="#cb45-15"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="gamma退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="gamma退化过程模型">4. Gamma退化过程模型</h2>
<p>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。 当产品的退化过程是严格单调非负时, Wiener 过程不再适用。Gamma 过程具有独立非负增量,可以对该类退化过程进行建模。</p>
<section id="简单gamma-退化过程" class="level3">
<h3 class="anchored" data-anchor-id="简单gamma-退化过程">4.1 简单Gamma 退化过程</h3>
<p>称连续时间随机过程 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是平稳 Gamma 过程 <span class="math inline">\({ }^{[2]}\)</span>, 若它满足以下性质:</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span> 以概率 1 成立。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 具有平稳独立增量。</p></li>
<li><p>对任意 <span class="math inline">\(t \geqslant 0\)</span> 和 <span class="math inline">\(\Delta t, X(t+\Delta t)-X(t) \sim G a(\alpha \Delta t, \beta)\)</span> 。</p>
<p>其中 <span class="math inline">\(G a(\alpha, \beta)\)</span> 是形状参数为 <span class="math inline">\(\alpha&gt;0\)</span> 、尺度参数为 <span class="math inline">\(\beta&gt;0\)</span> 的 Gamma 分布, 分布密度函数为 <span class="math display">\[
f(x \mid \alpha, \beta)=\frac{1}{\Gamma(\alpha) \beta^\alpha} \alpha^{\alpha-1} \mathrm{e}^{-x / \beta} I_{(0, \infty)}(x)
\]</span> 并且 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 称为形状参数为 <span class="math inline">\(\alpha&gt;0\)</span> 、尺度参数为 <span class="math inline">\(\beta&gt;0\)</span> 的平稳 Gamma 过程。</p></li>
</ol>
<p><strong>产品寿命</strong></p>
<p>因为Gamma 过程的退化是单调递增的，即<span class="math inline">\(X(t) \sim Ga(\alpha t,\beta)\)</span> ,因此<strong>产品寿命</strong>的分布可以直接通过退化量的转换获得。当给定产品退化失效阈值 <span class="math inline">\(\ell\)</span> 时，产品寿命 <span class="math inline">\(T\)</span> 的CDF和PDF为</p>
<p><span class="math display">\[
\begin{aligned}
{F}_{{T}}(t) &amp;={P}({T} \leqslant {t})={P}({X}({t}) \geqslant \ell) \\
&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha {t}) \beta^{\alpha {t}}} {x}^{\alpha {t}-1} \mathrm{e}^{-\frac{{x}}{\beta}} {dx} \\
&amp;=\frac{1}{\Gamma(\alpha {t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi ,\\
{f}_{{T}}(t) &amp;=\frac{{d}}{{dt}} \frac{\Gamma(\alpha {t}, 1 / \beta)}{\Gamma(\alpha {t})} \\
&amp;=\frac{\alpha}{\Gamma(\alpha {t})} \int_0^{\nu / \beta}\left[\ln (\xi)-\frac{\Gamma^{\prime}(\alpha {t})}{\Gamma(\alpha {t})}\right] \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi.
\end{aligned}
\]</span></p>
<p>由于<span class="math inline">\({f}_{{T}}({t})\)</span> 相当复杂，因此一般用B-S分布来逼近：</p>
<p><span class="math display">\[
{F}(t ; \ell)=\Phi\left[\frac{1}{{v}}\left(\sqrt{\frac{{t}}{{u}}}-\sqrt{\frac{{u}}{{t}}}\right)\right], \quad {t}&gt;0.
\]</span> 其中，<span class="math inline">\(\Phi(\cdot)\)</span> 为标准正态分布，<span class="math inline">\(v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}\)</span>. 相应的 PDF 为 <span class="math display">\[
{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} {uv}}\left[\left(\frac{{u}}{{t}}\right)^{\frac{1}{2}}+\left(\frac{{u}}{{t}}\right)^{\frac{3}{2}}\right] \exp \left[-\frac{1}{2 {v}^2}\left(\frac{{t}}{{u}}-2+\frac{{u}}{{t}}\right)\right], {t}&gt;0.
\]</span></p>
<p><strong>剩余寿命</strong></p>
<p>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 <span class="math display">\[
\begin{aligned}
{F}(t \mid s) &amp;={P}\left({T} \leqslant t \mid {X}(s)={x}_{s}\right) \\
&amp;={P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) \\
&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .
\end{aligned}
\]</span> 这与将失效阈值由 <span class="math inline">\(\ell\)</span> 变为 <span class="math inline">\(\ell-{x_s}\)</span> 、时间 <span class="math inline">\(t\)</span> 变为 <span class="math inline">\(t-s\)</span> 情形的寿命分布是一样的. 因此，在给定当前状态情况下，可以按照类似的途径更新剩余寿命.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="fu">library</span>(viridis)</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="数据模拟产生-1" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生-1">4.1.1 数据模拟产生</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)){</span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="co"># para 指 alpha,beta</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb47-6"><a href="#cb47-6"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb47-7"><a href="#cb47-7"></a>  dat <span class="ot">=</span> dat_unit <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb47-8"><a href="#cb47-8"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> dat_unit[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb47-9"><a href="#cb47-9"></a>  <span class="co"># dat_unit = numeric()</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb47-11"><a href="#cb47-11"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) {</span>
<span id="cb47-12"><a href="#cb47-12"></a>      dat_unit[j,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],para[<span class="dv">2</span>])</span>
<span id="cb47-13"><a href="#cb47-13"></a>      dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb47-14"><a href="#cb47-14"></a>    }</span>
<span id="cb47-15"><a href="#cb47-15"></a>  }</span>
<span id="cb47-16"><a href="#cb47-16"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb47-17"><a href="#cb47-17"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb47-18"><a href="#cb47-18"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb47-19"><a href="#cb47-19"></a>  </span>
<span id="cb47-20"><a href="#cb47-20"></a>  dat_unit <span class="ot">=</span> <span class="fu">data.frame</span>(dat_unit)</span>
<span id="cb47-21"><a href="#cb47-21"></a>  dat_unit1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat_unit) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb47-22"><a href="#cb47-22"></a>  <span class="fu">colnames</span>(dat_unit1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb47-23"><a href="#cb47-23"></a>  </span>
<span id="cb47-24"><a href="#cb47-24"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dat1,dat_unit1)) <span class="co">#dat1是退化量,data_unit1是退化增量</span></span>
<span id="cb47-25"><a href="#cb47-25"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>绘制退化路径图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="co"># 画图</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb48-5"><a href="#cb48-5"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb48-6"><a href="#cb48-6"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb48-8"><a href="#cb48-8"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb48-9"><a href="#cb48-9"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb48-10"><a href="#cb48-10"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb48-13"><a href="#cb48-13"></a>  <span class="fu">print</span>(p)</span>
<span id="cb48-14"><a href="#cb48-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb49-4"><a href="#cb49-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb49-5"><a href="#cb49-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat[[<span class="dv">1</span>]])) <span class="co">#print table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.206207</td>
<td style="text-align: right;">1.877922</td>
<td style="text-align: right;">1.696670</td>
<td style="text-align: right;">1.368680</td>
<td style="text-align: right;">0.6931162</td>
<td style="text-align: right;">2.217005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.668720</td>
<td style="text-align: right;">3.470060</td>
<td style="text-align: right;">4.409680</td>
<td style="text-align: right;">2.680864</td>
<td style="text-align: right;">1.9684824</td>
<td style="text-align: right;">5.189602</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.053759</td>
<td style="text-align: right;">6.365671</td>
<td style="text-align: right;">5.873371</td>
<td style="text-align: right;">6.621449</td>
<td style="text-align: right;">2.7404044</td>
<td style="text-align: right;">5.833867</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8.500994</td>
<td style="text-align: right;">8.065389</td>
<td style="text-align: right;">7.312995</td>
<td style="text-align: right;">7.926245</td>
<td style="text-align: right;">3.7845579</td>
<td style="text-align: right;">7.624511</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">10.664396</td>
<td style="text-align: right;">12.013150</td>
<td style="text-align: right;">9.424438</td>
<td style="text-align: right;">8.408593</td>
<td style="text-align: right;">5.0740222</td>
<td style="text-align: right;">9.543801</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">plot_path</span>(dat[[<span class="dv">1</span>]]) <span class="co">#print path plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="统计推断-1" class="level4">
<h4 class="anchored" data-anchor-id="统计推断-1">4.1.2 统计推断</h4>
<p>假设共有 <span class="math inline">\({n}\)</span> 个样品进行性能退化试验. 对于样品 <span class="math inline">\(i\)</span>, 初始时刻 <span class="math inline">\(t_0\)</span> 性能退化量为 <span class="math inline">\(X_{i 0}=0\)</span>, 在时刻 <span class="math inline">\(t_1, \cdots, t_{m_i}\)</span> 测量产品的性能退化量, 得到其测量值为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span>. 记 <span class="math inline">\(\Delta x_{i j}=X_{i j}-X_{i(j-1)}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{j-1}\)</span> 和 <span class="math inline">\(t_j\)</span> 之间的性能退化量, 由 Gamma 过程的独立增量性得到<span class="math inline">\(\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)\)</span>。</p>
<section id="矩估计" class="level5">
<h5 class="anchored" data-anchor-id="矩估计">4.1.2.1 矩估计</h5>
<p>令 <span class="math inline">\(R_{i j}=\Delta X_{i j} / \Delta t_{i j}\)</span>, 则诸 <span class="math inline">\(R_{i j}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 服从形状参数为 <span class="math inline">\(\alpha\)</span> 、尺度参数为 <span class="math inline">\(\beta\)</span> 的 Gamma 分布, 且相互独立(根据 Gamma 过程独立增量特性, 以及各样品退化过程的独立性)。记 <span class="math inline">\(M=\sum_{i=1}^n m_i\)</span>, 样本均值和样本方差为 <span class="math display">\[
\begin{align}
\bar{R}&amp; =\frac{1}{M} \sum_{i=1}^n \sum_{j=1}^{m_i} R_{i j} \\
S_R^2 &amp; =\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left[R_{i j}-\bar{R}\right]^2
\end{align}
\]</span> 易知 <span class="math display">\[
\begin{aligned}
E[\bar{R}] &amp;=\alpha \beta \\
Var[\bar{R}]&amp;=\frac{1}{M^2} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right]\\
\end{aligned}
\]</span> 所以，</p>
<p><span class="math display">\[
\begin{aligned}
E\left[S_R^2\right]&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left[R_{i j}-\bar{R}\right]^2\\
&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left[R_{i j}-\alpha \beta-(\bar{R}-\alpha \beta)\right]^2 \\
&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left\{Var\left[R_{i j}\right]^2-\frac{2}{m_i} Var\left[R_{i j}\right]+ Var[\bar{R}]\right\} \\
&amp;=\frac{1}{M-1} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left[\frac{1}{\Delta t_{i j}}\right]
\end{aligned}
\]</span> 将待估参数和样本矩联系起来, 即令 <span class="math display">\[
\left\{\begin{array}{l}
\alpha \beta=\bar{R} \\
\alpha \beta^2=M S_R^2 / \sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right]
\end{array}\right.
\]</span> 可得如下矩估计: <span class="math display">\[
\begin{gathered}
\hat{\alpha}=\frac{\sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right] \bar{R}^2}{M S_R^2} \\
\hat{\beta}=\frac{M S_R^2}{\sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right] \bar{R}}
\end{gathered}
\]</span></p>
<p>上述矩估计方法是基于退化速率的，金光还给出了基于退化量的矩估计（详见P128）,注意到当测量间隔都相同时，两个矩估计方法相同。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>gamma_moment <span class="ot">=</span> <span class="cf">function</span>(data_unit, group , t ){</span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="co"># 每组测量次数相同</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb51-5"><a href="#cb51-5"></a>  M <span class="ot">=</span> group<span class="sc">*</span><span class="fu">max</span>(t)</span>
<span id="cb51-6"><a href="#cb51-6"></a>  Rij <span class="ot">=</span> data_unit<span class="sc">/</span>delta_t</span>
<span id="cb51-7"><a href="#cb51-7"></a>  Rbar <span class="ot">=</span> <span class="fu">sum</span>(Rij)<span class="sc">/</span>M</span>
<span id="cb51-8"><a href="#cb51-8"></a>  SR2 <span class="ot">=</span> <span class="fu">sum</span>((Rij<span class="sc">-</span>Rbar)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(M<span class="dv">-1</span>)</span>
<span id="cb51-9"><a href="#cb51-9"></a>  MSR2 <span class="ot">=</span> M<span class="sc">*</span>SR2</span>
<span id="cb51-10"><a href="#cb51-10"></a>  tt <span class="ot">=</span> group<span class="sc">*</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>delta_t)</span>
<span id="cb51-11"><a href="#cb51-11"></a>  moment_alp <span class="ot">=</span> Rbar<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>tt<span class="sc">/</span>MSR2</span>
<span id="cb51-12"><a href="#cb51-12"></a>  moment_beta <span class="ot">=</span> MSR2<span class="sc">/</span>(tt<span class="sc">*</span>Rbar)</span>
<span id="cb51-13"><a href="#cb51-13"></a>  </span>
<span id="cb51-14"><a href="#cb51-14"></a>  moment_par <span class="ot">=</span> <span class="fu">c</span>(moment_alp,moment_beta)</span>
<span id="cb51-15"><a href="#cb51-15"></a>  <span class="fu">return</span>(moment_par)</span>
<span id="cb51-16"><a href="#cb51-16"></a>  </span>
<span id="cb51-17"><a href="#cb51-17"></a>}</span>
<span id="cb51-18"><a href="#cb51-18"></a><span class="co"># 这里算出来beta的矩估计跟真值差距很大</span></span>
<span id="cb51-19"><a href="#cb51-19"></a><span class="co"># 注意如果用模拟数据产生的话，只保留增量数据,也要去掉第一行的0</span></span>
<span id="cb51-20"><a href="#cb51-20"></a><span class="co"># ？ 前面加上这么多只是为了画图好看，是不是可以删掉这些东西</span></span>
<span id="cb51-21"><a href="#cb51-21"></a>increment <span class="ot">=</span> dat[[<span class="dv">2</span>]]</span>
<span id="cb51-22"><a href="#cb51-22"></a>increment <span class="ot">=</span> increment[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb51-23"><a href="#cb51-23"></a>degradation <span class="ot">=</span> dat[[<span class="dv">1</span>]]</span>
<span id="cb51-24"><a href="#cb51-24"></a>degradation <span class="ot">=</span> degradation[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb51-25"><a href="#cb51-25"></a>  </span>
<span id="cb51-26"><a href="#cb51-26"></a>moment_par <span class="ot">=</span> <span class="fu">gamma_moment</span>(<span class="at">data_unit =</span> increment, <span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb51-27"><a href="#cb51-27"></a>moment_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.6650643 0.5376549</code></pre>
</div>
</div>
</section>
<section id="极大似然估计-1" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计-1">4.1.2.2 极大似然估计</h5>
<p>由 Gamma 过程独立增量特性, 以及 <span class="math display">\[
\Delta X_{i j} \sim G a\left(\alpha \Delta t_{i j}, \beta\right)=\frac{\left(\Delta x_{i j} / \beta\right)^{\alpha \Delta t_{i j}-1}}{\beta \Gamma\left(\alpha \Delta t_{i j}\right)} \mathrm{e}^{-\Delta x_{i j} / \beta}
\]</span> 可以获得对数似然函数为 <span class="math display">\[
l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)
\]</span> 由极大似然估计原理, 令 <span class="math display">\[
\left\{\begin{array}{l}
\frac{\partial l}{\partial \alpha}=\sum_{i=1}^n \sum_{j=1}^{m_i} \Delta t_{i j}\left(\ln x_{i j}-\psi\left(\alpha \Delta t_{i j}\right)-\ln \beta\right)=0 \\
\frac{\partial l}{\partial \beta}=\sum_{i=1}^n\left(\frac{x_{i m_i}}{\beta^2}-\frac{\alpha t_{i m_i}}{\beta}\right)=0
\end{array}\right.
\]</span> 式中 <span class="math inline">\(\psi(u)\)</span> 是 digamma 函数。 <span class="math display">\[
\begin{aligned}
&amp;\hat{\beta}=\frac{\sum_{i=1}^n X_{i m_i}}{\alpha \sum_{i=1}^n t_{i m_i}}\\
&amp;\sum_{i=1}^n\left[\sum_{j=1}^{m_i} \Delta t_{i j} \ln \left(\Delta x_{i j}\right)-t_{i m_i} \ln \frac{x_{i m_i}}{\alpha t_{i m_i}}-\sum_{j=1}^{m_i} \Delta t_{i j} \psi\left(\alpha \Delta t_{i j}\right)\right]=0
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">library</span>(BB)</span>
<span id="cb53-2"><a href="#cb53-2"></a></span>
<span id="cb53-3"><a href="#cb53-3"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb53-4"><a href="#cb53-4"></a>    <span class="co">#x is alpha</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb53-6"><a href="#cb53-6"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb53-7"><a href="#cb53-7"></a>    <span class="fu">return</span>(l)</span>
<span id="cb53-8"><a href="#cb53-8"></a>}</span>
<span id="cb53-9"><a href="#cb53-9"></a></span>
<span id="cb53-10"><a href="#cb53-10"></a>startx <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb53-11"><a href="#cb53-11"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb53-12"><a href="#cb53-12"></a></span>
<span id="cb53-13"><a href="#cb53-13"></a>mle_re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 1.807013

$residual
[1] 1.116609e-08

$fn.reduction
[1] 70482.29

$feval
[1] 8

$iter
[1] 7

$convergence
[1] 0

$message
[1] "Successful convergence"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb55-2"><a href="#cb55-2"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb55-3"><a href="#cb55-3"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:200, lower = 1, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="co"># </span></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb55-9"><a href="#cb55-9"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>gamma_R <span class="ot">=</span> <span class="cf">function</span>(t, threshold,par){</span>
<span id="cb56-3"><a href="#cb56-3"></a>  alp <span class="ot">=</span> par[<span class="dv">1</span>]</span>
<span id="cb56-4"><a href="#cb56-4"></a>  beta <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb56-5"><a href="#cb56-5"></a>  v <span class="ot">=</span> <span class="fu">sqrt</span>(beta<span class="sc">/</span>threshold)</span>
<span id="cb56-6"><a href="#cb56-6"></a>  u <span class="ot">=</span> threshold<span class="sc">/</span>(alp<span class="sc">*</span>beta)</span>
<span id="cb56-7"><a href="#cb56-7"></a>  R <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>((<span class="fu">sqrt</span>(t<span class="sc">/</span>u)<span class="sc">-</span><span class="fu">sqrt</span>(u<span class="sc">/</span>t))<span class="sc">/</span>v) </span>
<span id="cb56-8"><a href="#cb56-8"></a>  <span class="fu">return</span>(R)</span>
<span id="cb56-9"><a href="#cb56-9"></a>}</span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">70</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8373188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># plot(gamma_R(t = 1:300, threshold = 150,par = mle_par),type = "l")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="广义推断方法-1" class="level5">
<h5 class="anchored" data-anchor-id="广义推断方法-1">4.1.2.3 广义推断方法</h5>
<ul>
<li>伽马 + 随机过程</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2021). “Degradation data analysis based on gamma process with random effects.” European Journal of Operational Research 292(3): 1200-1208.</p>
<ul>
<li>伽马 + 加速寿命试验</li>
</ul>
<p>Jiang, P. H., et al.&nbsp;(2019). “Inference for constant-stress accelerated degradation test based on Gamma process.” Applied Mathematical Modelling 67: 123-134.</p>
</section>
</section>
</section>
<section id="含协变量影响及随机效应情形" class="level3">
<h3 class="anchored" data-anchor-id="含协变量影响及随机效应情形">4.2 含协变量影响及随机效应情形</h3>
<p>随机效应反映个体差异的不确定性，协变量反映环境的影响。在基于 Gamma 过程的退化建模问题中, 随机效应通过混合尺度 Gamma 过程来描述。</p>
<ul>
<li>尺度参数 <span class="math inline">\(B\)</span> 是服从 逆 Gamma 分布的随机变量, 即 <span class="math inline">\(W=B^{-1} \sim G a\left(\delta, \gamma^{-1}\right)\)</span>; 在给定 <span class="math inline">\(B=1 / w\)</span> 的情况下, <span class="math inline">\(X(t)\)</span> 是 形状函数为 <span class="math inline">\(\alpha(t)\)</span> 、尺度参数为 <span class="math inline">\(1 / w\)</span> 的非平稳 Gamma 过程。</li>
<li>如果存在协变量效应, 假设协变量可以集成进入尺度参数, 从而尺度参数 <span class="math inline">\(B\)</span> 用 <span class="math inline">\(B \xi(z)\)</span> 代替, 这里 <span class="math inline">\(z\)</span> 表示协变量, <span class="math inline">\(\xi(z)\)</span> 表示协变量效应。</li>
</ul>
<p>在这些假设下, 可以得到退化增量 <span class="math inline">\(\Delta X_{i j}\)</span> 的<strong>联合分布密度</strong>如下: <span class="math display">\[
\begin{aligned}
&amp;f\left(\Delta x_{i j}, j=1, \cdots, m_i, i=1, \cdots, n\right)=\int\left\{\prod_{i=1}^n \prod_{j=1}^{m_i} g a\left(\Delta x_{i j} ; w^{-1} \xi_{z_i}, \Delta \alpha_{i j}\right)\right\} g a\left(w ; \gamma^{-1}, \delta\right) \mathrm{d} w \\
&amp;=\prod_{i=1}^n\left[\frac{\Gamma\left(\delta+\alpha_{i m_i}\right)}{\Gamma(\delta) \prod_{j=1}^{m_i} \Gamma\left(\Delta \alpha_{i j}\right)} \frac{\left(\gamma \xi_{z_i}\right)^\delta \prod_{j=1}^{m_i}\left(\Delta x_{i j}\right)^{\Delta \alpha_{i j}-1}}{\left.\left(\gamma \xi_{z_i}+x_{i m_i}\right)^{\delta+\alpha_{i m_i}}\right]}\right] \\
\end{aligned}
\]</span> 式中 <span class="math inline">\(x_{i m_i}=\sum_{j=1}^{m_i} \Delta x_{i j}\)</span> ; <span class="math inline">\(\alpha_{i m_i}=\sum_{j=1}^{m_i} \Delta \alpha_{i j}\)</span> ; $ _{z_i}=(z_i) $; <span class="math inline">\(z_i\)</span> 是样品<span class="math inline">\(i\)</span> 的协变量取值。</p>
<p>通过极大化上述似然函数, 即可得到参数的极大似然估计。当然, 由于此似然函数非常复杂, 一般需要采用数值解法, 如牛顿 - 拉夫逊算法、拟牛顿法等。 <!-- 除上述极大似然估计外, 文献 [24]还提出一种拟极大似然方法,其中形状函数采用非参数估计,随机尺度参数的分布参数采用截面极大似然法获得。感兴趣的读者可 参考相关文献。 --></p>
<ul>
<li><p>有些情况下需要估计个体的尺度参数 <span class="math inline">\(\beta_i\)</span> 。由于 <span class="math inline">\(E\left[X_{i m_i} \mid B=\beta_i\right]=\beta_i \alpha_{i m_i}\)</span>, 因此一个有 效的估计是 <span class="math inline">\(\tilde{\beta}_i=X_{i m_i} / \alpha_{i m_i}\)</span> 。实际上, <span class="math inline">\(\tilde{\beta}_i\)</span> 是退化增量 <span class="math inline">\(\Delta X_{i j}, j=1,2, \cdots, m_i\)</span> 的最小方差线性无偏估计, 这由 <span class="math inline">\(\Delta X_{i j} \mid \beta_i=\beta_i^2 \Delta \alpha_{i j}\)</span> 可知。</p></li>
<li><p>另一种估计可由 <span class="math inline">\(W=B^{-1}\)</span> 与退化增量的联合分布得到, 这里对应的密度函数为 <span class="math inline">\(\left\{\prod_{j=1}^{m_i} g a\left(\Delta x_{i j} ; w^{-1}, \Delta \alpha_{i j}\right)\right\} g a\left(w ; \gamma^{-1}, \delta\right)\)</span>, 从中可以得到给定 退化增量情况下 <span class="math inline">\(W\)</span> 的条件分布为 <span class="math inline">\(G a\left\{\left(x_{i m_i}+\gamma\right)^{-1}, \alpha_{i m_i}+\delta\right\}\)</span>, 条件期望为 <span class="math display">\[
E\left[W \mid \Delta x_{i 1}, \cdots, \Delta x_{i m_i}\right]=\left(\alpha_{i m_i}+\delta\right) /\left(x_{i m_i}+\gamma\right)
\]</span> 将参数估计结果代人上式或上面的 <span class="math inline">\(\tilde{\beta}_i\)</span>, 得到对应于个体产品的 <span class="math inline">\(W\)</span> 或 <span class="math inline">\(B\)</span> 的实现的估计。</p></li>
</ul>
<p>除了需要估计随机效应分布, 有时还关心随机效应是否显著的假设检验问题(即是否确实存在随机效应或个体差异). <!-- 。当 $\gamma \rightarrow \infty$ 以及 $\delta=\gamma \nu$, 其中 $\nu$ 是固定和有限 的, $W=B^{-1}$ 将聚集在均值 $\nu$ 周围, 而逆 Gamma 随机变量 $B$ 将聚集在 $1 / \nu$ 周围, 从而混 合尺度 Gamma 过程趋向于形状函数为 $\alpha(t)$ 、 (公共的) 尺度参数为 $\xi_z / \nu$ 的简单 Gamma 过程。因此, 为了检验随机效应, 相当于检验假设 $\mathrm{H}_0: \gamma=\infty$ 。 --> <!-- 文献 [1]提出一种计分统计量, 下面给出其构造过程。首先, 在零假设成立条件 下, 有 --> <!-- $$ --> <!-- \begin{gathered} --> <!-- E\left[x(t)-\alpha_t \xi_z / \nu\right]=0 \\ --> <!-- E\left[\left(x(t)-\alpha_t \xi_z / \nu\right)^2\right]=\alpha_t \xi_z^2 / \nu^2 \\ --> <!-- E\left[\left(x(t)-\alpha_t \xi_z / \nu\right)^4\right]=3\left(1+2 / \alpha_t\right) \alpha_t^2 \xi_x^4 / \nu^4 --> <!-- \end{gathered} --> <!-- $$ --> <!-- 下标 0 表示在零假设成立的条件下求期望。根据式 (4.9) 并考虑协变量过程 $\xi_z$, 可以 得到个体单元对应的似然函数为 --> <!-- $$ --> <!-- f\left(\Delta x_1, \cdots, \Delta x_m\right)=\frac{\Gamma\left(\delta+\alpha_m\right)}{\Gamma(\delta) \prod_{i=1}^m \Gamma\left(\Delta \alpha_i\right)} \frac{\left(\gamma \xi_z\right)^\delta \prod_{i=1}^m\left(\Delta x_i\right)^{\Delta \alpha_i-1}}{\left(\gamma \xi_z+x_m\right)^{\delta+\alpha_m}} --> <!-- $$ --> <!-- 式中: $x_m=\sum_{i=1}^m \Delta x_i, \alpha_m=\sum_{i=1}^m \Delta \alpha_i, m$ 为单元测量次数。 从而对数似然函数为 --> <!-- $$ --> <!-- \begin{aligned} --> <!-- l=& \ln \Gamma\left(\delta+\alpha_m\right)-\ln \Gamma(\delta)-\sum_{i=1}^m \ln \Gamma\left(\Delta \alpha_i\right) \\ --> <!-- &+\delta \ln \left(\gamma \xi_z\right)+\sum_{i=1}^m\left(\Delta \alpha_i-1\right) \ln \left(\Delta x_i\right)-\left(\delta+\alpha_m\right) \ln \left(\gamma \xi_z+x_m\right) --> <!-- \end{aligned} --> <!-- $$ --></p>
<!-- 置 $\delta=\gamma \nu$, 则 -->
<!-- $$ -->
<!-- \begin{aligned} -->
<!-- &\frac{\partial l}{\partial \gamma}=\nu\left\{1+\ln \left(\gamma \xi_z\right)+\psi\left(\gamma \nu+\alpha_m\right)-\psi(\gamma \nu)-\ln \left(\gamma \xi_z+x_m\right)\right\} \\ -->
<!-- &-\xi_z\left(\gamma \nu+\alpha_m\right)\left(\gamma \xi_z+x_m\right)^{-1} -->
<!-- \end{aligned} -->
<!-- $$ -->
<!-- 式中 $: \psi(\cdot)$ 是 digamma 函数。 -->
<!-- 当 $\gamma \rightarrow \infty$ 时, $\partial l / \partial \gamma \rightarrow 0$, 因此需要更仔细的计算过程。由文献 $[43]$, 有 -->
<!-- $$ -->
<!-- \psi(u)=\ln u-\frac{1}{2 u}-\frac{1}{12 u^2}+O\left(u^{-3}\right) -->
<!-- $$ -->
<!-- 因此 -->
<!-- $$ -->
<!-- \frac{\partial l}{\partial \gamma}=\nu\left\{\ln \left(1-\frac{x_m}{\gamma \xi_z+x_m}\right)+\ln \left(1+\frac{\alpha_m}{\gamma \nu}\right)+\frac{\alpha_m}{2 \gamma \nu\left(\gamma \nu+\alpha_m\right)}+\frac{\alpha_m \frac{\xi_z}{\nu}-x_m}{\gamma \xi_z+x_m}+o\left(\gamma^{-3}\right)\right\} -->
<!-- $$ -->
<!-- 注意到对小的 $u, \ln (1+u)$ 可以近似为 $u-u^2 / 2+u^3 / 3-\cdots$, 在上面的算式中使用此近 似以简化对应项, 可以得到 $\partial l / \partial \gamma=A \gamma^{-2}+O\left(\gamma^{-3}\right)$, 其中 -->
<!-- $$ -->
<!-- A=-\frac{1}{2} \nu \xi_z^{-2}\left\{\left(x_m-\alpha_m \xi_z / \nu\right)^2-\alpha_m \xi_z^2 / \nu^2\right\} -->
<!-- $$ -->
<!-- $A$ 是用于检验随机效应的统计量。虽然它不是通过对数似然的一阶导数计算的原始计 分统计量, 它确实是导数的主要项, 因此也称作计分统计量。 -->
<!-- 由式(4.29)看到, 式 (4.33) 括号中的项表示样本 $X\left(t_{i m_i}\right)$ 的方差与总体方差的差 异, 因此由式 (4.29)得到 -->
<!-- $$ -->
<!-- E_0[A]=-\frac{1}{2} \nu \xi_z^{-2}\left\{E_0\left[\left(x_m-\alpha_m \xi_z / \nu\right)^2\right]-\alpha_m \xi_z^2 / \nu^2\right\}=0 -->
<!-- $$ -->
<!-- 以及 -->
<!-- $$ -->
<!-- \begin{aligned} -->
<!-- \operatorname{Var}_0[A] &=E_0\left[A^2\right] \\ -->
<!-- &=\frac{1}{4} \nu^2 \xi_z^{-4}\left\{E_0\left[\left(X_m-\alpha_m \xi_z / \nu\right)^4-\alpha_m^2 \xi_z^4 / \nu^4\right]\right\} \\ -->
<!-- &=\frac{\alpha_m\left(\alpha_m+3\right)}{2 \nu^2} -->
<!-- \end{aligned} -->
<!-- $$ -->
<!-- 根据大数定理,计分统计量定义为 -->
<!-- $$ -->
<!-- U=\frac{A}{\sqrt{\operatorname{Var}_0(A)}} -->
<!-- $$ -->
<!-- 它服从标准正态分布。因此, 给定数据集, 可以估计 Gamma 过程的参数, 并使用估计值 计算计分统计量 $U_{\circ}$ 如果 $\mid U$ 的值大于正态分布上 $\alpha / 2$ 分位数 $z_{\alpha / 2}$, 其中 $\alpha$ 是显著性水 平, 则应该拒绝原假设, 也就是说此时应该考虑混合尺度 Gamma 过程。 -->
</section>
<section id="有测量误差情形-1" class="level3">
<h3 class="anchored" data-anchor-id="有测量误差情形-1">4.3 有测量误差情形</h3>
<ul>
<li><p>当测量误差显著时, 此时, 观测数据是被噪声污染的 Gamma 过程的样本路径。</p></li>
<li><p>设在时刻 <span class="math inline">\(t_{i j}\)</span> 的测量值为 <span class="math inline">\(y_{i j}=x_{i j}+\varepsilon_{i j}\)</span>, 其中 <span class="math inline">\(x_{i j}\)</span> 是实际退化, <span class="math inline">\(\varepsilon_{i j}\)</span> 是正态独立随机变量, 均值为 0 , 方差为 <span class="math inline">\(\sigma_e^2\)</span> 。</p></li>
<li><p>注意到 <span class="math inline">\(\Delta y_{i j}=\Delta x_{i j}+\varepsilon_{i j}-\varepsilon_{i, j-1}\)</span>, 因此 虽然 <span class="math inline">\(\Delta x_{i j}\)</span> 是独立的, 观测到的增量 <span class="math inline">\(\Delta y_{i j}\)</span> 不再是独立的, 这导致似然函数的构造变得复杂。</p></li>
</ul>
<p>实际上, 对样品 <span class="math inline">\(i\)</span> 的观测数据, 有 <span class="math display">\[
\left(\begin{array}{c}
\Delta y_{i 1} \\
\Delta y_{i 2} \\
\vdots \\
\Delta y_{i m_i}
\end{array}\right)=\left(\begin{array}{c}
\Delta x_{i 1} \\
\Delta x_{i 2} \\
\vdots \\
\Delta x_{i m_i}
\end{array}\right)+\left[\begin{array}{cccc}
1 &amp; &amp; &amp; \\
-1 &amp; 1 &amp; &amp; \\
&amp; \ddots &amp; \ddots &amp; \\
&amp; &amp; -1 &amp; 1
\end{array}\right]\left(\begin{array}{c}
\varepsilon_{i 1} \\
\varepsilon_{i 2} \\
\vdots \\
\varepsilon_{i m_i}
\end{array}\right)
\]</span> 或者 <span class="math inline">\(\Delta \boldsymbol{y}_i=\Delta \boldsymbol{x}_i+C \varepsilon_i=\Delta \boldsymbol{x}_i+\eta_i\)</span>, 其中 <span class="math inline">\(\eta_i \sim N\left(0, \sigma^2 \Sigma\right)\)</span>, 而且 <span class="math display">\[
\sum=C C^{\prime}=\left[\begin{array}{ccccc}
1 &amp; -1 &amp; &amp; &amp; \\
-1 &amp; 2 &amp; -1 &amp; &amp; \\
&amp; \ddots &amp; \ddots &amp; \ddots &amp; \\
&amp; &amp; -1 &amp; 2 &amp; -1 \\
&amp; &amp; &amp; -1 &amp; 2
\end{array}\right]
\]</span> 也就是说, <span class="math inline">\(\eta_{i 1}, \cdots, \eta_{i m_i}\)</span> 并不是相互独立的。因此, 这时的似然函数难以解析求解, 一般 需要采用数值方法。</p>
<p><strong>更一般的情形</strong></p>
<p>下面考虑一种更加一般的情形, 并采用 MC 方法得到模型参数的估计。对实际退化进行观测, 观测值满足如下模型: <span class="math display">\[
Y(t)=F(X(t))+\varepsilon
\]</span> 这里观测噪声 <span class="math inline">\(\varepsilon \sim N\left(0, \sigma^2\right)\)</span> 。显然, 有测量误 差是这里的特殊情形, 此时只要取 <span class="math inline">\(F(t)=t\)</span> 即可。在基于退化的可靠性建模问题中, 称 <span class="math inline">\(X(t)\)</span> 为直接退化量 (Direct Indicator), 而 <span class="math inline">\(Y(t)\)</span> 称为间接退化量 (Indirect Indicator)。下 面的计算过程假设 <span class="math inline">\(F(X(t))=c X(t)^d\)</span> 。</p>
<p>假设可以在 <span class="math inline">\(t_1, t_2, \cdots, t_n\)</span> 时刻进行观测, <span class="math inline">\(n\)</span> 是观测次数。 <!-- 在第 $i$ 个观测时刻获得的直接和间接退化量记为 $x_i$ 和 $y_i$ 。进一步假设由于测量困难等原因, 只能观测到一部分直接退化量, 但是所有间接退化量都可以观测得到 (这种情况可称为不平衡测量)。 --> 函数 <span class="math inline">\(I_{\mathrm{obv}}(\cdot)\)</span> 定义为 <span class="math display">\[
I_{\mathrm{obv}}(i)= \begin{cases}0, &amp; x_i \text { 不可观测 } \\ 1, &amp; x_i \text { 可观测 }\end{cases}
\]</span> 用来表示一个观测量是直接退化量。第 <span class="math inline">\(l\)</span> 个可观测的直接退化量的观测时间指标记为 <span class="math inline">\(k_l, l=1,2, \cdots, m\)</span>, 其中 <span class="math inline">\(m\)</span> 是观测的直接退化量的个数。显然 <span class="math inline">\(I_{\mathrm{obv}}\left(k_l\right)=1, l=1,2, \cdots\)</span>, <span class="math inline">\(m\)</span> 。假设至少能够观测到一个直接退化量, 即 <span class="math inline">\(m&gt;0\)</span> 。下面采用 EM 算法来解决参数估 计问题。 假设可观测的直接退化量 <span class="math inline">\(x_{k_{1, m}}=\left\{x_{k_l}: l=1,2, \cdots, m\right\}\)</span> 以及它们对应的间接退化量 <span class="math inline">\(y_{k_{1, m}}=\left\{y_{k_l}: l=1,2, \cdots, m\right\}\)</span>, 则基于 <span class="math inline">\(x_{k_1, m}\)</span> 和 <span class="math inline">\(y_{k_{1, m}}\)</span> 的完整似然函数, 可以得到参数的一个极 大似然估计, 将该估计作为模型参数的初始值。</p>
<p><strong>EM算法</strong></p>
<p>在 <span class="math inline">\(\mathrm{EM}\)</span> 算法的 <span class="math inline">\(\mathrm{E}\)</span> 步, 需要估计对应于所有 <span class="math inline">\(n\)</span> 个时刻的可能观测数据的完整的似然 函数的期望。完整似然函数可以分为两个部分: <span class="math display">\[
E\left[\ln \left(f\left(x_{1 ; n}, y_{1 ; n} \mid \boldsymbol{\theta}\right)\right)\right]=E\left[\ln \left(f\left(x_{1 ; n} \mid \boldsymbol{\theta}_1\right)\right)\right]+E\left[\ln \left(f\left(y_{1 ; n} \mid \boldsymbol{\theta}_2, x_{1 ; n}\right)\right)\right]
\]</span> 式中: 参数 <span class="math inline">\(\boldsymbol{\theta} 、 \boldsymbol{\theta}_1\)</span> 和 <span class="math inline">\(\boldsymbol{\theta}_2\)</span> 表示待估参数向量, 其中 <span class="math inline">\(\boldsymbol{\theta}=(a, b, \beta, c, d, \boldsymbol{\sigma}), \boldsymbol{\theta}_1=(a, b, \boldsymbol{\beta}), \boldsymbol{\theta}_2=\)</span> <span class="math inline">\((c, d, \sigma)\)</span> 。式 (4.37) 的两个部分可以进一步计算如下: <span class="math display">\[
\begin{aligned}
&amp; E\left[\ln \left(f\left(x_{1 ; n} \mid \boldsymbol{\theta}_1\right)\right)\right] \\
=&amp; E\left(\ln \left(\prod_{i=2}^n g a\left(v_i ; u_i, \beta\right)\right)\right) \\
=&amp; \sum_{i=2}^n\left(-u_i \ln \beta-\ln \Gamma\left(u_i\right)+\left(u_i-1\right) E\left(\ln \left(v_i\right)\right)-\left(E\left(X_i\right)-E\left(X_{i-1}\right)\right) / \beta\right)
\end{aligned}
\]</span> 和 <span class="math display">\[
\begin{aligned}
&amp; E\left[\ln \left(f\left(y_{1: n} \mid \boldsymbol{\theta}_2, x_{1: n}\right)\right)\right] \\
=&amp;-n \ln \sigma-\frac{n}{2} \ln 2 \pi-\frac{1}{2 \sigma 2} \sum_{i=1}^n\left(y_i^2-2 y_i c E\left(X_i^d\right)+c^2 E\left(X_i^{2 d}\right)\right)
\end{aligned}
\]</span> 式中 <span class="math inline">\(: v_i=x_i-x_{i-1}, i=2,3, \cdots, n ; u_i=a t_i^b-a t_{i-1}^b, i=2,3, \cdots, n_{\text {。 }}\)</span></p>
<p>式中的 4 个期望值 <span class="math inline">\(E\left(X_i\right) 、 E\left(X_i^d\right) 、 E\left(X_i^{2 d}\right)\)</span> 以及 <span class="math inline">\(E\left(\ln \left(\nu_i\right)\right)\)</span> 通过下面的仿真方法(粒子光滑算法) 获得。</p>
<p><strong>仿真方法(粒子光滑算法)</strong></p>
<ol type="1">
<li>首先辨识基于 Gamma 过程的状态空间模型的状态转移过程。 <!-- 根据 Gamma 桥性质,在获得直接退化量的观测数据之后, 系统的退化过程从Gamma过程变为混合随机过程,该混合随机过程为 --> <span class="math display">\[
\begin{aligned}
&amp;f\left(X_i \mid X_{1: n-1}, X_{k_{1, m}}\right) \\
&amp;= \begin{cases}f\left(X_i \mid X_{i-1}, X_{n_i}\right)=b e\left(\frac{x_i-x_{i-1}}{x_{n_i}-x_{i-1}} ; \alpha\left(t_i\right)-\alpha\left(t_{i-1}\right), \alpha\left(t_{n_i}\right)-\alpha\left(t_i\right)\right), \\
&amp; I_{\mathrm{obv}}(i)=0, i&lt;k_m \\
f\left(X_i \mid X_{i-1}\right)=g a\left(x_i-x_{i-1} ; \alpha\left(t_i\right)-\alpha\left(t_{i-1}\right), \beta\right), &amp; I_{\mathrm{obv}}(i)=0, i&gt;k_m\end{cases}
\end{aligned}
\]</span></li>
</ol>
<p>式中: <span class="math inline">\(n_i\)</span> 是给定当前观测时间指标 <span class="math inline">\(i\)</span> 的条件下,下一个直接观测退化量的观测时间指 标, 即 <span class="math inline">\(n_i=\min \left\{u ; u&gt;i, I_{\mathrm{obv}}(u)=1\right\}, i&lt;k_m ; b e(\because ; \alpha, \beta)\)</span> 是参数为 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的 Beta 分布的概率密度函数。 <!-- (这里利用了 Gamma 桥性质。当直接退化量是 Wiener 过程时, 可用 Brownian 桥性质构造类似的混合随机过程; 更一般的情况可以通过 Bayesian 定理构造 验后随机过程)。 --></p>
<ol start="2" type="1">
<li>从该混合随机过程抽取 <span class="math inline">\(N_f\)</span> 个样本序列, 记为 <span class="math inline">\(s_{1: n}^{1: N_f}=\left\{s_i^j: i=1,2, \cdots, n, j=1,2, \cdots\right.\)</span>, <span class="math inline">\(\left.N_f\right\}\)</span>, <!-- 使用这 $N_f$ 个序列可以得到式 (4.50) 和式 (4.51) 中的期望值的估计: --> <span class="math display">\[
\begin{cases}E\left(X_i\right)=\frac{1}{N_f} \sum_{j=1}^{N_f} s_i^j, &amp; E\left(X_i^{2 d}\right)=\frac{1}{N_f} \sum_{j=1}^{N_f}\left(s_i^j\right)^{2 d} \\ E\left(X_i^d\right)=\frac{1}{N_f} \sum_{j=1}^{N_f}\left(s_i^j\right)^d, &amp; E\left(\ln \left(X_i-X_{i-1}\right)\right)=\frac{1}{N_f} \sum_{j=1}^{N_f} \ln \left(s_i^j-s_{i-1}^j\right)\end{cases}
\]</span> 一旦获得了完整似然函数的期望, 就可以进行最大化获得对应的参数的”条件” 似然估计。</li>
</ol>
<!-- 基于 Gamma 过程的状态空间模型的参数估计结束后, 应该计算协方差矩阵以便得 到置信区间估计。文献 [44]基于粒子光滑得到计算协方差矩阵的方法, 其中观测的信 息阵为 -->
<!-- $$ -->
<!-- \begin{gathered} -->
<!-- -\frac{\partial^2 \ln f\left(y_{1: n}, x_{k_{1, m}} \mid \boldsymbol{\theta}\right)}{\partial \theta \partial \theta^{\mathrm{T}}} \approx \frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial^2 \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \theta \partial \theta^{\mathrm{T}}} \\ -->
<!-- -\frac{1}{N_f} \sum_{j=1}^{N_f} \frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}} \frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}^{\mathrm{T}}} \\ -->
<!-- +\left(\frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}}\right)\left(\frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}^{\mathrm{T}}}\right) -->
<!-- \end{gathered} -->
<!-- $$ -->
<!-- 式中 $: s_{1, n}^j$ 是光滑粒子的第 $j$ 个序列。 -->
<!-- **基于粒子光滑的序贯抽样方法** -->
<!-- 1. 首先,假设基于直到第 $i$ 个观测时刻 $t_i$ 的间接退化量 $y_{1: i}$ 得到 $t_i$ 时刻的直接退化量分布, 表示为 -->
<!-- $$ -->
<!-- f\left(x_i \mid y_{1: i}\right) \approx \sum_{j=1}^{N_f} w_i^j \delta\left(x_i-x_i^j\right), \quad i=1,2, \cdots, n -->
<!-- $$ -->
<!-- 式中: $\delta(\cdot)$ 是狄拉克函数, 定义为 -->
<!-- $$ -->
<!-- \delta\left(x-x^j\right)= \begin{cases}0, & x \neq x^j \\ 1, & x=x^j\end{cases} -->
<!-- $$ -->
<!-- 2. 随机数 $\left\{x_i^j ; j=1, \cdots, N_f \mid\right.$ 被称作粒子, 它们一般通过一个重要性分布 $q\left(x_i^j \mid x_{i-1}^j, y_i\right)$ 抽取, 并且对应的权重 $\left\{w_i^j ; j=1, \cdots, N_f\right\}$ 可以递推计算如下: -->
<!-- $$ -->
<!-- w_i^j \propto w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i\right)} -->
<!-- $$ -->
<!-- 显然, 在上述逼近验后分布的过程中, 只用了截止到当前时刻的观测值, 称为粒子 滤波过程。粒子光滑考虑了整个观测序列, 因此具有更好的近似精度。 $\operatorname{Simon}^{[44]}$ 提出 的后向模拟粒子光滑, 是基于粒子滤波(即 $x_{1: n}^{1: N_f}=\left\{x_i^j ; i=1,2, \cdots, n, j=1,2, \cdots, N_f\right\}$ ) 的。 粒子光滑的递推算法为 -->
<!-- $$ -->
<!-- w_{i i i+1}^{j, u} \propto \frac{w_i^u f\left(s_{i+1}^j \mid x_i^u\right)}{\sum_{i=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^{\varepsilon}\right)}, \quad u=1,2, \cdots, N_f, i=1,2, \cdots, n-1 -->
<!-- $$ -->
<!-- 式中: $w_{i i i+1}^{j, u}$ 表示在第 $i$ 步的对应于第 $i+1$ 步的第 $j$ 个光滑粒子的第 $u$ 个滤波粒子的 权重。 -->
<!-- 然后根据权重 $w_{i l i+1}^{j, 1, N_f}=\left\{w_{i i i+1}^{j, u} ; u=1,2, \cdots, N_f\right\}$ 从 $x_i^{1, N_f}$ 重采样得到随机数 $s_i^j$, 在第 $i$ 个时刻状态的分布就采用光滑粒子 $\left\{s_i^j ; j=1,2, \cdots, N_f\right\}$ 近似。 -->
<!-- 回到退化过程,滤波粒子的权重按如下方式递推地更新: -->
<!-- $$ -->
<!-- w_i^j \propto \begin{cases}w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j, x_{n_i}\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i, x_{n_i}\right)}, & i<k_m \\ w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i\right)}, & i>k_m\end{cases} -->
<!-- $$ -->
<!-- 两个重要性密度, 即 $q\left(x_i^j \mid x_{i-1}^j, y_i, x_{n_i}\right)$ 和 $q\left(x_i^j \mid x_{i-1}^j, y_i\right)$, 服从式 (4.40) 中的两个方程, 即 $f\left(x_i \mid x_{i-1}, x_{n_i}\right)$ 和 $f\left(x_i \mid x_{i-1}\right)$ 。在时间点 $t_{k_{1, m}}=\left\{t_{k_l} ; l=1,2, \cdots, m\right\}$ 直接退化量是已知的, 所有 $N_f$ 个粒子就直接设置为观测到的直接退化量 $x_{k_{1, m}}$ 。在其他时刻采用序贯重要性 重采样(SIR)算法。类似地, 式 (4.44) 中光滑粒子的递推权重计算公式修正为 -->
<!-- $$ -->
<!-- w_{i i+1}^{j, u} \propto \begin{cases}\frac{w_i^u f\left(s_{i+1}^j \mid x_i^u, x_{n_{i+1}}\right)}{\sum_{f=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^v, x_{n_{i+1}}\right)}, & i<k_m \\ \frac{w_i^u f\left(s_{i+1}^j \mid x_i^u\right)}{\sum_{v=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^v\right)}, & i>k_m\end{cases} -->
<!-- $$ -->
<!-- 式 (4.46) 中的两个部分 $f\left(s_{i+1}^j \mid x_i^u, x_{n_{i+1}}\right)$ 和 $f\left(s_{i+1}^j \mid x_i^u\right)$ 满足式 (4.40) 中的两个方 程。在时刻 $t_i$, 若 $I_{\mathrm{obv}}(i)=1$ 或 $I_{\mathrm{obv}}(i+1)=1$, 粒子滤波结果直接取为粒子光滑的结果; 在其他时刻,粒子光滑通过后向模拟算法得到。 -->
</section>
<section id="案例分析-1" class="level3">
<h3 class="anchored" data-anchor-id="案例分析-1">4.4 案例分析</h3>
<section id="wear-data" class="level4">
<h4 class="anchored" data-anchor-id="wear-data">4.4.1 wear data</h4>
<blockquote class="blockquote">
<p>数据来自： Ye Z.S., et al.&nbsp;(2014). “Semiparametric Estimation of Gamma Processes for Deteriorating Products” Technometrics</p>
</blockquote>
<p>Wear of a tire tread is a major cause of tire failures. To assess the wear behavior of a batch of tire treads from a factory, a bus park in South Korea sampled some tires installed on buses of the same version. Degradation level of each tire was measured, and its time in service (in thousands of kilometers) was retrospected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>wear_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/wear data.csv"</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wear_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">wear</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.3</td>
<td style="text-align: right;">6.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">46.5</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">47.1</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">48.1</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">49.0</td>
<td style="text-align: right;">6.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">49.7</td>
<td style="text-align: right;">5.8</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>wear_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(wear_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>wear_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,wear,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="crack-of-titanium" class="level4">
<h4 class="anchored" data-anchor-id="crack-of-titanium">4.4.2 Crack of Titanium</h4>
<p>A manufacturer of Titanium (Ti) Grade has the highest ultimate strength of the pure Ti Grades. It is used in many applications where high strength is required. However, under high stress and high cycle fatigue, it develops cracks that lead to failures. In order to conduct a RDT, the manufacturer machined 10 bars with 0.5” diameter and subjected them to high stress and made notches (of the same dimensions) in all the bars to accelerate the crack growth. The crack length is measured every five days and is recoded for the ten units as shown in Table 6.10. The measurements are expressed in 0.001 mm but scaled for calculation purposes. Determine the number of days when the crack threshold reaches 2mm (1500 in the measurement scale)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>ti_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Crack_Length_Data_of_Ten_Bar_of_Ti.csv"</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(ti_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">crack_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">218</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">311</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">410</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">507</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">605</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>ti_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(ti_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>ti_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,crack_length,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="lithium-ion-batteries" class="level4">
<h4 class="anchored" data-anchor-id="lithium-ion-batteries">4.4.3 Lithium-ion batteries</h4>
<p>Lithium-ion batteries are widely used in many applications and consumer products including electric vehicles because of their high energy density and power capability. However, the long-term performance (capacity to provide the power) decreases with number of charge and discharge cycles. A degradation test is conducted on four battery cells with initial capacities in Ah (Ampere hours, which is defined as is the amount of energy charge in a battery that will allow one ampere of current to flow for one hour). The cells are discharged and charged, and the battery capacity is measured after the accumulation of a number of charge-discharge cycles. The battery is considered failed when its capacity is <span class="math inline">\(80 \%\)</span> of the original capacity. Use the first 25 observations of each cell and develop a general degradation model. Then utilize the model to predict the capacities at the remaining 17 cycles and calculate the error prediction of the models. Note that the original capacity corresponds to zero cycles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>li_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Lithium-ion batteries.csv"</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(li_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">cycles</th>
<th style="text-align: right;">Cell.1</th>
<th style="text-align: right;">Cell.2</th>
<th style="text-align: right;">Cell.3</th>
<th style="text-align: right;">Cell.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.543</td>
<td style="text-align: right;">2.532</td>
<td style="text-align: right;">2.525</td>
<td style="text-align: right;">2.496</td>
</tr>
<tr class="even">
<td style="text-align: right;">150</td>
<td style="text-align: right;">2.497</td>
<td style="text-align: right;">2.495</td>
<td style="text-align: right;">2.487</td>
<td style="text-align: right;">2.466</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">2.466</td>
<td style="text-align: right;">2.467</td>
<td style="text-align: right;">2.463</td>
<td style="text-align: right;">2.438</td>
</tr>
<tr class="even">
<td style="text-align: right;">450</td>
<td style="text-align: right;">2.453</td>
<td style="text-align: right;">2.452</td>
<td style="text-align: right;">2.447</td>
<td style="text-align: right;">2.435</td>
</tr>
<tr class="odd">
<td style="text-align: right;">600</td>
<td style="text-align: right;">2.428</td>
<td style="text-align: right;">2.424</td>
<td style="text-align: right;">2.412</td>
<td style="text-align: right;">2.399</td>
</tr>
<tr class="even">
<td style="text-align: right;">750</td>
<td style="text-align: right;">2.400</td>
<td style="text-align: right;">2.400</td>
<td style="text-align: right;">2.393</td>
<td style="text-align: right;">2.376</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># ti_dat$Unit = as.factor(li_dat$Unit)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>li_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>,Cell<span class="fl">.2</span>,Cell<span class="fl">.3</span>,Cell<span class="fl">.4</span>)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.2</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb67-3"><a href="#cb67-3"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.3</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.4</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb67-5"><a href="#cb67-5"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fatigue-crack-data" class="level4">
<h4 class="anchored" data-anchor-id="fatigue-crack-data">4.4.4 fatigue crack data</h4>
<blockquote class="blockquote">
<p>数据来自： Meeker, W. Q. (1998). Statistical Methods for Reliability Data</p>
</blockquote>
<p>Fatigue Crack-Size Data gives the size of fatigue cracks as a function of number of cycles of applied stress for 21 test specimens. The data were collected to obtain information on crack growth rates for the alloy. Usually, we will refer to these data as Alloy-A and assume that a crack of size <span class="math inline">\(1.6\)</span> inches is considered to be a failure.</p>
<p><img src="images/Fatigue%20Crack%20Growth%20Data.jpg" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>fatigue_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Fatigue Crack Growth Data.csv"</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(fatigue_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">path</th>
<th style="text-align: right;">cycles</th>
<th style="text-align: right;">crack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>fatigue_dat<span class="sc">$</span>path <span class="ot">=</span> <span class="fu">as.factor</span>(fatigue_dat<span class="sc">$</span>path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>fatigue_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,crack,<span class="at">color =</span> path)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"cycles"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb71" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">---</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="an">title:</span><span class="co"> "退化过程模型综述"</span></span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="an">author:</span><span class="co"> "庄亮亮、吴温慧"</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="co">  html:</span></span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="co">    toc: TRUE</span></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="co">    toc-title: "目录"</span></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="co">    theme: cerulean</span></span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="co">    code-tools: true</span></span>
<span id="cb71-11"><a href="#cb71-11"></a><span class="co">    highlight-style: cerulean.theme</span></span>
<span id="cb71-12"><a href="#cb71-12"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb71-13"><a href="#cb71-13"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb71-14"><a href="#cb71-14"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb71-15"><a href="#cb71-15"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb71-16"><a href="#cb71-16"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb71-17"><a href="#cb71-17"></a><span class="co">---</span></span>
<span id="cb71-18"><a href="#cb71-18"></a></span>
<span id="cb71-19"><a href="#cb71-19"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb71-20"><a href="#cb71-20"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-21"><a href="#cb71-21"></a><span class="in">```</span></span>
<span id="cb71-22"><a href="#cb71-22"></a></span>
<span id="cb71-23"><a href="#cb71-23"></a><span class="fu">## 1. 介绍</span></span>
<span id="cb71-24"><a href="#cb71-24"></a></span>
<span id="cb71-25"><a href="#cb71-25"></a>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在**基于退化的可靠性模型**方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</span>
<span id="cb71-26"><a href="#cb71-26"></a></span>
<span id="cb71-27"><a href="#cb71-27"></a><span class="ss">1.  </span>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</span>
<span id="cb71-28"><a href="#cb71-28"></a></span>
<span id="cb71-29"><a href="#cb71-29"></a><span class="ss">2.  </span>基于 Wiener 过程的模型</span>
<span id="cb71-30"><a href="#cb71-30"></a></span>
<span id="cb71-31"><a href="#cb71-31"></a><span class="ss">3.  </span>基于 Gamma 过程的模型</span>
<span id="cb71-32"><a href="#cb71-32"></a></span>
<span id="cb71-33"><a href="#cb71-33"></a><span class="ss">4.  </span>累积损伤模型(主要是基于混合 Poisson 过程的模型）</span>
<span id="cb71-34"><a href="#cb71-34"></a></span>
<span id="cb71-35"><a href="#cb71-35"></a><span class="ss">5.  </span>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</span>
<span id="cb71-36"><a href="#cb71-36"></a></span>
<span id="cb71-37"><a href="#cb71-37"></a>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究**矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法**，以及**非参数和半参数方法**等，解决模型辨识和修正问题;</span>
<span id="cb71-38"><a href="#cb71-38"></a></span>
<span id="cb71-39"><a href="#cb71-39"></a>采用**似然比检验、Bayes 因子分析**等方法进行模型验证;</span>
<span id="cb71-40"><a href="#cb71-40"></a></span>
<span id="cb71-41"><a href="#cb71-41"></a>采用**均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)**等进行模型优良性检验。</span>
<span id="cb71-42"><a href="#cb71-42"></a></span>
<span id="cb71-43"><a href="#cb71-43"></a>在基于退化的可靠性技术应用方面，针对**机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）**等的退化失效过程，开展**退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计**：特别是加速退化试验方案设计的研究。</span>
<span id="cb71-44"><a href="#cb71-44"></a></span>
<span id="cb71-45"><a href="#cb71-45"></a><span class="fu">## 2. 退化轨道模型</span></span>
<span id="cb71-46"><a href="#cb71-46"></a></span>
<span id="cb71-47"><a href="#cb71-47"></a><span class="at">&gt; 暂时不考虑</span></span>
<span id="cb71-48"><a href="#cb71-48"></a></span>
<span id="cb71-49"><a href="#cb71-49"></a><span class="fu">## 3. Wiener 退化过程模型</span></span>
<span id="cb71-50"><a href="#cb71-50"></a></span>
<span id="cb71-51"><a href="#cb71-51"></a>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</span>
<span id="cb71-52"><a href="#cb71-52"></a></span>
<span id="cb71-53"><a href="#cb71-53"></a>Wiener 退化过程的**首达时间分布具有解析形式**，便于对**产品寿命**和**可靠度**的分析和计算。</span>
<span id="cb71-54"><a href="#cb71-54"></a></span>
<span id="cb71-55"><a href="#cb71-55"></a>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</span>
<span id="cb71-56"><a href="#cb71-56"></a></span>
<span id="cb71-57"><a href="#cb71-57"></a>通过对经典 Wiener 过程的参数引入**随机性**，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</span>
<span id="cb71-58"><a href="#cb71-58"></a></span>
<span id="cb71-59"><a href="#cb71-59"></a><span class="at">&gt; 对 Wiener 退化过程及其观测过程所构成的**状态空间模型**，可以采用 **Kalman 滤波技术**进行处理，为产品**在线寿命预测、视情维修决策**等提供了可行的算法和实现途径。</span></span>
<span id="cb71-60"><a href="#cb71-60"></a></span>
<span id="cb71-61"><a href="#cb71-61"></a><span class="fu">### 3.1 带漂移的 Wiener 过程</span></span>
<span id="cb71-62"><a href="#cb71-62"></a></span>
<span id="cb71-63"><a href="#cb71-63"></a>称 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是漂移参数为 $\mu$ 、扩散参数为 $\sigma$ 的 (一元) Wiener 过程, 若</span>
<span id="cb71-64"><a href="#cb71-64"></a></span>
<span id="cb71-65"><a href="#cb71-65"></a>(1) $X(0)=0$。</span>
<span id="cb71-66"><a href="#cb71-66"></a></span>
<span id="cb71-67"><a href="#cb71-67"></a>(2) $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 有平稳独立增量。</span>
<span id="cb71-68"><a href="#cb71-68"></a></span>
<span id="cb71-69"><a href="#cb71-69"></a>(3) $X(t)$ 服从均值为 $\mu t$,方差为 $\sigma^2 t$ 的正态分布。</span>
<span id="cb71-70"><a href="#cb71-70"></a></span>
<span id="cb71-71"><a href="#cb71-71"></a>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: $$</span>
<span id="cb71-72"><a href="#cb71-72"></a>X(t)=\mu t+\sigma B(t)</span>
<span id="cb71-73"><a href="#cb71-73"></a>$$ 式中: $<span class="sc">\{</span>B(t)<span class="sc">\}</span>, t \geqslant 0$ 是标准 Wiener 过程或标准布朗运动过程。</span>
<span id="cb71-74"><a href="#cb71-74"></a></span>
<span id="cb71-75"><a href="#cb71-75"></a>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</span>
<span id="cb71-76"><a href="#cb71-76"></a></span>
<span id="cb71-77"><a href="#cb71-77"></a>（1）时刻 $t \sim t+\Delta t$ 之间的增量服从正态分布, 即 $\Delta X=X(t+\Delta t)-X(t) \sim$ $N\left(\mu \Delta t, \sigma^2 \Delta t\right)$ 。</span>
<span id="cb71-78"><a href="#cb71-78"></a></span>
<span id="cb71-79"><a href="#cb71-79"></a>(2) 对任意两个不相交的时间区间 $\left<span class="co">[</span><span class="ot">t_1, t_2\right</span><span class="co">]</span>,\left<span class="co">[</span><span class="ot">t_3, t_4\right</span><span class="co">]</span>, t_1<span class="kw">&lt;t_2</span> <span class="er">\leqslant</span> <span class="er">t_3&lt;t_4$,</span> <span class="er">增量</span> <span class="er">$X\left(t_4\right)-X$</span> <span class="er">$\left(t_3\right)$</span> <span class="er">与</span> <span class="er">$X\left(t_2\right)-X\left(t_1\right)$</span> <span class="er">相互独立。</span></span>
<span id="cb71-80"><a href="#cb71-80"></a></span>
<span id="cb71-81"><a href="#cb71-81"></a><span class="er">如果产品的性能退化过程是一元</span> <span class="er">Wiener</span> <span class="er">过程,假设其运行到时刻</span> <span class="er">$\tau$</span> <span class="er">仍末失效,</span> <span class="er">且</span> <span class="er">当前性能退化量为</span> <span class="er">$x_\tau\left(x_\tau&lt;l\right)$,</span> <span class="er">则产品的剩余寿命</span> <span class="er">$T_1$</span> <span class="er">可以表示为</span> <span class="er">$$</span></span>
<span id="cb71-82"><a href="#cb71-82"></a><span class="ot">T_1=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)</span> <span class="er">\geqslant</span> <span class="er">l,</span> <span class="er">X(\tau)</span><span class="ot">=</span><span class="st">x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb71-83"><a href="#cb71-83"></a><span class="er">$$</span> <span class="er">由一元</span> <span class="er">Wiener</span> <span class="er">过程的独立增量性质和齐次马尔可夫性得到</span> <span class="er">$$</span></span>
<span id="cb71-84"><a href="#cb71-84"></a><span class="er">\begin{aligned}</span></span>
<span id="cb71-85"><a href="#cb71-85"></a><span class="ot">T_1</span> <span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)-X(\tau)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span> <span class="er">\\</span></span>
<span id="cb71-86"><a href="#cb71-86"></a><span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb71-87"><a href="#cb71-87"></a><span class="er">\end{aligned}</span></span>
<span id="cb71-88"><a href="#cb71-88"></a><span class="er">$$</span> <span class="er">可知剩余寿命</span> <span class="er">$T_1$</span> <span class="er">也是逆</span> <span class="er">Gaussian</span> <span class="er">分布,</span> <span class="er">其密度函数只需将寿命</span> <span class="er">$T$</span> <span class="er">密度函数中的失效阈值</span> <span class="er">$l$</span> <span class="er">替换为</span> <span class="er">$l-x_\tau$,</span> <span class="er">即</span> <span class="er">$$f_{T_1}(t)</span><span class="ot">=</span><span class="st">\frac{l-x_\tau}{\sqrt{2</span> <span class="er">\pi</span> <span class="er">\sigma^2</span> <span class="er">t^3}}</span> <span class="er">\exp</span> <span class="er">\left[-\frac{\left(l-x_\tau-\mu</span> <span class="er">t\right)^2}{2</span> <span class="er">\sigma^2</span> <span class="er">t}\right]$$</span></span>
<span id="cb71-89"><a href="#cb71-89"></a></span>
<span id="cb71-92"><a href="#cb71-92"></a><span class="in">```{r}</span></span>
<span id="cb71-93"><a href="#cb71-93"></a><span class="ot">library</span><span class="er">(ggplot2)</span></span>
<span id="cb71-94"><a href="#cb71-94"></a><span class="ot">library</span><span class="er">(tidyverse)</span></span>
<span id="cb71-95"><a href="#cb71-95"></a><span class="ot">library</span><span class="er">(viridis)</span></span>
<span id="cb71-96"><a href="#cb71-96"></a><span class="er">```</span></span>
<span id="cb71-97"><a href="#cb71-97"></a></span>
<span id="cb71-98"><a href="#cb71-98"></a><span class="ot">#</span><span class="er">###</span> <span class="er">3.1.1</span> <span class="er">数据模拟产生</span></span>
<span id="cb71-99"><a href="#cb71-99"></a></span>
<span id="cb71-102"><a href="#cb71-102"></a><span class="in">```{r}</span></span>
<span id="cb71-103"><a href="#cb71-103"></a><span class="ot">#</span> <span class="er">数据模拟产生</span></span>
<span id="cb71-104"><a href="#cb71-104"></a><span class="ot">sim_dat</span> <span class="ot">=</span> <span class="st">function(group</span> <span class="ot">=</span> <span class="st">6,</span> <span class="er">t</span> <span class="ot">=</span> <span class="st">1:200,</span> <span class="er">para</span> <span class="ot">=</span> <span class="st">c(1,0.1)){</span></span>
<span id="cb71-105"><a href="#cb71-105"></a><span class="ot">  #</span> <span class="er">para</span> <span class="er">指</span> <span class="er">mu,sigma</span></span>
<span id="cb71-106"><a href="#cb71-106"></a><span class="ot">  #</span> <span class="er">epoch</span> <span class="er">指测量次数，</span> <span class="er">group</span> <span class="er">指组数</span></span>
<span id="cb71-107"><a href="#cb71-107"></a><span class="ot">  delta_t</span> <span class="ot">=</span> <span class="st">diff(t)</span></span>
<span id="cb71-108"><a href="#cb71-108"></a><span class="ot">  epoch</span> <span class="ot">=</span> <span class="st">length(delta_t)</span></span>
<span id="cb71-109"><a href="#cb71-109"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">matrix(NA,epoch,group+1)</span></span>
<span id="cb71-110"><a href="#cb71-110"></a><span class="ot">  dat</span><span class="er">[,1]</span> <span class="ot">=</span> <span class="st">seq(1,epoch)</span></span>
<span id="cb71-111"><a href="#cb71-111"></a><span class="ot">  dat_unit</span> <span class="ot">=</span> <span class="st">numeric()</span></span>
<span id="cb71-112"><a href="#cb71-112"></a><span class="ot">  for</span><span class="er">(i</span> <span class="er">in</span> <span class="er">1:group){</span></span>
<span id="cb71-113"><a href="#cb71-113"></a><span class="ot">    for</span><span class="er">(j</span> <span class="er">in</span> <span class="er">1:epoch)</span> <span class="er">dat_unit[j]</span> <span class="ot">=</span> <span class="st">rnorm(1,para[1]*delta_t[j],sqrt(para[2]^2*delta_t[j]))</span></span>
<span id="cb71-114"><a href="#cb71-114"></a><span class="ot">    dat</span><span class="er">[,i+1]</span> <span class="ot">=</span> <span class="st">cumsum(dat_unit)</span></span>
<span id="cb71-115"><a href="#cb71-115"></a>  <span class="er">}</span></span>
<span id="cb71-116"><a href="#cb71-116"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">data.frame(dat)</span></span>
<span id="cb71-117"><a href="#cb71-117"></a><span class="ot">  dat1</span> <span class="ot">=</span> <span class="st">rbind(rep(0,group+1),dat)</span> <span class="er">#</span> <span class="er">加入初始值绘制点</span></span>
<span id="cb71-118"><a href="#cb71-118"></a><span class="ot">  colnames</span><span class="er">(dat1)</span> <span class="ot">=</span> <span class="st">c(</span><span class="er">"Time",paste(1:group,sep</span><span class="ot">=</span><span class="st">''</span><span class="er">))</span></span>
<span id="cb71-119"><a href="#cb71-119"></a><span class="ot">  return</span><span class="er">(dat1)</span></span>
<span id="cb71-120"><a href="#cb71-120"></a><span class="er">}</span></span>
<span id="cb71-121"><a href="#cb71-121"></a><span class="er">```</span></span>
<span id="cb71-122"><a href="#cb71-122"></a></span>
<span id="cb71-123"><a href="#cb71-123"></a><span class="er">绘制退化路径图</span></span>
<span id="cb71-124"><a href="#cb71-124"></a></span>
<span id="cb71-127"><a href="#cb71-127"></a><span class="in">```{r}</span></span>
<span id="cb71-128"><a href="#cb71-128"></a><span class="ot">#</span> <span class="er">绘制退化路径图</span></span>
<span id="cb71-129"><a href="#cb71-129"></a><span class="ot">plot_path</span> <span class="ot">=</span> <span class="st">function(data</span> <span class="ot">=</span> <span class="st">dat1){</span></span>
<span id="cb71-130"><a href="#cb71-130"></a><span class="ot">    #</span> <span class="er">画图</span></span>
<span id="cb71-131"><a href="#cb71-131"></a><span class="ot">  p</span> <span class="ot">=</span> <span class="st">data</span> <span class="er">%</span><span class="kw">&gt;</span>% pivot_longer(paste(1:group), </span>
<span id="cb71-132"><a href="#cb71-132"></a>                       names_to = "Group", </span>
<span id="cb71-133"><a href="#cb71-133"></a>                       values_to = "y") %&gt;% </span>
<span id="cb71-134"><a href="#cb71-134"></a>    ggplot(aes(Time,y,color = Group)) + </span>
<span id="cb71-135"><a href="#cb71-135"></a>    geom_line() + </span>
<span id="cb71-136"><a href="#cb71-136"></a>    scale_color_viridis(discrete = T) + </span>
<span id="cb71-137"><a href="#cb71-137"></a>    ylab("Degradation") #+</span>
<span id="cb71-138"><a href="#cb71-138"></a>    #theme_bw() +</span>
<span id="cb71-139"><a href="#cb71-139"></a>    #theme(panel.grid = element_blank())</span>
<span id="cb71-140"><a href="#cb71-140"></a>  print(p)</span>
<span id="cb71-141"><a href="#cb71-141"></a>}</span>
<span id="cb71-142"><a href="#cb71-142"></a><span class="in">```</span></span>
<span id="cb71-143"><a href="#cb71-143"></a></span>
<span id="cb71-146"><a href="#cb71-146"></a><span class="in">```{r}</span></span>
<span id="cb71-147"><a href="#cb71-147"></a><span class="in">group = 6</span></span>
<span id="cb71-148"><a href="#cb71-148"></a><span class="in">t = 1:200</span></span>
<span id="cb71-149"><a href="#cb71-149"></a><span class="in">para = c(1,1)</span></span>
<span id="cb71-150"><a href="#cb71-150"></a><span class="in">dat = sim_dat(group = group, t = t, para = para)</span></span>
<span id="cb71-151"><a href="#cb71-151"></a><span class="in">knitr::kable(head(dat))</span></span>
<span id="cb71-152"><a href="#cb71-152"></a><span class="in">plot_path(dat)</span></span>
<span id="cb71-153"><a href="#cb71-153"></a><span class="in">```</span></span>
<span id="cb71-154"><a href="#cb71-154"></a></span>
<span id="cb71-155"><a href="#cb71-155"></a><span class="fu">#### 3.1.2 统计推断</span></span>
<span id="cb71-156"><a href="#cb71-156"></a></span>
<span id="cb71-157"><a href="#cb71-157"></a>假设共有 $n$ 个样品进行性能退化试验。样品 $i$ 初始时刻 $t_{i 0}$ 退化量取值为 $X_{i 0}=0$, 在 时刻 $t_{i 1}, \cdots, t_{i m_i}$ 样品 $i$ 退化量为 $X_{i 1}, \cdots, X_{i m_i}$ 。记 $\Delta X_{i j}=X_{i j}-X_{i, j-1}$ 是样品 $i$ 在时刻 $t_{i, j-1} \sim t_{i j}$ 之间的退化增量, $\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n$ 为各样品的测量间隔。</span>
<span id="cb71-158"><a href="#cb71-158"></a></span>
<span id="cb71-159"><a href="#cb71-159"></a><span class="fu">##### 3.1.2.1 极大似然估计</span></span>
<span id="cb71-160"><a href="#cb71-160"></a></span>
<span id="cb71-161"><a href="#cb71-161"></a>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 $$</span>
<span id="cb71-162"><a href="#cb71-162"></a>\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)</span>
<span id="cb71-163"><a href="#cb71-163"></a>$$</span>
<span id="cb71-164"><a href="#cb71-164"></a></span>
<span id="cb71-165"><a href="#cb71-165"></a>于是由退化数据 $X_{i j}=x_{i j}$ (等价的, $\Delta X_{i j}=\Delta x_{i j}$ ) $, j=1,2, \cdots, m_i, i=1,2, \cdots, n$, 得到模型参数的似然函数为 $$</span>
<span id="cb71-166"><a href="#cb71-166"></a>L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left<span class="co">[</span><span class="ot">-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb71-167"><a href="#cb71-167"></a>$$ 由式可以直接求得漂移参数 $\mu$ 和扩散参数 $\sigma^2$ 的极大似然估计如下: $$</span>
<span id="cb71-168"><a href="#cb71-168"></a>\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left<span class="co">[</span><span class="ot">\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right</span><span class="co">]</span></span>
<span id="cb71-169"><a href="#cb71-169"></a>$$</span>
<span id="cb71-170"><a href="#cb71-170"></a></span>
<span id="cb71-173"><a href="#cb71-173"></a><span class="in">```{r}</span></span>
<span id="cb71-174"><a href="#cb71-174"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb71-175"><a href="#cb71-175"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb71-176"><a href="#cb71-176"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb71-177"><a href="#cb71-177"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb71-178"><a href="#cb71-178"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb71-179"><a href="#cb71-179"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb71-180"><a href="#cb71-180"></a>  }</span>
<span id="cb71-181"><a href="#cb71-181"></a>  <span class="fu">return</span>(re)</span>
<span id="cb71-182"><a href="#cb71-182"></a>}</span>
<span id="cb71-183"><a href="#cb71-183"></a><span class="in">```</span></span>
<span id="cb71-184"><a href="#cb71-184"></a></span>
<span id="cb71-187"><a href="#cb71-187"></a><span class="in">```{r}</span></span>
<span id="cb71-188"><a href="#cb71-188"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb71-189"><a href="#cb71-189"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb71-190"><a href="#cb71-190"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb71-191"><a href="#cb71-191"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb71-192"><a href="#cb71-192"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-193"><a href="#cb71-193"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb71-194"><a href="#cb71-194"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb71-195"><a href="#cb71-195"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb71-196"><a href="#cb71-196"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb71-197"><a href="#cb71-197"></a></span>
<span id="cb71-198"><a href="#cb71-198"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb71-199"><a href="#cb71-199"></a></span>
<span id="cb71-200"><a href="#cb71-200"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb71-201"><a href="#cb71-201"></a>}</span>
<span id="cb71-202"><a href="#cb71-202"></a></span>
<span id="cb71-203"><a href="#cb71-203"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb71-204"><a href="#cb71-204"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-205"><a href="#cb71-205"></a><span class="co"># mle_re</span></span>
<span id="cb71-206"><a href="#cb71-206"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb71-207"><a href="#cb71-207"></a><span class="co"># 区间估计</span></span>
<span id="cb71-208"><a href="#cb71-208"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb71-209"><a href="#cb71-209"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb71-210"><a href="#cb71-210"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb71-211"><a href="#cb71-211"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb71-212"><a href="#cb71-212"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span>
<span id="cb71-213"><a href="#cb71-213"></a><span class="in">```</span></span>
<span id="cb71-214"><a href="#cb71-214"></a></span>
<span id="cb71-215"><a href="#cb71-215"></a>为了得到产品可靠度的估计, 只要将 $\hat{\mu} 、 \hat{\sigma}^2$ 代人任务时间 $t$ 的可靠度的表达式, 即 可得到可靠度的点估计为 $$</span>
<span id="cb71-216"><a href="#cb71-216"></a>R(t)=1-F(t ; \hat{\mu}, \hat{\sigma})=\Phi\left(\frac{l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)-\exp \left(\frac{2 \hat{\mu} l}{\hat{\sigma}^2}\right) \Phi\left(\frac{-l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)</span>
<span id="cb71-217"><a href="#cb71-217"></a>$$</span>
<span id="cb71-218"><a href="#cb71-218"></a></span>
<span id="cb71-219"><a href="#cb71-219"></a><span class="in">```{r,collapse=TRUE}</span></span>
<span id="cb71-220"><a href="#cb71-220"></a><span class="do">## 可靠度计算</span></span>
<span id="cb71-221"><a href="#cb71-221"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb71-222"><a href="#cb71-222"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb71-223"><a href="#cb71-223"></a>  <span class="fu">return</span>(R)</span>
<span id="cb71-224"><a href="#cb71-224"></a>}</span>
<span id="cb71-225"><a href="#cb71-225"></a></span>
<span id="cb71-226"><a href="#cb71-226"></a><span class="in">```</span></span>
<span id="cb71-227"><a href="#cb71-227"></a></span>
<span id="cb71-228"><a href="#cb71-228"></a>给个简单例子</span>
<span id="cb71-229"><a href="#cb71-229"></a></span>
<span id="cb71-232"><a href="#cb71-232"></a><span class="in">```{r}</span></span>
<span id="cb71-233"><a href="#cb71-233"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb71-234"><a href="#cb71-234"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb71-235"><a href="#cb71-235"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb71-236"><a href="#cb71-236"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb71-237"><a href="#cb71-237"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb71-238"><a href="#cb71-238"></a></span>
<span id="cb71-239"><a href="#cb71-239"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb71-240"><a href="#cb71-240"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb71-241"><a href="#cb71-241"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-242"><a href="#cb71-242"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb71-243"><a href="#cb71-243"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-244"><a href="#cb71-244"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span>
<span id="cb71-245"><a href="#cb71-245"></a><span class="in">```</span></span>
<span id="cb71-246"><a href="#cb71-246"></a></span>
<span id="cb71-247"><a href="#cb71-247"></a><span class="fu">##### 3.1.2.2 贝叶斯分析</span></span>
<span id="cb71-248"><a href="#cb71-248"></a></span>
<span id="cb71-249"><a href="#cb71-249"></a>基于 rstan 进行贝叶斯估计。详细的参考文献如下：</span>
<span id="cb71-250"><a href="#cb71-250"></a></span>
<span id="cb71-251"><a href="#cb71-251"></a><span class="ss">-   </span>最新、入门级别 <span class="co">[</span><span class="ot">rstan</span><span class="co">](https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html)</span> 资料。</span>
<span id="cb71-252"><a href="#cb71-252"></a></span>
<span id="cb71-253"><a href="#cb71-253"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">官网资料</span><span class="co">](https://mc-stan.org/users/interfaces/rstan)</span></span>
<span id="cb71-254"><a href="#cb71-254"></a></span>
<span id="cb71-255"><a href="#cb71-255"></a>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</span>
<span id="cb71-256"><a href="#cb71-256"></a></span>
<span id="cb71-257"><a href="#cb71-257"></a>$$</span>
<span id="cb71-258"><a href="#cb71-258"></a>\begin{aligned}</span>
<span id="cb71-259"><a href="#cb71-259"></a>&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),<span class="sc">\\</span></span>
<span id="cb71-260"><a href="#cb71-260"></a>&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),<span class="sc">\\</span></span>
<span id="cb71-261"><a href="#cb71-261"></a>&amp; \mu|w \sim N(d,\frac{c}{w}).</span>
<span id="cb71-262"><a href="#cb71-262"></a>\end{aligned}</span>
<span id="cb71-263"><a href="#cb71-263"></a>$$</span>
<span id="cb71-264"><a href="#cb71-264"></a></span>
<span id="cb71-265"><a href="#cb71-265"></a>其中，$a = b = 1, d = 0, c =100$。</span>
<span id="cb71-266"><a href="#cb71-266"></a></span>
<span id="cb71-267"><a href="#cb71-267"></a>构建模型（<span class="in">`wiener_linear.stan`</span>）</span>
<span id="cb71-268"><a href="#cb71-268"></a></span>
<span id="cb71-269"><a href="#cb71-269"></a><span class="in">``` markdown</span></span>
<span id="cb71-270"><a href="#cb71-270"></a>data {</span>
<span id="cb71-271"><a href="#cb71-271"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb71-272"><a href="#cb71-272"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb71-273"><a href="#cb71-273"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb71-274"><a href="#cb71-274"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb71-275"><a href="#cb71-275"></a>}</span>
<span id="cb71-276"><a href="#cb71-276"></a></span>
<span id="cb71-277"><a href="#cb71-277"></a>parameters {</span>
<span id="cb71-278"><a href="#cb71-278"></a>  real mu;</span>
<span id="cb71-279"><a href="#cb71-279"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb71-280"><a href="#cb71-280"></a>}</span>
<span id="cb71-281"><a href="#cb71-281"></a></span>
<span id="cb71-282"><a href="#cb71-282"></a>model {</span>
<span id="cb71-283"><a href="#cb71-283"></a>  w ~ gamma(1,1);</span>
<span id="cb71-284"><a href="#cb71-284"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb71-285"><a href="#cb71-285"></a>  for (i in 1:I){</span>
<span id="cb71-286"><a href="#cb71-286"></a>    for (j in 1:J) {</span>
<span id="cb71-287"><a href="#cb71-287"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb71-288"><a href="#cb71-288"></a>    }</span>
<span id="cb71-289"><a href="#cb71-289"></a>  }</span>
<span id="cb71-290"><a href="#cb71-290"></a>}</span>
<span id="cb71-291"><a href="#cb71-291"></a><span class="in">```</span></span>
<span id="cb71-292"><a href="#cb71-292"></a></span>
<span id="cb71-293"><a href="#cb71-293"></a><span class="at">&gt; 存在问题：这里的normal中，sigma是标准差还是方差？</span></span>
<span id="cb71-294"><a href="#cb71-294"></a></span>
<span id="cb71-295"><a href="#cb71-295"></a><span class="ss">-   </span>数据准备</span>
<span id="cb71-296"><a href="#cb71-296"></a></span>
<span id="cb71-297"><a href="#cb71-297"></a>准备$\Delta t_{ij}$ 和 $\Delta x_{ij}$的数据，并且标志出矩阵的维数。</span>
<span id="cb71-298"><a href="#cb71-298"></a></span>
<span id="cb71-301"><a href="#cb71-301"></a><span class="in">```{r}</span></span>
<span id="cb71-302"><a href="#cb71-302"></a><span class="co"># 数据准备</span></span>
<span id="cb71-303"><a href="#cb71-303"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-304"><a href="#cb71-304"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb71-305"><a href="#cb71-305"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb71-306"><a href="#cb71-306"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb71-307"><a href="#cb71-307"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb71-308"><a href="#cb71-308"></a><span class="fu">dim</span>(delta_y)</span>
<span id="cb71-309"><a href="#cb71-309"></a></span>
<span id="cb71-310"><a href="#cb71-310"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb71-311"><a href="#cb71-311"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb71-312"><a href="#cb71-312"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb71-313"><a href="#cb71-313"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb71-314"><a href="#cb71-314"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb71-315"><a href="#cb71-315"></a>)</span>
<span id="cb71-316"><a href="#cb71-316"></a><span class="fu">dim</span>(delta_y)</span>
<span id="cb71-317"><a href="#cb71-317"></a><span class="in">```</span></span>
<span id="cb71-318"><a href="#cb71-318"></a></span>
<span id="cb71-321"><a href="#cb71-321"></a><span class="in">```{r}</span></span>
<span id="cb71-322"><a href="#cb71-322"></a><span class="co">#| warning: false</span></span>
<span id="cb71-323"><a href="#cb71-323"></a><span class="co">#| message: false</span></span>
<span id="cb71-324"><a href="#cb71-324"></a><span class="co"># 后验抽样</span></span>
<span id="cb71-325"><a href="#cb71-325"></a><span class="fu">library</span>(rstan)</span>
<span id="cb71-326"><a href="#cb71-326"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb71-327"><a href="#cb71-327"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-328"><a href="#cb71-328"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb71-329"><a href="#cb71-329"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb71-330"><a href="#cb71-330"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb71-331"><a href="#cb71-331"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb71-332"><a href="#cb71-332"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb71-333"><a href="#cb71-333"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb71-334"><a href="#cb71-334"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb71-335"><a href="#cb71-335"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb71-336"><a href="#cb71-336"></a>)</span>
<span id="cb71-337"><a href="#cb71-337"></a><span class="in">```</span></span>
<span id="cb71-338"><a href="#cb71-338"></a></span>
<span id="cb71-339"><a href="#cb71-339"></a>输出各个参数的后验估计结果并进行绘制。</span>
<span id="cb71-340"><a href="#cb71-340"></a></span>
<span id="cb71-343"><a href="#cb71-343"></a><span class="in">```{r}</span></span>
<span id="cb71-344"><a href="#cb71-344"></a><span class="fu">print</span>(fit1,</span>
<span id="cb71-345"><a href="#cb71-345"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span>
<span id="cb71-346"><a href="#cb71-346"></a></span>
<span id="cb71-347"><a href="#cb71-347"></a><span class="fu">plot</span>(fit1)</span>
<span id="cb71-348"><a href="#cb71-348"></a></span>
<span id="cb71-349"><a href="#cb71-349"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb71-350"><a href="#cb71-350"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb71-351"><a href="#cb71-351"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb71-352"><a href="#cb71-352"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb71-353"><a href="#cb71-353"></a><span class="in">```</span></span>
<span id="cb71-354"><a href="#cb71-354"></a></span>
<span id="cb71-355"><a href="#cb71-355"></a>可以看出，效果较好。真实值为：$\mu = 2,w = 1 / \sigma^2 = 0.25$，估计值为：$\mu = 2,w = 1 / \sigma^2 = 0.5$。 估计值的$\sigma^2$ 有些问题，应该如何处理？</span>
<span id="cb71-356"><a href="#cb71-356"></a></span>
<span id="cb71-357"><a href="#cb71-357"></a><span class="fu">##### 3.1.2.3 客观贝叶斯分析</span></span>
<span id="cb71-358"><a href="#cb71-358"></a></span>
<span id="cb71-359"><a href="#cb71-359"></a>暂时还未找到，最经典的维纳过程客观贝叶斯分析。</span>
<span id="cb71-360"><a href="#cb71-360"></a></span>
<span id="cb71-361"><a href="#cb71-361"></a><span class="ss">-   </span>维纳（线性） + 随机效应：</span>
<span id="cb71-362"><a href="#cb71-362"></a></span>
<span id="cb71-363"><a href="#cb71-363"></a><span class="fu">##### 3.1.2.4 广义推断方法</span></span>
<span id="cb71-364"><a href="#cb71-364"></a></span>
<span id="cb71-365"><a href="#cb71-365"></a>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</span>
<span id="cb71-366"><a href="#cb71-366"></a></span>
<span id="cb71-367"><a href="#cb71-367"></a><span class="ss">-   </span>维纳（线性） + 随机效应：</span>
<span id="cb71-368"><a href="#cb71-368"></a></span>
<span id="cb71-369"><a href="#cb71-369"></a>Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety 193.</span>
<span id="cb71-370"><a href="#cb71-370"></a></span>
<span id="cb71-371"><a href="#cb71-371"></a><span class="ss">-   </span>维纳（线性）+ 加速寿命试验 + 随机效应：</span>
<span id="cb71-372"><a href="#cb71-372"></a></span>
<span id="cb71-373"><a href="#cb71-373"></a>Wang, X. F., et al. (2020). "Reliability analysis for accelerated degradation data based on the Wiener process with random effects." Quality and Reliability Engineering International 36(6): 1969-1981.</span>
<span id="cb71-374"><a href="#cb71-374"></a></span>
<span id="cb71-375"><a href="#cb71-375"></a>Hong, L., et al. (2018). "Interval estimation for Wiener processes based on accelerated degradation test data." IISE Transactions 50(12): 1043-1057.</span>
<span id="cb71-376"><a href="#cb71-376"></a></span>
<span id="cb71-377"><a href="#cb71-377"></a><span class="ss">-   </span>伽马 + 随机过程</span>
<span id="cb71-378"><a href="#cb71-378"></a></span>
<span id="cb71-379"><a href="#cb71-379"></a>Wang, X. F., et al. (2021). "Degradation data analysis based on gamma process with random effects." European Journal of Operational Research 292(3): 1200-1208.</span>
<span id="cb71-380"><a href="#cb71-380"></a></span>
<span id="cb71-381"><a href="#cb71-381"></a><span class="ss">-   </span>伽马 + 加速寿命试验</span>
<span id="cb71-382"><a href="#cb71-382"></a></span>
<span id="cb71-383"><a href="#cb71-383"></a>Jiang, P. H., et al. (2019). "Inference for constant-stress accelerated degradation test based on Gamma process." Applied Mathematical Modelling 67: 123-134.</span>
<span id="cb71-384"><a href="#cb71-384"></a></span>
<span id="cb71-385"><a href="#cb71-385"></a><span class="fu">### 3.2 多应力和动态环境情形</span></span>
<span id="cb71-386"><a href="#cb71-386"></a></span>
<span id="cb71-387"><a href="#cb71-387"></a>**1. 多应力情形**</span>
<span id="cb71-388"><a href="#cb71-388"></a></span>
<span id="cb71-389"><a href="#cb71-389"></a>某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。</span>
<span id="cb71-390"><a href="#cb71-390"></a></span>
<span id="cb71-391"><a href="#cb71-391"></a>假设在不同应力下, 一元 Wiener 过程模型的参数是应力 $S$ 的函数 $$</span>
<span id="cb71-392"><a href="#cb71-392"></a>\mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right)</span>
<span id="cb71-393"><a href="#cb71-393"></a>$$ 式中: $\theta_\mu 、 \theta_\sigma$ 是末知参数向量。</span>
<span id="cb71-394"><a href="#cb71-394"></a></span>
<span id="cb71-395"><a href="#cb71-395"></a>对不同类型应力, $\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)$ 的形式和参数不同。比如对漂移参数 $\mu$, 应力 为温度时通常采用阿伦尼斯模型进行描述 $$</span>
<span id="cb71-396"><a href="#cb71-396"></a>\mu(S)=a \mathrm{e}^{-b / S}</span>
<span id="cb71-397"><a href="#cb71-397"></a>$$</span>
<span id="cb71-398"><a href="#cb71-398"></a></span>
<span id="cb71-399"><a href="#cb71-399"></a>如果应力是电压、功率等, 则通常采用幂律模型 $$</span>
<span id="cb71-400"><a href="#cb71-400"></a>\mu(S)=a S^b</span>
<span id="cb71-401"><a href="#cb71-401"></a>$$</span>
<span id="cb71-402"><a href="#cb71-402"></a></span>
<span id="cb71-403"><a href="#cb71-403"></a>根据加速退化试验中应力的变化情况,加速退化试验又分别为**恒定应力加速退化试验**、**步进应力加速退化试验**和**序进应力加速退化试验**。</span>
<span id="cb71-404"><a href="#cb71-404"></a></span>
<span id="cb71-405"><a href="#cb71-405"></a>恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。</span>
<span id="cb71-406"><a href="#cb71-406"></a></span>
<span id="cb71-407"><a href="#cb71-407"></a>设产品在 $S_0, S_1, \cdots, S_s$ 共 $s+1$ 个应力下进行退化试验, 其中应力 $S_0$ 为正常工作应 力。应力 $S_i$ 下共得到 $n_i$ 个产品的性能退化数据, 其中对产品 $j$, 初始时刻 $t_{i j 0}$ 的退化量 为 $X_{i j 0}=0$, 分别在时刻 $t_{i j 1}, \cdots, t_{i j m_{i j}}$ 测量其性能退化量 $X_{i j 1}, \cdots, X_{i j m_{i j}}$, 其中 $i=0,1, \cdots, s, j=$ $1,2, \cdots, n_i$ 记 $\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}$, 其中 $k=1,2, \cdots, m_{i j}$ 。由各应力下 的退化数据 $\left<span class="sc">\{</span>\Delta x_{i j k}\right<span class="sc">\}</span>$ 得到模型参数的似然函数为 $$</span>
<span id="cb71-408"><a href="#cb71-408"></a>L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k}}} \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right]</span>
<span id="cb71-409"><a href="#cb71-409"></a>$$</span>
<span id="cb71-410"><a href="#cb71-410"></a></span>
<span id="cb71-411"><a href="#cb71-411"></a>则参数 $\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma$ 的极大似然估计 $\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma$ 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 $S_0$ 下参数 $\mu 、 \sigma^2$ 为 $$</span>
<span id="cb71-412"><a href="#cb71-412"></a>\mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right)</span>
<span id="cb71-413"><a href="#cb71-413"></a>$$ 产品可靠度点估计可由式 (3.42)得到。</span>
<span id="cb71-414"><a href="#cb71-414"></a></span>
<span id="cb71-415"><a href="#cb71-415"></a>**2. 动态环境情形**</span>
<span id="cb71-416"><a href="#cb71-416"></a></span>
<span id="cb71-417"><a href="#cb71-417"></a>与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 $<span class="sc">\{</span>S$ $(t), t \geqslant 0<span class="sc">\}</span>$, 并且假设应力对退化速率的影响函数为 $\beta_0 \cdot h(S(t) ; b)$, 其中 $\beta_0$ 是基准应 力下的退化速率, 以 $b$ 为参数的函数 $h(S(t) ; b)$ 表示应力的影响, $b$ 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 $t$ 产品退化量取值为 $$</span>
<span id="cb71-418"><a href="#cb71-418"></a>X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t)</span>
<span id="cb71-419"><a href="#cb71-419"></a>$$ 式中: $<span class="sc">\{</span>S(\tau), 0 \leqslant \tau \leqslant t<span class="sc">\}</span>$ 为 $<span class="co">[</span><span class="ot">0, \tau</span><span class="co">]</span>$ 内的应力; $<span class="sc">\{</span>B(t), t \geqslant 0<span class="sc">\}</span>$ 为标准 Wiener 过程; 模型待估 参数为 $$</span>
<span id="cb71-420"><a href="#cb71-420"></a>\boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right)</span>
<span id="cb71-421"><a href="#cb71-421"></a>$$</span>
<span id="cb71-422"><a href="#cb71-422"></a></span>
<span id="cb71-423"><a href="#cb71-423"></a>设有 $n$ 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 $i$, 设 时刻 $t_{i k}$ 观测到的退化量为 $X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)$; 对环境进行连续观测, 时刻 $j$ 观测到应力取值为 $S_{i j}, j=1,2, \cdots$ 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 $t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots$ 。下面基于动态环境下的退化试验数据, 给出 模型参数的**极大似然估计**方法。</span>
<span id="cb71-424"><a href="#cb71-424"></a></span>
<span id="cb71-425"><a href="#cb71-425"></a>根据模型式 $(3.51)$, 记 $\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)$, 对产品 $i$ 以及时刻 $t_{i k}$ 近似的有 $$</span>
<span id="cb71-426"><a href="#cb71-426"></a>X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right)</span>
<span id="cb71-427"><a href="#cb71-427"></a>$$ 且有 $$</span>
<span id="cb71-428"><a href="#cb71-428"></a>\begin{gathered}</span>
<span id="cb71-429"><a href="#cb71-429"></a>E\left<span class="co">[</span><span class="ot">X_i\left(t_{i k}\right)\right</span><span class="co">]</span>=\beta_0 \nu_{i k} <span class="sc">\\</span></span>
<span id="cb71-430"><a href="#cb71-430"></a>\operatorname{Cov}\left<span class="co">[</span><span class="ot">X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right</span><span class="co">]</span>=\sigma_B^2 \cdot \min \left<span class="sc">\{</span>t_{i k_1}, t_{i k_2}\right<span class="sc">\}</span></span>
<span id="cb71-431"><a href="#cb71-431"></a>\end{gathered}</span>
<span id="cb71-432"><a href="#cb71-432"></a>$$ 如果考虑退化增量 $\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)$, 其中 $$</span>
<span id="cb71-433"><a href="#cb71-433"></a>Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m</span>
<span id="cb71-434"><a href="#cb71-434"></a>$$ 记 $\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}$ 。容易知道 $\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)$, 其中 $$</span>
<span id="cb71-435"><a href="#cb71-435"></a>\mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right)</span>
<span id="cb71-436"><a href="#cb71-436"></a>$$</span>
<span id="cb71-437"><a href="#cb71-437"></a></span>
<span id="cb71-438"><a href="#cb71-438"></a>其中 $$</span>
<span id="cb71-439"><a href="#cb71-439"></a>\Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}}</span>
<span id="cb71-440"><a href="#cb71-440"></a>$$ 设退化试验数据为 $\boldsymbol{y}_i, i=1,2, \cdots, n$, 则似然函数为 $$</span>
<span id="cb71-441"><a href="#cb71-441"></a>L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left<span class="sc">\{</span>-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right<span class="sc">\}</span></span>
<span id="cb71-442"><a href="#cb71-442"></a>$$ 对数似然函数为 $$</span>
<span id="cb71-443"><a href="#cb71-443"></a>l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb71-444"><a href="#cb71-444"></a>$$ 取对数似然函数关 $\sigma_B$ 和 $\beta_0$ 的一阶偏导数,得到 $$</span>
<span id="cb71-445"><a href="#cb71-445"></a>\frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb71-446"><a href="#cb71-446"></a>$$ 与 $$</span>
<span id="cb71-447"><a href="#cb71-447"></a>\frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}}</span>
<span id="cb71-448"><a href="#cb71-448"></a>$$ 这样, 对特定的 $\sigma_B$ 和 $\beta_0$, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: $$</span>
<span id="cb71-449"><a href="#cb71-449"></a>l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb71-450"><a href="#cb71-450"></a>$$ 通过搜索得到 $b$ 的极大似然估计 $\hat{b}$, 并将其代人式 (3.52) 或式 (3.53), 就得到 $\sigma_B$ 和 $\beta_0$ 的极大似然估计。</span>
<span id="cb71-451"><a href="#cb71-451"></a></span>
<span id="cb71-452"><a href="#cb71-452"></a><span class="fu">### 3.3 含随机效应情形</span></span>
<span id="cb71-453"><a href="#cb71-453"></a></span>
<span id="cb71-454"><a href="#cb71-454"></a><span class="fu">#### 3.3.1 二阶段的极大似然方法</span></span>
<span id="cb71-455"><a href="#cb71-455"></a></span>
<span id="cb71-456"><a href="#cb71-456"></a>考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 $n$ 个样品的退化 试验数据对随机效应的分布参数 $\nu 、 \eta 、 \alpha 、 \beta$ 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。</span>
<span id="cb71-457"><a href="#cb71-457"></a></span>
<span id="cb71-458"><a href="#cb71-458"></a>对产品 $i$, 分别在时刻 $t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}$ 对其进行 $m_i+1$ 次测量, $i=1,2, \cdots, n$, 得 到的测量数据为 $x_{i j}$ 。记 $\Delta x_{i j}=x_{i j}-x_{i, j-1}$, 即 $\Delta x_{i j}$ 为产品 $i$ 在 $t_{i j-1}$ 到 $t_{i j}$ 之间的退化量增量, 由式 (3.41), 给定试验数据 $\Delta x_{i j}$ 的情况下, 样品 $i$ 的退化过程模型参数 $\mu_i, \sigma_i^2$ 的极大似然估计为 $$</span>
<span id="cb71-459"><a href="#cb71-459"></a>\hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right]</span>
<span id="cb71-460"><a href="#cb71-460"></a>$$ 式中 : $\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i$ 。</span>
<span id="cb71-461"><a href="#cb71-461"></a></span>
<span id="cb71-462"><a href="#cb71-462"></a>由式 (3.56) 得到各产品的退化过程参数的估计 $\hat{\mu}_i 、 \hat{\sigma}_i^2$ 后, 可以拟合得到 $\mu$ 和 $D$ 的 分布参数。令 $\hat{D}_i=\hat{\sigma}_i^2$, 由于 $D^{-1}$ 服从参数为 $(\alpha, \beta)$ 的 $\mathrm{Gamma}$ 分布, 则根据极大似然估 计, $D$ 的分布参数 $\alpha \sqrt{ } \beta$ 可以通过求解下面的方程组得到: $$</span>
<span id="cb71-463"><a href="#cb71-463"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-464"><a href="#cb71-464"></a>\ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) <span class="sc">\\</span></span>
<span id="cb71-465"><a href="#cb71-465"></a>\alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}}</span>
<span id="cb71-466"><a href="#cb71-466"></a>\end{array}\right.</span>
<span id="cb71-467"><a href="#cb71-467"></a>$$ 式中: $\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)$ 为 Digamma 函数, 文献 $<span class="co">[</span><span class="ot">47</span><span class="co">]</span>$ 给出了其准确计算方法。</span>
<span id="cb71-468"><a href="#cb71-468"></a></span>
<span id="cb71-469"><a href="#cb71-469"></a>由于 $\mu \sim N(\nu, \eta D)$, 对单元 $i$, 近似认为参数 $\nu 、 \eta$ 的似然函数为 $$</span>
<span id="cb71-470"><a href="#cb71-470"></a>l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right)</span>
<span id="cb71-471"><a href="#cb71-471"></a>$$ 于是总的似然函数为 $$</span>
<span id="cb71-472"><a href="#cb71-472"></a>l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)</span>
<span id="cb71-473"><a href="#cb71-473"></a>$$ 由极大似然方法得到 $$</span>
<span id="cb71-474"><a href="#cb71-474"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-475"><a href="#cb71-475"></a>-\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 <span class="sc">\\</span></span>
<span id="cb71-476"><a href="#cb71-476"></a>-\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0</span>
<span id="cb71-477"><a href="#cb71-477"></a>\end{array}\right.</span>
<span id="cb71-478"><a href="#cb71-478"></a>$$ 解上面的方程组得到 $$</span>
<span id="cb71-479"><a href="#cb71-479"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-480"><a href="#cb71-480"></a>\hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} <span class="sc">\\</span></span>
<span id="cb71-481"><a href="#cb71-481"></a>\hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)</span>
<span id="cb71-482"><a href="#cb71-482"></a>\end{array}\right.</span>
<span id="cb71-483"><a href="#cb71-483"></a>$$</span>
<span id="cb71-484"><a href="#cb71-484"></a></span>
<span id="cb71-485"><a href="#cb71-485"></a><span class="fu">#### 3.3.2 客观贝叶斯方法</span></span>
<span id="cb71-486"><a href="#cb71-486"></a></span>
<span id="cb71-487"><a href="#cb71-487"></a><span class="fu">### 3.4 有测量误差情形</span></span>
<span id="cb71-488"><a href="#cb71-488"></a></span>
<span id="cb71-489"><a href="#cb71-489"></a>假设 $Y(t)$ 和 $X(t)$ 分别表示观测的退化过程和真实退化过程在时刻 $t, t \geqslant 0$ 的退化水平, $X(t)$ 和 $Y(t)$ 可用下面的模型描述: $$</span>
<span id="cb71-490"><a href="#cb71-490"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-491"><a href="#cb71-491"></a>X(t)=\beta \cdot t+\sigma_B \cdot B(t) <span class="sc">\\</span></span>
<span id="cb71-492"><a href="#cb71-492"></a>Y(t)=X(t)+\sigma_R \cdot \varepsilon(t)</span>
<span id="cb71-493"><a href="#cb71-493"></a>\end{array}\right.</span>
<span id="cb71-494"><a href="#cb71-494"></a>$$ 式中: $\beta$ 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 $\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)$ 是标准 Wiener 过程, $\sigma_B$ 为扩散参 数; $\varepsilon(t)$ 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。</span>
<span id="cb71-495"><a href="#cb71-495"></a></span>
<span id="cb71-496"><a href="#cb71-496"></a>因此, 式 (3.61) 模型共有 4 个待估参数, 即 $$</span>
<span id="cb71-497"><a href="#cb71-497"></a>\boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}}</span>
<span id="cb71-498"><a href="#cb71-498"></a>$$</span>
<span id="cb71-499"><a href="#cb71-499"></a></span>
<span id="cb71-500"><a href="#cb71-500"></a>假设对 $n$ 个产品进行退化试验。对单元 $i(i=1, \cdots, n)$ 进行 $m_i$ 次测量, 时刻 $t_{i j}$ 的测量值为 $$</span>
<span id="cb71-501"><a href="#cb71-501"></a>Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i</span>
<span id="cb71-502"><a href="#cb71-502"></a>$$ 式中 : $\beta_i$ 是单元 $i$ 的平均退化速率, 对单元 $i$ 的所有测量是恒定不变的。</span>
<span id="cb71-503"><a href="#cb71-503"></a></span>
<span id="cb71-504"><a href="#cb71-504"></a>定义时间间隔 $\Delta t_{i j}=t_{i j}-t_{i j-1}$, 观测的退化增量为 $\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1$, $2, \cdots, m_i$; 根据 Wiener 过程定义, $t_{i 0}=0, Y_i\left(t_{i 0}\right)=0$ 。为叙述方便, 令 $$</span>
<span id="cb71-505"><a href="#cb71-505"></a>\Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}}</span>
<span id="cb71-506"><a href="#cb71-506"></a>$$</span>
<span id="cb71-507"><a href="#cb71-507"></a></span>
<span id="cb71-508"><a href="#cb71-508"></a>根据 Wiener 过程的独立增量性质, 得到 $$</span>
<span id="cb71-509"><a href="#cb71-509"></a>\begin{gathered}</span>
<span id="cb71-510"><a href="#cb71-510"></a>E\left<span class="co">[</span><span class="ot">\Delta \boldsymbol{Y}_i\right</span><span class="co">]</span>=\mu_\beta \Delta \boldsymbol{t}_i <span class="sc">\\</span></span>
<span id="cb71-511"><a href="#cb71-511"></a>\operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i <span class="sc">\\</span></span>
<span id="cb71-512"><a href="#cb71-512"></a>\end{gathered}</span>
<span id="cb71-513"><a href="#cb71-513"></a>$$ 其中， $$</span>
<span id="cb71-514"><a href="#cb71-514"></a>\boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc}</span>
<span id="cb71-515"><a href="#cb71-515"></a>2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb71-516"><a href="#cb71-516"></a>-1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb71-517"><a href="#cb71-517"></a>0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb71-518"><a href="#cb71-518"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb71-519"><a href="#cb71-519"></a>0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2</span>
<span id="cb71-520"><a href="#cb71-520"></a>\end{array}\right]</span>
<span id="cb71-521"><a href="#cb71-521"></a>$$</span>
<span id="cb71-522"><a href="#cb71-522"></a></span>
<span id="cb71-523"><a href="#cb71-523"></a>设退化数据为 $\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n$, 则参数 $\boldsymbol{\theta}$ 的似然函数为 $$</span>
<span id="cb71-524"><a href="#cb71-524"></a>L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left<span class="sc">\{</span>-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right<span class="sc">\}</span></span>
<span id="cb71-525"><a href="#cb71-525"></a>$$ 令 $\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i$, 其中 $\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i$ 定义 $$</span>
<span id="cb71-526"><a href="#cb71-526"></a>\phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i</span>
<span id="cb71-527"><a href="#cb71-527"></a>$$ 取对数似然函数关于 $\mu_\beta$ 和 $\sigma_\beta^2$ 的一阶偏导数, 并利用下面的公式 $$</span>
<span id="cb71-528"><a href="#cb71-528"></a>\begin{aligned}</span>
<span id="cb71-529"><a href="#cb71-529"></a>\left|\boldsymbol{\Sigma}_i\right| &amp;=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.<span class="sc">\\</span></span>
<span id="cb71-530"><a href="#cb71-530"></a>\boldsymbol{\Sigma}_i^{-1} &amp;=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 })</span>
<span id="cb71-531"><a href="#cb71-531"></a>\end{aligned}</span>
<span id="cb71-532"><a href="#cb71-532"></a>$$</span>
<span id="cb71-533"><a href="#cb71-533"></a></span>
<span id="cb71-534"><a href="#cb71-534"></a>得到 $$</span>
<span id="cb71-535"><a href="#cb71-535"></a>\frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}</span>
<span id="cb71-536"><a href="#cb71-536"></a>$$ 和 $$</span>
<span id="cb71-537"><a href="#cb71-537"></a>\frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i}</span>
<span id="cb71-538"><a href="#cb71-538"></a>$$ 于是, 对特定的 $\left(\sigma_B, \sigma_R\right)$ 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的如下限制极大似然估计: $$</span>
<span id="cb71-539"><a href="#cb71-539"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-540"><a href="#cb71-540"></a>\hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} <span class="sc">\\</span></span>
<span id="cb71-541"><a href="#cb71-541"></a>\sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0</span>
<span id="cb71-542"><a href="#cb71-542"></a>\end{array}\right.</span>
<span id="cb71-543"><a href="#cb71-543"></a>$$ 将上式代人 $\theta$ 的对数似然函数,则得到如下的截面似然函数: $$</span>
<span id="cb71-544"><a href="#cb71-544"></a>\begin{aligned}</span>
<span id="cb71-545"><a href="#cb71-545"></a>l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) <span class="sc">\\</span></span>
<span id="cb71-546"><a href="#cb71-546"></a>&amp;-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) <span class="sc">\\</span></span>
<span id="cb71-547"><a href="#cb71-547"></a>&amp;+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i}</span>
<span id="cb71-548"><a href="#cb71-548"></a>\end{aligned}</span>
<span id="cb71-549"><a href="#cb71-549"></a>$$ 通过最大化上述截面似然函数, 得到 $\sigma_B$ 和 $\sigma_R$ 的极大似然估计 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$, 这可通过 2 维搜索算法实现。最后将 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$ 代人式 (3.64), 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的极大似然估计。</span>
<span id="cb71-550"><a href="#cb71-550"></a></span>
<span id="cb71-551"><a href="#cb71-551"></a>当所有观测时间相同时, 诸 $\rho_i$ 相同, 记为 $\rho$, 可以得到 $\hat{\mu}_\beta$ 和 $\hat{\sigma}_\beta^2$ 的解析形式, 即 $$</span>
<span id="cb71-552"><a href="#cb71-552"></a>\begin{gathered}</span>
<span id="cb71-553"><a href="#cb71-553"></a>\hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} <span class="sc">\\</span></span>
<span id="cb71-554"><a href="#cb71-554"></a>\hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho}</span>
<span id="cb71-555"><a href="#cb71-555"></a>\end{gathered}</span>
<span id="cb71-556"><a href="#cb71-556"></a>$$ 容易看出, $\hat{\mu}_{\beta, i}$ 实际上是单元 $i$ 的退化速率的加权最小二乘估计, $\hat{\sigma}_\beta^2$ 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: $$</span>
<span id="cb71-557"><a href="#cb71-557"></a>\begin{aligned}</span>
<span id="cb71-558"><a href="#cb71-558"></a>l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| <span class="sc">\\</span></span>
<span id="cb71-559"><a href="#cb71-559"></a>&amp;-\frac{1}{2}\left<span class="sc">\{</span>\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb71-560"><a href="#cb71-560"></a>&amp;-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right)</span>
<span id="cb71-561"><a href="#cb71-561"></a>\end{aligned}</span>
<span id="cb71-562"><a href="#cb71-562"></a>$$</span>
<span id="cb71-563"><a href="#cb71-563"></a></span>
<span id="cb71-564"><a href="#cb71-564"></a><span class="fu">### 3.3 案例分析</span></span>
<span id="cb71-565"><a href="#cb71-565"></a></span>
<span id="cb71-566"><a href="#cb71-566"></a><span class="fu">#### 3.3.1 NASA 锂电池数据</span></span>
<span id="cb71-567"><a href="#cb71-567"></a></span>
<span id="cb71-568"><a href="#cb71-568"></a><span class="at">&gt; 数据来源于</span><span class="co">[</span><span class="ot">NASA Ames Prognostics Center of Excellence (PCoE)</span><span class="co">](https://c3.ndc.nasa.gov/dashlink/resources/133/)</span><span class="at">，但是找不到数据下载。最后是通过 </span><span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/psanabriaUC/BatteryDatasetImplementation)</span><span class="at"> 获得。</span></span>
<span id="cb71-569"><a href="#cb71-569"></a></span>
<span id="cb71-570"><a href="#cb71-570"></a>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即**充电**、**放电**和**测量 EIS**。</span>
<span id="cb71-571"><a href="#cb71-571"></a></span>
<span id="cb71-572"><a href="#cb71-572"></a>充电是以**恒流模**式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以**恒压模式**(CV)继续充电直到电流降到 20mA。</span>
<span id="cb71-573"><a href="#cb71-573"></a></span>
<span id="cb71-574"><a href="#cb71-574"></a>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</span>
<span id="cb71-575"><a href="#cb71-575"></a></span>
<span id="cb71-576"><a href="#cb71-576"></a>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</span>
<span id="cb71-577"><a href="#cb71-577"></a></span>
<span id="cb71-580"><a href="#cb71-580"></a><span class="in">```{r}</span></span>
<span id="cb71-581"><a href="#cb71-581"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb71-582"><a href="#cb71-582"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span>
<span id="cb71-583"><a href="#cb71-583"></a><span class="in">```</span></span>
<span id="cb71-584"><a href="#cb71-584"></a></span>
<span id="cb71-587"><a href="#cb71-587"></a><span class="in">```{r}</span></span>
<span id="cb71-588"><a href="#cb71-588"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb71-589"><a href="#cb71-589"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb71-590"><a href="#cb71-590"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-591"><a href="#cb71-591"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-592"><a href="#cb71-592"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span>
<span id="cb71-593"><a href="#cb71-593"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb71-594"><a href="#cb71-594"></a><span class="in">```</span></span>
<span id="cb71-595"><a href="#cb71-595"></a></span>
<span id="cb71-596"><a href="#cb71-596"></a>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</span>
<span id="cb71-597"><a href="#cb71-597"></a></span>
<span id="cb71-600"><a href="#cb71-600"></a><span class="in">```{r}</span></span>
<span id="cb71-601"><a href="#cb71-601"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb71-602"><a href="#cb71-602"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb71-603"><a href="#cb71-603"></a></span>
<span id="cb71-604"><a href="#cb71-604"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb71-605"><a href="#cb71-605"></a></span>
<span id="cb71-606"><a href="#cb71-606"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb71-607"><a href="#cb71-607"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb71-608"><a href="#cb71-608"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-609"><a href="#cb71-609"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-610"><a href="#cb71-610"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb71-611"><a href="#cb71-611"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb71-612"><a href="#cb71-612"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb71-613"><a href="#cb71-613"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-614"><a href="#cb71-614"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-615"><a href="#cb71-615"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-616"><a href="#cb71-616"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span>
<span id="cb71-617"><a href="#cb71-617"></a><span class="in">```</span></span>
<span id="cb71-618"><a href="#cb71-618"></a></span>
<span id="cb71-619"><a href="#cb71-619"></a>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</span>
<span id="cb71-620"><a href="#cb71-620"></a></span>
<span id="cb71-623"><a href="#cb71-623"></a><span class="in">```{r}</span></span>
<span id="cb71-624"><a href="#cb71-624"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb71-625"><a href="#cb71-625"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb71-626"><a href="#cb71-626"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb71-627"><a href="#cb71-627"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb71-628"><a href="#cb71-628"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb71-629"><a href="#cb71-629"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span>
<span id="cb71-630"><a href="#cb71-630"></a><span class="in">```</span></span>
<span id="cb71-631"><a href="#cb71-631"></a></span>
<span id="cb71-634"><a href="#cb71-634"></a><span class="in">```{r}</span></span>
<span id="cb71-635"><a href="#cb71-635"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb71-636"><a href="#cb71-636"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-637"><a href="#cb71-637"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb71-638"><a href="#cb71-638"></a>mle_par</span>
<span id="cb71-639"><a href="#cb71-639"></a><span class="in">```</span></span>
<span id="cb71-640"><a href="#cb71-640"></a></span>
<span id="cb71-641"><a href="#cb71-641"></a>计算可靠度并绘图</span>
<span id="cb71-642"><a href="#cb71-642"></a></span>
<span id="cb71-645"><a href="#cb71-645"></a><span class="in">```{r}</span></span>
<span id="cb71-646"><a href="#cb71-646"></a><span class="co"># 计算可靠度</span></span>
<span id="cb71-647"><a href="#cb71-647"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span>
<span id="cb71-648"><a href="#cb71-648"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb71-649"><a href="#cb71-649"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb71-650"><a href="#cb71-650"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb71-651"><a href="#cb71-651"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb71-652"><a href="#cb71-652"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb71-653"><a href="#cb71-653"></a>}</span>
<span id="cb71-654"><a href="#cb71-654"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb71-655"><a href="#cb71-655"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb71-656"><a href="#cb71-656"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb71-657"><a href="#cb71-657"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb71-658"><a href="#cb71-658"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb71-659"><a href="#cb71-659"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-660"><a href="#cb71-660"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb71-661"><a href="#cb71-661"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-662"><a href="#cb71-662"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-663"><a href="#cb71-663"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span>
<span id="cb71-664"><a href="#cb71-664"></a><span class="in">```</span></span>
<span id="cb71-665"><a href="#cb71-665"></a></span>
<span id="cb71-666"><a href="#cb71-666"></a><span class="fu">#### 3.3.2 激光器件 Laser 数据集</span></span>
<span id="cb71-667"><a href="#cb71-667"></a></span>
<span id="cb71-668"><a href="#cb71-668"></a><span class="at">&gt; 数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</span></span>
<span id="cb71-669"><a href="#cb71-669"></a></span>
<span id="cb71-670"><a href="#cb71-670"></a>激光器件的质量特征是其**工作电流**。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</span>
<span id="cb71-671"><a href="#cb71-671"></a></span>
<span id="cb71-674"><a href="#cb71-674"></a><span class="in">```{r}</span></span>
<span id="cb71-675"><a href="#cb71-675"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb71-676"><a href="#cb71-676"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span>
<span id="cb71-677"><a href="#cb71-677"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span>
<span id="cb71-678"><a href="#cb71-678"></a><span class="in">```</span></span>
<span id="cb71-679"><a href="#cb71-679"></a></span>
<span id="cb71-682"><a href="#cb71-682"></a><span class="in">```{r}</span></span>
<span id="cb71-683"><a href="#cb71-683"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb71-684"><a href="#cb71-684"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-685"><a href="#cb71-685"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-686"><a href="#cb71-686"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-687"><a href="#cb71-687"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-688"><a href="#cb71-688"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb71-689"><a href="#cb71-689"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-690"><a href="#cb71-690"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb71-691"><a href="#cb71-691"></a><span class="in">```</span></span>
<span id="cb71-692"><a href="#cb71-692"></a></span>
<span id="cb71-695"><a href="#cb71-695"></a><span class="in">```{r}</span></span>
<span id="cb71-696"><a href="#cb71-696"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb71-697"><a href="#cb71-697"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb71-698"><a href="#cb71-698"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb71-699"><a href="#cb71-699"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span>
<span id="cb71-700"><a href="#cb71-700"></a><span class="in">```</span></span>
<span id="cb71-701"><a href="#cb71-701"></a></span>
<span id="cb71-704"><a href="#cb71-704"></a><span class="in">```{r}</span></span>
<span id="cb71-705"><a href="#cb71-705"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb71-706"><a href="#cb71-706"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-707"><a href="#cb71-707"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb71-708"><a href="#cb71-708"></a>mle_par</span>
<span id="cb71-709"><a href="#cb71-709"></a><span class="in">```</span></span>
<span id="cb71-710"><a href="#cb71-710"></a></span>
<span id="cb71-711"><a href="#cb71-711"></a>计算可靠度并绘图，阈值设置参考 Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety **193**. 第6节案例分析</span>
<span id="cb71-712"><a href="#cb71-712"></a></span>
<span id="cb71-713"><a href="#cb71-713"></a>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</span>
<span id="cb71-714"><a href="#cb71-714"></a></span>
<span id="cb71-715"><a href="#cb71-715"></a><span class="at">&gt; 可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</span></span>
<span id="cb71-716"><a href="#cb71-716"></a></span>
<span id="cb71-719"><a href="#cb71-719"></a><span class="in">```{r}</span></span>
<span id="cb71-720"><a href="#cb71-720"></a><span class="co"># 计算可靠度</span></span>
<span id="cb71-721"><a href="#cb71-721"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb71-722"><a href="#cb71-722"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb71-723"><a href="#cb71-723"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb71-724"><a href="#cb71-724"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb71-725"><a href="#cb71-725"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb71-726"><a href="#cb71-726"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb71-727"><a href="#cb71-727"></a>}</span>
<span id="cb71-728"><a href="#cb71-728"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb71-729"><a href="#cb71-729"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb71-730"><a href="#cb71-730"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb71-731"><a href="#cb71-731"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb71-732"><a href="#cb71-732"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb71-733"><a href="#cb71-733"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-734"><a href="#cb71-734"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb71-735"><a href="#cb71-735"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-736"><a href="#cb71-736"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb71-737"><a href="#cb71-737"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb71-738"><a href="#cb71-738"></a></span>
<span id="cb71-739"><a href="#cb71-739"></a><span class="in">```</span></span>
<span id="cb71-740"><a href="#cb71-740"></a></span>
<span id="cb71-741"><a href="#cb71-741"></a><span class="fu">#### 3.3.3 炭膜电阻器 carbon-film resistors</span></span>
<span id="cb71-742"><a href="#cb71-742"></a></span>
<span id="cb71-743"><a href="#cb71-743"></a><span class="at">&gt; 退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</span></span>
<span id="cb71-744"><a href="#cb71-744"></a></span>
<span id="cb71-745"><a href="#cb71-745"></a>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</span>
<span id="cb71-746"><a href="#cb71-746"></a></span>
<span id="cb71-747"><a href="#cb71-747"></a>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</span>
<span id="cb71-748"><a href="#cb71-748"></a></span>
<span id="cb71-751"><a href="#cb71-751"></a><span class="in">```{r}</span></span>
<span id="cb71-752"><a href="#cb71-752"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb71-753"><a href="#cb71-753"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span>
<span id="cb71-754"><a href="#cb71-754"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb71-755"><a href="#cb71-755"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span>
<span id="cb71-756"><a href="#cb71-756"></a><span class="in">```</span></span>
<span id="cb71-757"><a href="#cb71-757"></a></span>
<span id="cb71-760"><a href="#cb71-760"></a><span class="in">```{r}</span></span>
<span id="cb71-761"><a href="#cb71-761"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb71-762"><a href="#cb71-762"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-763"><a href="#cb71-763"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb71-764"><a href="#cb71-764"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-765"><a href="#cb71-765"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-766"><a href="#cb71-766"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-767"><a href="#cb71-767"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-768"><a href="#cb71-768"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb71-769"><a href="#cb71-769"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-770"><a href="#cb71-770"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb71-771"><a href="#cb71-771"></a><span class="in">```</span></span>
<span id="cb71-772"><a href="#cb71-772"></a></span>
<span id="cb71-773"><a href="#cb71-773"></a>后续参数估计和可靠度估计就先不做了。</span>
<span id="cb71-774"><a href="#cb71-774"></a></span>
<span id="cb71-775"><a href="#cb71-775"></a>类似的数据集还包括：</span>
<span id="cb71-776"><a href="#cb71-776"></a></span>
<span id="cb71-777"><a href="#cb71-777"></a><span class="fu">#### 3.3.4 惯导平台 interial navigition 数据</span></span>
<span id="cb71-778"><a href="#cb71-778"></a></span>
<span id="cb71-779"><a href="#cb71-779"></a><span class="at">&gt; 数据来自于文献：Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability **61**(1): 50-67.</span></span>
<span id="cb71-780"><a href="#cb71-780"></a></span>
<span id="cb71-781"><a href="#cb71-781"></a>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</span>
<span id="cb71-782"><a href="#cb71-782"></a></span>
<span id="cb71-783"><a href="#cb71-783"></a>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</span>
<span id="cb71-784"><a href="#cb71-784"></a></span>
<span id="cb71-785"><a href="#cb71-785"></a>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</span>
<span id="cb71-786"><a href="#cb71-786"></a></span>
<span id="cb71-787"><a href="#cb71-787"></a><span class="al">![](images/paste-40CEA295.png)</span></span>
<span id="cb71-788"><a href="#cb71-788"></a></span>
<span id="cb71-791"><a href="#cb71-791"></a><span class="in">```{r}</span></span>
<span id="cb71-792"><a href="#cb71-792"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb71-793"><a href="#cb71-793"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span>
<span id="cb71-794"><a href="#cb71-794"></a><span class="in">```</span></span>
<span id="cb71-795"><a href="#cb71-795"></a></span>
<span id="cb71-796"><a href="#cb71-796"></a>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</span>
<span id="cb71-797"><a href="#cb71-797"></a></span>
<span id="cb71-800"><a href="#cb71-800"></a><span class="in">```{r}</span></span>
<span id="cb71-801"><a href="#cb71-801"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb71-802"><a href="#cb71-802"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb71-803"><a href="#cb71-803"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb71-804"><a href="#cb71-804"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb71-805"><a href="#cb71-805"></a></span>
<span id="cb71-806"><a href="#cb71-806"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb71-807"><a href="#cb71-807"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb71-808"><a href="#cb71-808"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb71-809"><a href="#cb71-809"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb71-810"><a href="#cb71-810"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb71-811"><a href="#cb71-811"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb71-812"><a href="#cb71-812"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb71-813"><a href="#cb71-813"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb71-814"><a href="#cb71-814"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb71-815"><a href="#cb71-815"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-816"><a href="#cb71-816"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb71-817"><a href="#cb71-817"></a><span class="in">```</span></span>
<span id="cb71-818"><a href="#cb71-818"></a></span>
<span id="cb71-819"><a href="#cb71-819"></a><span class="fu">#### 3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</span></span>
<span id="cb71-820"><a href="#cb71-820"></a></span>
<span id="cb71-821"><a href="#cb71-821"></a><span class="at">&gt; 数据来自： (Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability 61(1): 50-67).</span></span>
<span id="cb71-822"><a href="#cb71-822"></a></span>
<span id="cb71-823"><a href="#cb71-823"></a>它是飞机上常用的金属材料，这种材料的完整性通过**疲劳裂纹的长度**来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</span>
<span id="cb71-824"><a href="#cb71-824"></a></span>
<span id="cb71-825"><a href="#cb71-825"></a>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。**退化过程存在非线性**。</span>
<span id="cb71-826"><a href="#cb71-826"></a></span>
<span id="cb71-829"><a href="#cb71-829"></a><span class="in">```{r}</span></span>
<span id="cb71-830"><a href="#cb71-830"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb71-831"><a href="#cb71-831"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span>
<span id="cb71-832"><a href="#cb71-832"></a><span class="in">```</span></span>
<span id="cb71-833"><a href="#cb71-833"></a></span>
<span id="cb71-836"><a href="#cb71-836"></a><span class="in">```{r}</span></span>
<span id="cb71-837"><a href="#cb71-837"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb71-838"><a href="#cb71-838"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb71-839"><a href="#cb71-839"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb71-840"><a href="#cb71-840"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb71-841"><a href="#cb71-841"></a></span>
<span id="cb71-842"><a href="#cb71-842"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb71-843"><a href="#cb71-843"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb71-844"><a href="#cb71-844"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb71-845"><a href="#cb71-845"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb71-846"><a href="#cb71-846"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-847"><a href="#cb71-847"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb71-848"><a href="#cb71-848"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb71-849"><a href="#cb71-849"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb71-850"><a href="#cb71-850"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-851"><a href="#cb71-851"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb71-852"><a href="#cb71-852"></a><span class="in">```</span></span>
<span id="cb71-853"><a href="#cb71-853"></a></span>
<span id="cb71-854"><a href="#cb71-854"></a><span class="fu">## 4. Gamma退化过程模型</span></span>
<span id="cb71-855"><a href="#cb71-855"></a></span>
<span id="cb71-856"><a href="#cb71-856"></a>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。 当产品的退化过程是严格单调非负时, Wiener 过程不再适用。Gamma 过程具有独立非负增量,可以对该类退化过程进行建模。</span>
<span id="cb71-857"><a href="#cb71-857"></a></span>
<span id="cb71-858"><a href="#cb71-858"></a><span class="fu">### 4.1 简单Gamma 退化过程</span></span>
<span id="cb71-859"><a href="#cb71-859"></a></span>
<span id="cb71-860"><a href="#cb71-860"></a>称连续时间随机过程 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是平稳 Gamma 过程 ${ }^{<span class="co">[</span><span class="ot">2</span><span class="co">]</span>}$, 若它满足以下性质:</span>
<span id="cb71-861"><a href="#cb71-861"></a></span>
<span id="cb71-862"><a href="#cb71-862"></a>(1) $X(0)=0$ 以概率 1 成立。</span>
<span id="cb71-863"><a href="#cb71-863"></a></span>
<span id="cb71-864"><a href="#cb71-864"></a>(2) $X(t)$ 具有平稳独立增量。</span>
<span id="cb71-865"><a href="#cb71-865"></a></span>
<span id="cb71-866"><a href="#cb71-866"></a>(3) 对任意 $t \geqslant 0$ 和 $\Delta t, X(t+\Delta t)-X(t) \sim G a(\alpha \Delta t, \beta)$ 。</span>
<span id="cb71-867"><a href="#cb71-867"></a></span>
<span id="cb71-868"><a href="#cb71-868"></a><span class="in">    其中 $G a(\alpha, \beta)$ 是形状参数为 $\alpha&gt;0$ 、尺度参数为 $\beta&gt;0$ 的 Gamma 分布, 分布密度函数为 $$</span></span>
<span id="cb71-869"><a href="#cb71-869"></a><span class="in">    f(x \mid \alpha, \beta)=\frac{1}{\Gamma(\alpha) \beta^\alpha} \alpha^{\alpha-1} \mathrm{e}^{-x / \beta} I_{(0, \infty)}(x)</span></span>
<span id="cb71-870"><a href="#cb71-870"></a><span class="in">    $$ 并且 $\{X(t), t \geqslant 0\}$ 称为形状参数为 $\alpha&gt;0$ 、尺度参数为 $\beta&gt;0$ 的平稳 Gamma 过程。</span></span>
<span id="cb71-871"><a href="#cb71-871"></a></span>
<span id="cb71-872"><a href="#cb71-872"></a>**产品寿命**</span>
<span id="cb71-873"><a href="#cb71-873"></a></span>
<span id="cb71-874"><a href="#cb71-874"></a>因为Gamma 过程的退化是单调递增的，即$X(t) \sim Ga(\alpha t,\beta)$ ,因此**产品寿命**的分布可以直接通过退化量的转换获得。当给定产品退化失效阈值 $\ell$ 时，产品寿命 $T$ 的CDF和PDF为</span>
<span id="cb71-875"><a href="#cb71-875"></a></span>
<span id="cb71-876"><a href="#cb71-876"></a>$$</span>
<span id="cb71-877"><a href="#cb71-877"></a>\begin{aligned}</span>
<span id="cb71-878"><a href="#cb71-878"></a>{F}_{{T}}(t) &amp;={P}({T} \leqslant {t})={P}({X}({t}) \geqslant \ell) <span class="sc">\\</span></span>
<span id="cb71-879"><a href="#cb71-879"></a>&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha {t}) \beta^{\alpha {t}}} {x}^{\alpha {t}-1} \mathrm{e}^{-\frac{{x}}{\beta}} {dx} <span class="sc">\\</span></span>
<span id="cb71-880"><a href="#cb71-880"></a>&amp;=\frac{1}{\Gamma(\alpha {t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi ,<span class="sc">\\</span></span>
<span id="cb71-881"><a href="#cb71-881"></a>{f}_{{T}}(t) &amp;=\frac{{d}}{{dt}} \frac{\Gamma(\alpha {t}, 1 / \beta)}{\Gamma(\alpha {t})} <span class="sc">\\</span></span>
<span id="cb71-882"><a href="#cb71-882"></a>&amp;=\frac{\alpha}{\Gamma(\alpha {t})} \int_0^{\nu / \beta}\left<span class="co">[</span><span class="ot">\ln (\xi)-\frac{\Gamma^{\prime}(\alpha {t})}{\Gamma(\alpha {t})}\right</span><span class="co">]</span> \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi.</span>
<span id="cb71-883"><a href="#cb71-883"></a>\end{aligned}</span>
<span id="cb71-884"><a href="#cb71-884"></a>$$</span>
<span id="cb71-885"><a href="#cb71-885"></a></span>
<span id="cb71-886"><a href="#cb71-886"></a>由于${f}_{{T}}({t})$ 相当复杂，因此一般用B-S分布来逼近：</span>
<span id="cb71-887"><a href="#cb71-887"></a></span>
<span id="cb71-888"><a href="#cb71-888"></a>$$</span>
<span id="cb71-889"><a href="#cb71-889"></a>{F}(t ; \ell)=\Phi\left<span class="co">[</span><span class="ot">\frac{1}{{v}}\left(\sqrt{\frac{{t}}{{u}}}-\sqrt{\frac{{u}}{{t}}}\right)\right</span><span class="co">]</span>, \quad {t}&gt;0.</span>
<span id="cb71-890"><a href="#cb71-890"></a>$$ 其中，$\Phi(\cdot)$ 为标准正态分布，$v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}$. 相应的 PDF 为 $$</span>
<span id="cb71-891"><a href="#cb71-891"></a>{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} {uv}}\left<span class="co">[</span><span class="ot">\left(\frac{{u}}{{t}}\right)^{\frac{1}{2}}+\left(\frac{{u}}{{t}}\right)^{\frac{3}{2}}\right</span><span class="co">]</span> \exp \left<span class="co">[</span><span class="ot">-\frac{1}{2 {v}^2}\left(\frac{{t}}{{u}}-2+\frac{{u}}{{t}}\right)\right</span><span class="co">]</span>, {t}&gt;0.</span>
<span id="cb71-892"><a href="#cb71-892"></a>$$</span>
<span id="cb71-893"><a href="#cb71-893"></a></span>
<span id="cb71-894"><a href="#cb71-894"></a>**剩余寿命**</span>
<span id="cb71-895"><a href="#cb71-895"></a></span>
<span id="cb71-896"><a href="#cb71-896"></a>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 $$</span>
<span id="cb71-897"><a href="#cb71-897"></a>\begin{aligned}</span>
<span id="cb71-898"><a href="#cb71-898"></a>{F}(t \mid s) &amp;={P}\left({T} \leqslant t \mid {X}(s)={x}_{s}\right) <span class="sc">\\</span></span>
<span id="cb71-899"><a href="#cb71-899"></a>&amp;={P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) <span class="sc">\\</span></span>
<span id="cb71-900"><a href="#cb71-900"></a>&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .</span>
<span id="cb71-901"><a href="#cb71-901"></a>\end{aligned}</span>
<span id="cb71-902"><a href="#cb71-902"></a>$$ 这与将失效阈值由 $\ell$ 变为 $\ell-{x_s}$ 、时间 $t$ 变为 $t-s$ 情形的寿命分布是一样的. 因此，在给定当前状态情况下，可以按照类似的途径更新剩余寿命.</span>
<span id="cb71-903"><a href="#cb71-903"></a></span>
<span id="cb71-906"><a href="#cb71-906"></a><span class="in">```{r}</span></span>
<span id="cb71-907"><a href="#cb71-907"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb71-908"><a href="#cb71-908"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb71-909"><a href="#cb71-909"></a><span class="fu">library</span>(viridis)</span>
<span id="cb71-910"><a href="#cb71-910"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb71-911"><a href="#cb71-911"></a><span class="in">```</span></span>
<span id="cb71-912"><a href="#cb71-912"></a></span>
<span id="cb71-913"><a href="#cb71-913"></a><span class="fu">#### 4.1.1 数据模拟产生</span></span>
<span id="cb71-914"><a href="#cb71-914"></a></span>
<span id="cb71-917"><a href="#cb71-917"></a><span class="in">```{r}</span></span>
<span id="cb71-918"><a href="#cb71-918"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb71-919"><a href="#cb71-919"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)){</span>
<span id="cb71-920"><a href="#cb71-920"></a>  <span class="co"># para 指 alpha,beta</span></span>
<span id="cb71-921"><a href="#cb71-921"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb71-922"><a href="#cb71-922"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb71-923"><a href="#cb71-923"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb71-924"><a href="#cb71-924"></a>  dat <span class="ot">=</span> dat_unit <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb71-925"><a href="#cb71-925"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> dat_unit[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb71-926"><a href="#cb71-926"></a>  <span class="co"># dat_unit = numeric()</span></span>
<span id="cb71-927"><a href="#cb71-927"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb71-928"><a href="#cb71-928"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) {</span>
<span id="cb71-929"><a href="#cb71-929"></a>      dat_unit[j,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],para[<span class="dv">2</span>])</span>
<span id="cb71-930"><a href="#cb71-930"></a>      dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb71-931"><a href="#cb71-931"></a>    }</span>
<span id="cb71-932"><a href="#cb71-932"></a>  }</span>
<span id="cb71-933"><a href="#cb71-933"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb71-934"><a href="#cb71-934"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb71-935"><a href="#cb71-935"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb71-936"><a href="#cb71-936"></a>  </span>
<span id="cb71-937"><a href="#cb71-937"></a>  dat_unit <span class="ot">=</span> <span class="fu">data.frame</span>(dat_unit)</span>
<span id="cb71-938"><a href="#cb71-938"></a>  dat_unit1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat_unit) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb71-939"><a href="#cb71-939"></a>  <span class="fu">colnames</span>(dat_unit1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb71-940"><a href="#cb71-940"></a>  </span>
<span id="cb71-941"><a href="#cb71-941"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dat1,dat_unit1)) <span class="co">#dat1是退化量,data_unit1是退化增量</span></span>
<span id="cb71-942"><a href="#cb71-942"></a>}</span>
<span id="cb71-943"><a href="#cb71-943"></a><span class="in">```</span></span>
<span id="cb71-944"><a href="#cb71-944"></a></span>
<span id="cb71-945"><a href="#cb71-945"></a>绘制退化路径图</span>
<span id="cb71-946"><a href="#cb71-946"></a></span>
<span id="cb71-949"><a href="#cb71-949"></a><span class="in">```{r}</span></span>
<span id="cb71-950"><a href="#cb71-950"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb71-951"><a href="#cb71-951"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb71-952"><a href="#cb71-952"></a>    <span class="co"># 画图</span></span>
<span id="cb71-953"><a href="#cb71-953"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb71-954"><a href="#cb71-954"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb71-955"><a href="#cb71-955"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-956"><a href="#cb71-956"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb71-957"><a href="#cb71-957"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-958"><a href="#cb71-958"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb71-959"><a href="#cb71-959"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb71-960"><a href="#cb71-960"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb71-961"><a href="#cb71-961"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb71-962"><a href="#cb71-962"></a>  <span class="fu">print</span>(p)</span>
<span id="cb71-963"><a href="#cb71-963"></a>}</span>
<span id="cb71-964"><a href="#cb71-964"></a><span class="in">```</span></span>
<span id="cb71-965"><a href="#cb71-965"></a></span>
<span id="cb71-968"><a href="#cb71-968"></a><span class="in">```{r}</span></span>
<span id="cb71-969"><a href="#cb71-969"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb71-970"><a href="#cb71-970"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb71-971"><a href="#cb71-971"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb71-972"><a href="#cb71-972"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb71-973"><a href="#cb71-973"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat[[<span class="dv">1</span>]])) <span class="co">#print table</span></span>
<span id="cb71-974"><a href="#cb71-974"></a><span class="fu">plot_path</span>(dat[[<span class="dv">1</span>]]) <span class="co">#print path plot</span></span>
<span id="cb71-975"><a href="#cb71-975"></a><span class="in">```</span></span>
<span id="cb71-976"><a href="#cb71-976"></a></span>
<span id="cb71-977"><a href="#cb71-977"></a><span class="fu">#### 4.1.2 统计推断</span></span>
<span id="cb71-978"><a href="#cb71-978"></a></span>
<span id="cb71-979"><a href="#cb71-979"></a>假设共有 ${n}$ 个样品进行性能退化试验. 对于样品 $i$, 初始时刻 $t_0$ 性能退化量为 $X_{i 0}=0$, 在时刻 $t_1, \cdots, t_{m_i}$ 测量产品的性能退化量, 得到其测量值为 $X_{i 1}, \cdots, X_{i m_i}$. 记 $\Delta x_{i j}=X_{i j}-X_{i(j-1)}$ 是样品 $i$ 在时刻 $t_{j-1}$ 和 $t_j$ 之间的性能退化量, 由 Gamma 过程的独立增量性得到$\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)$。</span>
<span id="cb71-980"><a href="#cb71-980"></a></span>
<span id="cb71-981"><a href="#cb71-981"></a><span class="fu">##### 4.1.2.1 矩估计</span></span>
<span id="cb71-982"><a href="#cb71-982"></a></span>
<span id="cb71-983"><a href="#cb71-983"></a>令 $R_{i j}=\Delta X_{i j} / \Delta t_{i j}$, 则诸 $R_{i j}, j=1,2, \cdots, m_i, i=1,2, \cdots, n$ 服从形状参数为 $\alpha$ 、尺度参数为 $\beta$ 的 Gamma 分布, 且相互独立(根据 Gamma 过程独立增量特性, 以及各样品退化过程的独立性)。记 $M=\sum_{i=1}^n m_i$, 样本均值和样本方差为 $$</span>
<span id="cb71-984"><a href="#cb71-984"></a>\begin{align}</span>
<span id="cb71-985"><a href="#cb71-985"></a>\bar{R}&amp; =\frac{1}{M} \sum_{i=1}^n \sum_{j=1}^{m_i} R_{i j} <span class="sc">\\</span></span>
<span id="cb71-986"><a href="#cb71-986"></a>S_R^2 &amp; =\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">R_{i j}-\bar{R}\right</span><span class="co">]</span>^2</span>
<span id="cb71-987"><a href="#cb71-987"></a>\end{align}</span>
<span id="cb71-988"><a href="#cb71-988"></a>$$ 易知 $$</span>
<span id="cb71-989"><a href="#cb71-989"></a>\begin{aligned}</span>
<span id="cb71-990"><a href="#cb71-990"></a>E<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span> &amp;=\alpha \beta <span class="sc">\\</span></span>
<span id="cb71-991"><a href="#cb71-991"></a>Var<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span>&amp;=\frac{1}{M^2} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb71-992"><a href="#cb71-992"></a>\end{aligned}</span>
<span id="cb71-993"><a href="#cb71-993"></a>$$ 所以，</span>
<span id="cb71-994"><a href="#cb71-994"></a></span>
<span id="cb71-995"><a href="#cb71-995"></a>$$</span>
<span id="cb71-996"><a href="#cb71-996"></a>\begin{aligned}</span>
<span id="cb71-997"><a href="#cb71-997"></a>E\left<span class="co">[</span><span class="ot">S_R^2\right</span><span class="co">]</span>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left<span class="co">[</span><span class="ot">R_{i j}-\bar{R}\right</span><span class="co">]</span>^2<span class="sc">\\</span></span>
<span id="cb71-998"><a href="#cb71-998"></a>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left<span class="co">[</span><span class="ot">R_{i j}-\alpha \beta-(\bar{R}-\alpha \beta)\right</span><span class="co">]</span>^2 <span class="sc">\\</span></span>
<span id="cb71-999"><a href="#cb71-999"></a>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="sc">\{</span>Var\left<span class="co">[</span><span class="ot">R_{i j}\right</span><span class="co">]</span>^2-\frac{2}{m_i} Var\left<span class="co">[</span><span class="ot">R_{i j}\right</span><span class="co">]</span>+ Var<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span>\right<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb71-1000"><a href="#cb71-1000"></a>&amp;=\frac{1}{M-1} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">\frac{1}{\Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb71-1001"><a href="#cb71-1001"></a>\end{aligned}</span>
<span id="cb71-1002"><a href="#cb71-1002"></a>$$ 将待估参数和样本矩联系起来, 即令 $$</span>
<span id="cb71-1003"><a href="#cb71-1003"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-1004"><a href="#cb71-1004"></a>\alpha \beta=\bar{R} <span class="sc">\\</span></span>
<span id="cb71-1005"><a href="#cb71-1005"></a>\alpha \beta^2=M S_R^2 / \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span></span>
<span id="cb71-1006"><a href="#cb71-1006"></a>\end{array}\right.</span>
<span id="cb71-1007"><a href="#cb71-1007"></a>$$ 可得如下矩估计: $$</span>
<span id="cb71-1008"><a href="#cb71-1008"></a>\begin{gathered}</span>
<span id="cb71-1009"><a href="#cb71-1009"></a>\hat{\alpha}=\frac{\sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span> \bar{R}^2}{M S_R^2} <span class="sc">\\</span></span>
<span id="cb71-1010"><a href="#cb71-1010"></a>\hat{\beta}=\frac{M S_R^2}{\sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span> \bar{R}}</span>
<span id="cb71-1011"><a href="#cb71-1011"></a>\end{gathered}</span>
<span id="cb71-1012"><a href="#cb71-1012"></a>$$</span>
<span id="cb71-1013"><a href="#cb71-1013"></a></span>
<span id="cb71-1014"><a href="#cb71-1014"></a>上述矩估计方法是基于退化速率的，金光还给出了基于退化量的矩估计（详见P128）,注意到当测量间隔都相同时，两个矩估计方法相同。</span>
<span id="cb71-1015"><a href="#cb71-1015"></a></span>
<span id="cb71-1018"><a href="#cb71-1018"></a><span class="in">```{r}</span></span>
<span id="cb71-1019"><a href="#cb71-1019"></a>gamma_moment <span class="ot">=</span> <span class="cf">function</span>(data_unit, group , t ){</span>
<span id="cb71-1020"><a href="#cb71-1020"></a></span>
<span id="cb71-1021"><a href="#cb71-1021"></a>  <span class="co"># 每组测量次数相同</span></span>
<span id="cb71-1022"><a href="#cb71-1022"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb71-1023"><a href="#cb71-1023"></a>  M <span class="ot">=</span> group<span class="sc">*</span><span class="fu">max</span>(t)</span>
<span id="cb71-1024"><a href="#cb71-1024"></a>  Rij <span class="ot">=</span> data_unit<span class="sc">/</span>delta_t</span>
<span id="cb71-1025"><a href="#cb71-1025"></a>  Rbar <span class="ot">=</span> <span class="fu">sum</span>(Rij)<span class="sc">/</span>M</span>
<span id="cb71-1026"><a href="#cb71-1026"></a>  SR2 <span class="ot">=</span> <span class="fu">sum</span>((Rij<span class="sc">-</span>Rbar)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(M<span class="dv">-1</span>)</span>
<span id="cb71-1027"><a href="#cb71-1027"></a>  MSR2 <span class="ot">=</span> M<span class="sc">*</span>SR2</span>
<span id="cb71-1028"><a href="#cb71-1028"></a>  tt <span class="ot">=</span> group<span class="sc">*</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>delta_t)</span>
<span id="cb71-1029"><a href="#cb71-1029"></a>  moment_alp <span class="ot">=</span> Rbar<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>tt<span class="sc">/</span>MSR2</span>
<span id="cb71-1030"><a href="#cb71-1030"></a>  moment_beta <span class="ot">=</span> MSR2<span class="sc">/</span>(tt<span class="sc">*</span>Rbar)</span>
<span id="cb71-1031"><a href="#cb71-1031"></a>  </span>
<span id="cb71-1032"><a href="#cb71-1032"></a>  moment_par <span class="ot">=</span> <span class="fu">c</span>(moment_alp,moment_beta)</span>
<span id="cb71-1033"><a href="#cb71-1033"></a>  <span class="fu">return</span>(moment_par)</span>
<span id="cb71-1034"><a href="#cb71-1034"></a>  </span>
<span id="cb71-1035"><a href="#cb71-1035"></a>}</span>
<span id="cb71-1036"><a href="#cb71-1036"></a><span class="co"># 这里算出来beta的矩估计跟真值差距很大</span></span>
<span id="cb71-1037"><a href="#cb71-1037"></a><span class="co"># 注意如果用模拟数据产生的话，只保留增量数据,也要去掉第一行的0</span></span>
<span id="cb71-1038"><a href="#cb71-1038"></a><span class="co"># ？ 前面加上这么多只是为了画图好看，是不是可以删掉这些东西</span></span>
<span id="cb71-1039"><a href="#cb71-1039"></a>increment <span class="ot">=</span> dat[[<span class="dv">2</span>]]</span>
<span id="cb71-1040"><a href="#cb71-1040"></a>increment <span class="ot">=</span> increment[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb71-1041"><a href="#cb71-1041"></a>degradation <span class="ot">=</span> dat[[<span class="dv">1</span>]]</span>
<span id="cb71-1042"><a href="#cb71-1042"></a>degradation <span class="ot">=</span> degradation[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb71-1043"><a href="#cb71-1043"></a>  </span>
<span id="cb71-1044"><a href="#cb71-1044"></a>moment_par <span class="ot">=</span> <span class="fu">gamma_moment</span>(<span class="at">data_unit =</span> increment, <span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb71-1045"><a href="#cb71-1045"></a>moment_par</span>
<span id="cb71-1046"><a href="#cb71-1046"></a></span>
<span id="cb71-1047"><a href="#cb71-1047"></a><span class="in">```</span></span>
<span id="cb71-1048"><a href="#cb71-1048"></a></span>
<span id="cb71-1049"><a href="#cb71-1049"></a><span class="fu">##### 4.1.2.2 极大似然估计</span></span>
<span id="cb71-1050"><a href="#cb71-1050"></a></span>
<span id="cb71-1051"><a href="#cb71-1051"></a>由 Gamma 过程独立增量特性, 以及 $$</span>
<span id="cb71-1052"><a href="#cb71-1052"></a>\Delta X_{i j} \sim G a\left(\alpha \Delta t_{i j}, \beta\right)=\frac{\left(\Delta x_{i j} / \beta\right)^{\alpha \Delta t_{i j}-1}}{\beta \Gamma\left(\alpha \Delta t_{i j}\right)} \mathrm{e}^{-\Delta x_{i j} / \beta}</span>
<span id="cb71-1053"><a href="#cb71-1053"></a>$$ 可以获得对数似然函数为 $$</span>
<span id="cb71-1054"><a href="#cb71-1054"></a>l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)</span>
<span id="cb71-1055"><a href="#cb71-1055"></a>$$ 由极大似然估计原理, 令 $$</span>
<span id="cb71-1056"><a href="#cb71-1056"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb71-1057"><a href="#cb71-1057"></a>\frac{\partial l}{\partial \alpha}=\sum_{i=1}^n \sum_{j=1}^{m_i} \Delta t_{i j}\left(\ln x_{i j}-\psi\left(\alpha \Delta t_{i j}\right)-\ln \beta\right)=0 <span class="sc">\\</span></span>
<span id="cb71-1058"><a href="#cb71-1058"></a>\frac{\partial l}{\partial \beta}=\sum_{i=1}^n\left(\frac{x_{i m_i}}{\beta^2}-\frac{\alpha t_{i m_i}}{\beta}\right)=0</span>
<span id="cb71-1059"><a href="#cb71-1059"></a>\end{array}\right.</span>
<span id="cb71-1060"><a href="#cb71-1060"></a>$$ 式中 $\psi(u)$ 是 digamma 函数。 $$</span>
<span id="cb71-1061"><a href="#cb71-1061"></a>\begin{aligned}</span>
<span id="cb71-1062"><a href="#cb71-1062"></a>&amp;\hat{\beta}=\frac{\sum_{i=1}^n X_{i m_i}}{\alpha \sum_{i=1}^n t_{i m_i}}<span class="sc">\\</span></span>
<span id="cb71-1063"><a href="#cb71-1063"></a>&amp;\sum_{i=1}^n\left<span class="co">[</span><span class="ot">\sum_{j=1}^{m_i} \Delta t_{i j} \ln \left(\Delta x_{i j}\right)-t_{i m_i} \ln \frac{x_{i m_i}}{\alpha t_{i m_i}}-\sum_{j=1}^{m_i} \Delta t_{i j} \psi\left(\alpha \Delta t_{i j}\right)\right</span><span class="co">]</span>=0</span>
<span id="cb71-1064"><a href="#cb71-1064"></a>\end{aligned}</span>
<span id="cb71-1065"><a href="#cb71-1065"></a>$$</span>
<span id="cb71-1066"><a href="#cb71-1066"></a></span>
<span id="cb71-1069"><a href="#cb71-1069"></a><span class="in">```{r}</span></span>
<span id="cb71-1070"><a href="#cb71-1070"></a><span class="fu">library</span>(BB)</span>
<span id="cb71-1071"><a href="#cb71-1071"></a></span>
<span id="cb71-1072"><a href="#cb71-1072"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb71-1073"><a href="#cb71-1073"></a>    <span class="co">#x is alpha</span></span>
<span id="cb71-1074"><a href="#cb71-1074"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb71-1075"><a href="#cb71-1075"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb71-1076"><a href="#cb71-1076"></a>    <span class="fu">return</span>(l)</span>
<span id="cb71-1077"><a href="#cb71-1077"></a>}</span>
<span id="cb71-1078"><a href="#cb71-1078"></a></span>
<span id="cb71-1079"><a href="#cb71-1079"></a>startx <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb71-1080"><a href="#cb71-1080"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb71-1081"><a href="#cb71-1081"></a></span>
<span id="cb71-1082"><a href="#cb71-1082"></a>mle_re</span>
<span id="cb71-1083"><a href="#cb71-1083"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb71-1084"><a href="#cb71-1084"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb71-1085"><a href="#cb71-1085"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb71-1086"><a href="#cb71-1086"></a></span>
<span id="cb71-1087"><a href="#cb71-1087"></a></span>
<span id="cb71-1088"><a href="#cb71-1088"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:200, lower = 1, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb71-1089"><a href="#cb71-1089"></a><span class="co"># </span></span>
<span id="cb71-1090"><a href="#cb71-1090"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb71-1091"><a href="#cb71-1091"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb71-1092"><a href="#cb71-1092"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span>
<span id="cb71-1093"><a href="#cb71-1093"></a></span>
<span id="cb71-1094"><a href="#cb71-1094"></a><span class="in">```</span></span>
<span id="cb71-1095"><a href="#cb71-1095"></a></span>
<span id="cb71-1098"><a href="#cb71-1098"></a><span class="in">```{r}</span></span>
<span id="cb71-1099"><a href="#cb71-1099"></a><span class="do">## 可靠度计算</span></span>
<span id="cb71-1100"><a href="#cb71-1100"></a>gamma_R <span class="ot">=</span> <span class="cf">function</span>(t, threshold,par){</span>
<span id="cb71-1101"><a href="#cb71-1101"></a>  alp <span class="ot">=</span> par[<span class="dv">1</span>]</span>
<span id="cb71-1102"><a href="#cb71-1102"></a>  beta <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb71-1103"><a href="#cb71-1103"></a>  v <span class="ot">=</span> <span class="fu">sqrt</span>(beta<span class="sc">/</span>threshold)</span>
<span id="cb71-1104"><a href="#cb71-1104"></a>  u <span class="ot">=</span> threshold<span class="sc">/</span>(alp<span class="sc">*</span>beta)</span>
<span id="cb71-1105"><a href="#cb71-1105"></a>  R <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>((<span class="fu">sqrt</span>(t<span class="sc">/</span>u)<span class="sc">-</span><span class="fu">sqrt</span>(u<span class="sc">/</span>t))<span class="sc">/</span>v) </span>
<span id="cb71-1106"><a href="#cb71-1106"></a>  <span class="fu">return</span>(R)</span>
<span id="cb71-1107"><a href="#cb71-1107"></a>}</span>
<span id="cb71-1108"><a href="#cb71-1108"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">70</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span>
<span id="cb71-1109"><a href="#cb71-1109"></a></span>
<span id="cb71-1110"><a href="#cb71-1110"></a><span class="co"># plot(gamma_R(t = 1:300, threshold = 150,par = mle_par),type = "l")</span></span>
<span id="cb71-1111"><a href="#cb71-1111"></a><span class="in">```</span></span>
<span id="cb71-1112"><a href="#cb71-1112"></a></span>
<span id="cb71-1113"><a href="#cb71-1113"></a><span class="fu">##### 4.1.2.3 广义推断方法</span></span>
<span id="cb71-1114"><a href="#cb71-1114"></a></span>
<span id="cb71-1115"><a href="#cb71-1115"></a><span class="ss">-   </span>伽马 + 随机过程</span>
<span id="cb71-1116"><a href="#cb71-1116"></a></span>
<span id="cb71-1117"><a href="#cb71-1117"></a>Wang, X. F., et al. (2021). "Degradation data analysis based on gamma process with random effects." European Journal of Operational Research 292(3): 1200-1208.</span>
<span id="cb71-1118"><a href="#cb71-1118"></a></span>
<span id="cb71-1119"><a href="#cb71-1119"></a><span class="ss">-   </span>伽马 + 加速寿命试验</span>
<span id="cb71-1120"><a href="#cb71-1120"></a></span>
<span id="cb71-1121"><a href="#cb71-1121"></a>Jiang, P. H., et al. (2019). "Inference for constant-stress accelerated degradation test based on Gamma process." Applied Mathematical Modelling 67: 123-134.</span>
<span id="cb71-1122"><a href="#cb71-1122"></a></span>
<span id="cb71-1123"><a href="#cb71-1123"></a><span class="fu">### 4.2 含协变量影响及随机效应情形</span></span>
<span id="cb71-1124"><a href="#cb71-1124"></a></span>
<span id="cb71-1125"><a href="#cb71-1125"></a>随机效应反映个体差异的不确定性，协变量反映环境的影响。在基于 Gamma 过程的退化建模问题中, 随机效应通过混合尺度 Gamma 过程来描述。</span>
<span id="cb71-1126"><a href="#cb71-1126"></a></span>
<span id="cb71-1127"><a href="#cb71-1127"></a><span class="ss">-   </span>尺度参数 $B$ 是服从 逆 Gamma 分布的随机变量, 即 $W=B^{-1} \sim G a\left(\delta, \gamma^{-1}\right)$; 在给定 $B=1 / w$ 的情况下, $X(t)$ 是 形状函数为 $\alpha(t)$ 、尺度参数为 $1 / w$ 的非平稳 Gamma 过程。</span>
<span id="cb71-1128"><a href="#cb71-1128"></a><span class="ss">-   </span>如果存在协变量效应, 假设协变量可以集成进入尺度参数, 从而尺度参数 $B$ 用 $B \xi(z)$ 代替, 这里 $z$ 表示协变量, $\xi(z)$ 表示协变量效应。</span>
<span id="cb71-1129"><a href="#cb71-1129"></a></span>
<span id="cb71-1130"><a href="#cb71-1130"></a>在这些假设下, 可以得到退化增量 $\Delta X_{i j}$ 的**联合分布密度**如下: $$</span>
<span id="cb71-1131"><a href="#cb71-1131"></a>\begin{aligned}</span>
<span id="cb71-1132"><a href="#cb71-1132"></a>&amp;f\left(\Delta x_{i j}, j=1, \cdots, m_i, i=1, \cdots, n\right)=\int\left<span class="sc">\{</span>\prod_{i=1}^n \prod_{j=1}^{m_i} g a\left(\Delta x_{i j} ; w^{-1} \xi_{z_i}, \Delta \alpha_{i j}\right)\right<span class="sc">\}</span> g a\left(w ; \gamma^{-1}, \delta\right) \mathrm{d} w <span class="sc">\\</span></span>
<span id="cb71-1133"><a href="#cb71-1133"></a>&amp;=\prod_{i=1}^n\left<span class="co">[</span><span class="ot">\frac{\Gamma\left(\delta+\alpha_{i m_i}\right)}{\Gamma(\delta) \prod_{j=1}^{m_i} \Gamma\left(\Delta \alpha_{i j}\right)} \frac{\left(\gamma \xi_{z_i}\right)^\delta \prod_{j=1}^{m_i}\left(\Delta x_{i j}\right)^{\Delta \alpha_{i j}-1}}{\left.\left(\gamma \xi_{z_i}+x_{i m_i}\right)^{\delta+\alpha_{i m_i}}\right</span><span class="co">]</span>}\right] <span class="sc">\\</span></span>
<span id="cb71-1134"><a href="#cb71-1134"></a>\end{aligned}</span>
<span id="cb71-1135"><a href="#cb71-1135"></a>$$ 式中 $x_{i m_i}=\sum_{j=1}^{m_i} \Delta x_{i j}$ ; $\alpha_{i m_i}=\sum_{j=1}^{m_i} \Delta \alpha_{i j}$ ; \$ \xi<span class="sc">\_</span>{z_i}=\xi\left(z_i\right) \$; $z_i$ 是样品$i$ 的协变量取值。</span>
<span id="cb71-1136"><a href="#cb71-1136"></a></span>
<span id="cb71-1137"><a href="#cb71-1137"></a>通过极大化上述似然函数, 即可得到参数的极大似然估计。当然, 由于此似然函数非常复杂, 一般需要采用数值解法, 如牛顿 - 拉夫逊算法、拟牛顿法等。 <span class="co">&lt;!-- 除上述极大似然估计外, 文献 [24]还提出一种拟极大似然方法,其中形状函数采用非参数估计,随机尺度参数的分布参数采用截面极大似然法获得。感兴趣的读者可 参考相关文献。 --&gt;</span></span>
<span id="cb71-1138"><a href="#cb71-1138"></a></span>
<span id="cb71-1139"><a href="#cb71-1139"></a><span class="ss">-   </span>有些情况下需要估计个体的尺度参数 $\beta_i$ 。由于 $E\left[X_{i m_i} \mid B=\beta_i\right]=\beta_i \alpha_{i m_i}$, 因此一个有 效的估计是 $\tilde{\beta}_i=X_{i m_i} / \alpha_{i m_i}$ 。实际上, $\tilde{\beta}_i$ 是退化增量 $\Delta X_{i j}, j=1,2, \cdots, m_i$ 的最小方差线性无偏估计, 这由 $\Delta X_{i j} \mid \beta_i=\beta_i^2 \Delta \alpha_{i j}$ 可知。</span>
<span id="cb71-1140"><a href="#cb71-1140"></a></span>
<span id="cb71-1141"><a href="#cb71-1141"></a><span class="ss">-   </span>另一种估计可由 $W=B^{-1}$ 与退化增量的联合分布得到, 这里对应的密度函数为 $\left<span class="sc">\{</span>\prod_{j=1}^{m_i} g a\left(\Delta x_{i j} ; w^{-1}, \Delta \alpha_{i j}\right)\right\} g a\left(w ; \gamma^{-1}, \delta\right)$, 从中可以得到给定 退化增量情况下 $W$ 的条件分布为 $G a\left\{\left(x_{i m_i}+\gamma\right)^{-1}, \alpha_{i m_i}+\delta\right<span class="sc">\}</span>$, 条件期望为 $$</span>
<span id="cb71-1142"><a href="#cb71-1142"></a>    E\left<span class="co">[</span><span class="ot">W \mid \Delta x_{i 1}, \cdots, \Delta x_{i m_i}\right</span><span class="co">]</span>=\left(\alpha_{i m_i}+\delta\right) /\left(x_{i m_i}+\gamma\right)</span>
<span id="cb71-1143"><a href="#cb71-1143"></a>    $$ 将参数估计结果代人上式或上面的 $\tilde{\beta}_i$, 得到对应于个体产品的 $W$ 或 $B$ 的实现的估计。</span>
<span id="cb71-1144"><a href="#cb71-1144"></a></span>
<span id="cb71-1145"><a href="#cb71-1145"></a>除了需要估计随机效应分布, 有时还关心随机效应是否显著的假设检验问题(即是否确实存在随机效应或个体差异). <span class="co">&lt;!-- 。当 $\gamma \rightarrow \infty$ 以及 $\delta=\gamma \nu$, 其中 $\nu$ 是固定和有限 的, $W=B^{-1}$ 将聚集在均值 $\nu$ 周围, 而逆 Gamma 随机变量 $B$ 将聚集在 $1 / \nu$ 周围, 从而混 合尺度 Gamma 过程趋向于形状函数为 $\alpha(t)$ 、 (公共的) 尺度参数为 $\xi_z / \nu$ 的简单 Gamma 过程。因此, 为了检验随机效应, 相当于检验假设 $\mathrm{H}_0: \gamma=\infty$ 。 --&gt;</span> <span class="co">&lt;!-- 文献 [1]提出一种计分统计量, 下面给出其构造过程。首先, 在零假设成立条件 下, 有 --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span> <span class="co">&lt;!-- \begin{gathered} --&gt;</span> <span class="co">&lt;!-- E\left[x(t)-\alpha_t \xi_z / \nu\right]=0 \\ --&gt;</span> <span class="co">&lt;!-- E\left[\left(x(t)-\alpha_t \xi_z / \nu\right)^2\right]=\alpha_t \xi_z^2 / \nu^2 \\ --&gt;</span> <span class="co">&lt;!-- E\left[\left(x(t)-\alpha_t \xi_z / \nu\right)^4\right]=3\left(1+2 / \alpha_t\right) \alpha_t^2 \xi_x^4 / \nu^4 --&gt;</span> <span class="co">&lt;!-- \end{gathered} --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span> <span class="co">&lt;!-- 下标 0 表示在零假设成立的条件下求期望。根据式 (4.9) 并考虑协变量过程 $\xi_z$, 可以 得到个体单元对应的似然函数为 --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span> <span class="co">&lt;!-- f\left(\Delta x_1, \cdots, \Delta x_m\right)=\frac{\Gamma\left(\delta+\alpha_m\right)}{\Gamma(\delta) \prod_{i=1}^m \Gamma\left(\Delta \alpha_i\right)} \frac{\left(\gamma \xi_z\right)^\delta \prod_{i=1}^m\left(\Delta x_i\right)^{\Delta \alpha_i-1}}{\left(\gamma \xi_z+x_m\right)^{\delta+\alpha_m}} --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span> <span class="co">&lt;!-- 式中: $x_m=\sum_{i=1}^m \Delta x_i, \alpha_m=\sum_{i=1}^m \Delta \alpha_i, m$ 为单元测量次数。 从而对数似然函数为 --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span> <span class="co">&lt;!-- \begin{aligned} --&gt;</span> <span class="co">&lt;!-- l=&amp; \ln \Gamma\left(\delta+\alpha_m\right)-\ln \Gamma(\delta)-\sum_{i=1}^m \ln \Gamma\left(\Delta \alpha_i\right) \\ --&gt;</span> <span class="co">&lt;!-- &amp;+\delta \ln \left(\gamma \xi_z\right)+\sum_{i=1}^m\left(\Delta \alpha_i-1\right) \ln \left(\Delta x_i\right)-\left(\delta+\alpha_m\right) \ln \left(\gamma \xi_z+x_m\right) --&gt;</span> <span class="co">&lt;!-- \end{aligned} --&gt;</span> <span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1146"><a href="#cb71-1146"></a></span>
<span id="cb71-1147"><a href="#cb71-1147"></a><span class="co">&lt;!-- 置 $\delta=\gamma \nu$, 则 --&gt;</span></span>
<span id="cb71-1148"><a href="#cb71-1148"></a></span>
<span id="cb71-1149"><a href="#cb71-1149"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1150"><a href="#cb71-1150"></a></span>
<span id="cb71-1151"><a href="#cb71-1151"></a><span class="co">&lt;!-- \begin{aligned} --&gt;</span></span>
<span id="cb71-1152"><a href="#cb71-1152"></a></span>
<span id="cb71-1153"><a href="#cb71-1153"></a><span class="co">&lt;!-- &amp;\frac{\partial l}{\partial \gamma}=\nu\left\{1+\ln \left(\gamma \xi_z\right)+\psi\left(\gamma \nu+\alpha_m\right)-\psi(\gamma \nu)-\ln \left(\gamma \xi_z+x_m\right)\right\} \\ --&gt;</span></span>
<span id="cb71-1154"><a href="#cb71-1154"></a></span>
<span id="cb71-1155"><a href="#cb71-1155"></a><span class="co">&lt;!-- &amp;-\xi_z\left(\gamma \nu+\alpha_m\right)\left(\gamma \xi_z+x_m\right)^{-1} --&gt;</span></span>
<span id="cb71-1156"><a href="#cb71-1156"></a></span>
<span id="cb71-1157"><a href="#cb71-1157"></a><span class="co">&lt;!-- \end{aligned} --&gt;</span></span>
<span id="cb71-1158"><a href="#cb71-1158"></a></span>
<span id="cb71-1159"><a href="#cb71-1159"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1160"><a href="#cb71-1160"></a></span>
<span id="cb71-1161"><a href="#cb71-1161"></a><span class="co">&lt;!-- 式中 $: \psi(\cdot)$ 是 digamma 函数。 --&gt;</span></span>
<span id="cb71-1162"><a href="#cb71-1162"></a></span>
<span id="cb71-1163"><a href="#cb71-1163"></a><span class="co">&lt;!-- 当 $\gamma \rightarrow \infty$ 时, $\partial l / \partial \gamma \rightarrow 0$, 因此需要更仔细的计算过程。由文献 $[43]$, 有 --&gt;</span></span>
<span id="cb71-1164"><a href="#cb71-1164"></a></span>
<span id="cb71-1165"><a href="#cb71-1165"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1166"><a href="#cb71-1166"></a></span>
<span id="cb71-1167"><a href="#cb71-1167"></a><span class="co">&lt;!-- \psi(u)=\ln u-\frac{1}{2 u}-\frac{1}{12 u^2}+O\left(u^{-3}\right) --&gt;</span></span>
<span id="cb71-1168"><a href="#cb71-1168"></a></span>
<span id="cb71-1169"><a href="#cb71-1169"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1170"><a href="#cb71-1170"></a></span>
<span id="cb71-1171"><a href="#cb71-1171"></a><span class="co">&lt;!-- 因此 --&gt;</span></span>
<span id="cb71-1172"><a href="#cb71-1172"></a></span>
<span id="cb71-1173"><a href="#cb71-1173"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1174"><a href="#cb71-1174"></a></span>
<span id="cb71-1175"><a href="#cb71-1175"></a><span class="co">&lt;!-- \frac{\partial l}{\partial \gamma}=\nu\left\{\ln \left(1-\frac{x_m}{\gamma \xi_z+x_m}\right)+\ln \left(1+\frac{\alpha_m}{\gamma \nu}\right)+\frac{\alpha_m}{2 \gamma \nu\left(\gamma \nu+\alpha_m\right)}+\frac{\alpha_m \frac{\xi_z}{\nu}-x_m}{\gamma \xi_z+x_m}+o\left(\gamma^{-3}\right)\right\} --&gt;</span></span>
<span id="cb71-1176"><a href="#cb71-1176"></a></span>
<span id="cb71-1177"><a href="#cb71-1177"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1178"><a href="#cb71-1178"></a></span>
<span id="cb71-1179"><a href="#cb71-1179"></a><span class="co">&lt;!-- 注意到对小的 $u, \ln (1+u)$ 可以近似为 $u-u^2 / 2+u^3 / 3-\cdots$, 在上面的算式中使用此近 似以简化对应项, 可以得到 $\partial l / \partial \gamma=A \gamma^{-2}+O\left(\gamma^{-3}\right)$, 其中 --&gt;</span></span>
<span id="cb71-1180"><a href="#cb71-1180"></a></span>
<span id="cb71-1181"><a href="#cb71-1181"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1182"><a href="#cb71-1182"></a></span>
<span id="cb71-1183"><a href="#cb71-1183"></a><span class="co">&lt;!-- A=-\frac{1}{2} \nu \xi_z^{-2}\left\{\left(x_m-\alpha_m \xi_z / \nu\right)^2-\alpha_m \xi_z^2 / \nu^2\right\} --&gt;</span></span>
<span id="cb71-1184"><a href="#cb71-1184"></a></span>
<span id="cb71-1185"><a href="#cb71-1185"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1186"><a href="#cb71-1186"></a></span>
<span id="cb71-1187"><a href="#cb71-1187"></a><span class="co">&lt;!-- $A$ 是用于检验随机效应的统计量。虽然它不是通过对数似然的一阶导数计算的原始计 分统计量, 它确实是导数的主要项, 因此也称作计分统计量。 --&gt;</span></span>
<span id="cb71-1188"><a href="#cb71-1188"></a></span>
<span id="cb71-1189"><a href="#cb71-1189"></a><span class="co">&lt;!-- 由式(4.29)看到, 式 (4.33) 括号中的项表示样本 $X\left(t_{i m_i}\right)$ 的方差与总体方差的差 异, 因此由式 (4.29)得到 --&gt;</span></span>
<span id="cb71-1190"><a href="#cb71-1190"></a></span>
<span id="cb71-1191"><a href="#cb71-1191"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1192"><a href="#cb71-1192"></a></span>
<span id="cb71-1193"><a href="#cb71-1193"></a><span class="co">&lt;!-- E_0[A]=-\frac{1}{2} \nu \xi_z^{-2}\left\{E_0\left[\left(x_m-\alpha_m \xi_z / \nu\right)^2\right]-\alpha_m \xi_z^2 / \nu^2\right\}=0 --&gt;</span></span>
<span id="cb71-1194"><a href="#cb71-1194"></a></span>
<span id="cb71-1195"><a href="#cb71-1195"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1196"><a href="#cb71-1196"></a></span>
<span id="cb71-1197"><a href="#cb71-1197"></a><span class="co">&lt;!-- 以及 --&gt;</span></span>
<span id="cb71-1198"><a href="#cb71-1198"></a></span>
<span id="cb71-1199"><a href="#cb71-1199"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1200"><a href="#cb71-1200"></a></span>
<span id="cb71-1201"><a href="#cb71-1201"></a><span class="co">&lt;!-- \begin{aligned} --&gt;</span></span>
<span id="cb71-1202"><a href="#cb71-1202"></a></span>
<span id="cb71-1203"><a href="#cb71-1203"></a><span class="co">&lt;!-- \operatorname{Var}_0[A] &amp;=E_0\left[A^2\right] \\ --&gt;</span></span>
<span id="cb71-1204"><a href="#cb71-1204"></a></span>
<span id="cb71-1205"><a href="#cb71-1205"></a><span class="co">&lt;!-- &amp;=\frac{1}{4} \nu^2 \xi_z^{-4}\left\{E_0\left[\left(X_m-\alpha_m \xi_z / \nu\right)^4-\alpha_m^2 \xi_z^4 / \nu^4\right]\right\} \\ --&gt;</span></span>
<span id="cb71-1206"><a href="#cb71-1206"></a></span>
<span id="cb71-1207"><a href="#cb71-1207"></a><span class="co">&lt;!-- &amp;=\frac{\alpha_m\left(\alpha_m+3\right)}{2 \nu^2} --&gt;</span></span>
<span id="cb71-1208"><a href="#cb71-1208"></a></span>
<span id="cb71-1209"><a href="#cb71-1209"></a><span class="co">&lt;!-- \end{aligned} --&gt;</span></span>
<span id="cb71-1210"><a href="#cb71-1210"></a></span>
<span id="cb71-1211"><a href="#cb71-1211"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1212"><a href="#cb71-1212"></a></span>
<span id="cb71-1213"><a href="#cb71-1213"></a><span class="co">&lt;!-- 根据大数定理,计分统计量定义为 --&gt;</span></span>
<span id="cb71-1214"><a href="#cb71-1214"></a></span>
<span id="cb71-1215"><a href="#cb71-1215"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1216"><a href="#cb71-1216"></a></span>
<span id="cb71-1217"><a href="#cb71-1217"></a><span class="co">&lt;!-- U=\frac{A}{\sqrt{\operatorname{Var}_0(A)}} --&gt;</span></span>
<span id="cb71-1218"><a href="#cb71-1218"></a></span>
<span id="cb71-1219"><a href="#cb71-1219"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1220"><a href="#cb71-1220"></a></span>
<span id="cb71-1221"><a href="#cb71-1221"></a><span class="co">&lt;!-- 它服从标准正态分布。因此, 给定数据集, 可以估计 Gamma 过程的参数, 并使用估计值 计算计分统计量 $U_{\circ}$ 如果 $\mid U$ 的值大于正态分布上 $\alpha / 2$ 分位数 $z_{\alpha / 2}$, 其中 $\alpha$ 是显著性水 平, 则应该拒绝原假设, 也就是说此时应该考虑混合尺度 Gamma 过程。 --&gt;</span></span>
<span id="cb71-1222"><a href="#cb71-1222"></a></span>
<span id="cb71-1223"><a href="#cb71-1223"></a><span class="fu">### 4.3 有测量误差情形</span></span>
<span id="cb71-1224"><a href="#cb71-1224"></a></span>
<span id="cb71-1225"><a href="#cb71-1225"></a><span class="ss">-   </span>当测量误差显著时, 此时, 观测数据是被噪声污染的 Gamma 过程的样本路径。</span>
<span id="cb71-1226"><a href="#cb71-1226"></a></span>
<span id="cb71-1227"><a href="#cb71-1227"></a><span class="ss">-   </span>设在时刻 $t_{i j}$ 的测量值为 $y_{i j}=x_{i j}+\varepsilon_{i j}$, 其中 $x_{i j}$ 是实际退化, $\varepsilon_{i j}$ 是正态独立随机变量, 均值为 0 , 方差为 $\sigma_e^2$ 。</span>
<span id="cb71-1228"><a href="#cb71-1228"></a></span>
<span id="cb71-1229"><a href="#cb71-1229"></a><span class="ss">-   </span>注意到 $\Delta y_{i j}=\Delta x_{i j}+\varepsilon_{i j}-\varepsilon_{i, j-1}$, 因此 虽然 $\Delta x_{i j}$ 是独立的, 观测到的增量 $\Delta y_{i j}$ 不再是独立的, 这导致似然函数的构造变得复杂。</span>
<span id="cb71-1230"><a href="#cb71-1230"></a></span>
<span id="cb71-1231"><a href="#cb71-1231"></a>实际上, 对样品 $i$ 的观测数据, 有 $$</span>
<span id="cb71-1232"><a href="#cb71-1232"></a>\left(\begin{array}{c}</span>
<span id="cb71-1233"><a href="#cb71-1233"></a>\Delta y_{i 1} <span class="sc">\\</span></span>
<span id="cb71-1234"><a href="#cb71-1234"></a>\Delta y_{i 2} <span class="sc">\\</span></span>
<span id="cb71-1235"><a href="#cb71-1235"></a>\vdots <span class="sc">\\</span></span>
<span id="cb71-1236"><a href="#cb71-1236"></a>\Delta y_{i m_i}</span>
<span id="cb71-1237"><a href="#cb71-1237"></a>\end{array}\right)=\left(\begin{array}{c}</span>
<span id="cb71-1238"><a href="#cb71-1238"></a>\Delta x_{i 1} <span class="sc">\\</span></span>
<span id="cb71-1239"><a href="#cb71-1239"></a>\Delta x_{i 2} <span class="sc">\\</span></span>
<span id="cb71-1240"><a href="#cb71-1240"></a>\vdots <span class="sc">\\</span></span>
<span id="cb71-1241"><a href="#cb71-1241"></a>\Delta x_{i m_i}</span>
<span id="cb71-1242"><a href="#cb71-1242"></a>\end{array}\right)+\left[\begin{array}{cccc}</span>
<span id="cb71-1243"><a href="#cb71-1243"></a>1 &amp; &amp; &amp; <span class="sc">\\</span></span>
<span id="cb71-1244"><a href="#cb71-1244"></a>-1 &amp; 1 &amp; &amp; <span class="sc">\\</span></span>
<span id="cb71-1245"><a href="#cb71-1245"></a>&amp; \ddots &amp; \ddots &amp; <span class="sc">\\</span></span>
<span id="cb71-1246"><a href="#cb71-1246"></a>&amp; &amp; -1 &amp; 1</span>
<span id="cb71-1247"><a href="#cb71-1247"></a>\end{array}\right]\left(\begin{array}{c}</span>
<span id="cb71-1248"><a href="#cb71-1248"></a>\varepsilon_{i 1} <span class="sc">\\</span></span>
<span id="cb71-1249"><a href="#cb71-1249"></a>\varepsilon_{i 2} <span class="sc">\\</span></span>
<span id="cb71-1250"><a href="#cb71-1250"></a>\vdots <span class="sc">\\</span></span>
<span id="cb71-1251"><a href="#cb71-1251"></a>\varepsilon_{i m_i}</span>
<span id="cb71-1252"><a href="#cb71-1252"></a>\end{array}\right)</span>
<span id="cb71-1253"><a href="#cb71-1253"></a>$$ 或者 $\Delta \boldsymbol{y}_i=\Delta \boldsymbol{x}_i+C \varepsilon_i=\Delta \boldsymbol{x}_i+\eta_i$, 其中 $\eta_i \sim N\left(0, \sigma^2 \Sigma\right)$, 而且 $$</span>
<span id="cb71-1254"><a href="#cb71-1254"></a>\sum=C C^{\prime}=\left[\begin{array}{ccccc}</span>
<span id="cb71-1255"><a href="#cb71-1255"></a>1 &amp; -1 &amp; &amp; &amp; <span class="sc">\\</span></span>
<span id="cb71-1256"><a href="#cb71-1256"></a>-1 &amp; 2 &amp; -1 &amp; &amp; <span class="sc">\\</span></span>
<span id="cb71-1257"><a href="#cb71-1257"></a>&amp; \ddots &amp; \ddots &amp; \ddots &amp; <span class="sc">\\</span></span>
<span id="cb71-1258"><a href="#cb71-1258"></a>&amp; &amp; -1 &amp; 2 &amp; -1 <span class="sc">\\</span></span>
<span id="cb71-1259"><a href="#cb71-1259"></a>&amp; &amp; &amp; -1 &amp; 2</span>
<span id="cb71-1260"><a href="#cb71-1260"></a>\end{array}\right]</span>
<span id="cb71-1261"><a href="#cb71-1261"></a>$$ 也就是说, $\eta_{i 1}, \cdots, \eta_{i m_i}$ 并不是相互独立的。因此, 这时的似然函数难以解析求解, 一般 需要采用数值方法。</span>
<span id="cb71-1262"><a href="#cb71-1262"></a></span>
<span id="cb71-1263"><a href="#cb71-1263"></a>**更一般的情形**</span>
<span id="cb71-1264"><a href="#cb71-1264"></a></span>
<span id="cb71-1265"><a href="#cb71-1265"></a>下面考虑一种更加一般的情形, 并采用 MC 方法得到模型参数的估计。对实际退化进行观测, 观测值满足如下模型: $$</span>
<span id="cb71-1266"><a href="#cb71-1266"></a>Y(t)=F(X(t))+\varepsilon</span>
<span id="cb71-1267"><a href="#cb71-1267"></a>$$ 这里观测噪声 $\varepsilon \sim N\left(0, \sigma^2\right)$ 。显然, 有测量误 差是这里的特殊情形, 此时只要取 $F(t)=t$ 即可。在基于退化的可靠性建模问题中, 称 $X(t)$ 为直接退化量 (Direct Indicator), 而 $Y(t)$ 称为间接退化量 (Indirect Indicator)。下 面的计算过程假设 $F(X(t))=c X(t)^d$ 。</span>
<span id="cb71-1268"><a href="#cb71-1268"></a></span>
<span id="cb71-1269"><a href="#cb71-1269"></a>假设可以在 $t_1, t_2, \cdots, t_n$ 时刻进行观测, $n$ 是观测次数。 <span class="co">&lt;!-- 在第 $i$ 个观测时刻获得的直接和间接退化量记为 $x_i$ 和 $y_i$ 。进一步假设由于测量困难等原因, 只能观测到一部分直接退化量, 但是所有间接退化量都可以观测得到 (这种情况可称为不平衡测量)。 --&gt;</span> 函数 $I_{\mathrm{obv}}(\cdot)$ 定义为 $$</span>
<span id="cb71-1270"><a href="#cb71-1270"></a>I_{\mathrm{obv}}(i)= \begin{cases}0, &amp; x_i \text { 不可观测 } <span class="sc">\\</span> 1, &amp; x_i \text { 可观测 }\end{cases}</span>
<span id="cb71-1271"><a href="#cb71-1271"></a>$$ 用来表示一个观测量是直接退化量。第 $l$ 个可观测的直接退化量的观测时间指标记为 $k_l, l=1,2, \cdots, m$, 其中 $m$ 是观测的直接退化量的个数。显然 $I_{\mathrm{obv}}\left(k_l\right)=1, l=1,2, \cdots$, $m$ 。假设至少能够观测到一个直接退化量, 即 $m&gt;0$ 。下面采用 EM 算法来解决参数估 计问题。 假设可观测的直接退化量 $x_{k_{1, m}}=\left<span class="sc">\{</span>x_{k_l}: l=1,2, \cdots, m\right<span class="sc">\}</span>$ 以及它们对应的间接退化量 $y_{k_{1, m}}=\left<span class="sc">\{</span>y_{k_l}: l=1,2, \cdots, m\right<span class="sc">\}</span>$, 则基于 $x_{k_1, m}$ 和 $y_{k_{1, m}}$ 的完整似然函数, 可以得到参数的一个极 大似然估计, 将该估计作为模型参数的初始值。</span>
<span id="cb71-1272"><a href="#cb71-1272"></a></span>
<span id="cb71-1273"><a href="#cb71-1273"></a>**EM算法**</span>
<span id="cb71-1274"><a href="#cb71-1274"></a></span>
<span id="cb71-1275"><a href="#cb71-1275"></a>在 $\mathrm{EM}$ 算法的 $\mathrm{E}$ 步, 需要估计对应于所有 $n$ 个时刻的可能观测数据的完整的似然 函数的期望。完整似然函数可以分为两个部分: $$</span>
<span id="cb71-1276"><a href="#cb71-1276"></a>E\left<span class="co">[</span><span class="ot">\ln \left(f\left(x_{1 ; n}, y_{1 ; n} \mid \boldsymbol{\theta}\right)\right)\right</span><span class="co">]</span>=E\left<span class="co">[</span><span class="ot">\ln \left(f\left(x_{1 ; n} \mid \boldsymbol{\theta}_1\right)\right)\right</span><span class="co">]</span>+E\left<span class="co">[</span><span class="ot">\ln \left(f\left(y_{1 ; n} \mid \boldsymbol{\theta}_2, x_{1 ; n}\right)\right)\right</span><span class="co">]</span></span>
<span id="cb71-1277"><a href="#cb71-1277"></a>$$ 式中: 参数 $\boldsymbol{\theta} 、 \boldsymbol{\theta}_1$ 和 $\boldsymbol{\theta}_2$ 表示待估参数向量, 其中 $\boldsymbol{\theta}=(a, b, \beta, c, d, \boldsymbol{\sigma}), \boldsymbol{\theta}_1=(a, b, \boldsymbol{\beta}), \boldsymbol{\theta}_2=$ $(c, d, \sigma)$ 。式 (4.37) 的两个部分可以进一步计算如下: $$</span>
<span id="cb71-1278"><a href="#cb71-1278"></a>\begin{aligned}</span>
<span id="cb71-1279"><a href="#cb71-1279"></a>&amp; E\left<span class="co">[</span><span class="ot">\ln \left(f\left(x_{1 ; n} \mid \boldsymbol{\theta}_1\right)\right)\right</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb71-1280"><a href="#cb71-1280"></a>=&amp; E\left(\ln \left(\prod_{i=2}^n g a\left(v_i ; u_i, \beta\right)\right)\right) <span class="sc">\\</span></span>
<span id="cb71-1281"><a href="#cb71-1281"></a>=&amp; \sum_{i=2}^n\left(-u_i \ln \beta-\ln \Gamma\left(u_i\right)+\left(u_i-1\right) E\left(\ln \left(v_i\right)\right)-\left(E\left(X_i\right)-E\left(X_{i-1}\right)\right) / \beta\right)</span>
<span id="cb71-1282"><a href="#cb71-1282"></a>\end{aligned}</span>
<span id="cb71-1283"><a href="#cb71-1283"></a>$$ 和 $$</span>
<span id="cb71-1284"><a href="#cb71-1284"></a>\begin{aligned}</span>
<span id="cb71-1285"><a href="#cb71-1285"></a>&amp; E\left<span class="co">[</span><span class="ot">\ln \left(f\left(y_{1: n} \mid \boldsymbol{\theta}_2, x_{1: n}\right)\right)\right</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb71-1286"><a href="#cb71-1286"></a>=&amp;-n \ln \sigma-\frac{n}{2} \ln 2 \pi-\frac{1}{2 \sigma 2} \sum_{i=1}^n\left(y_i^2-2 y_i c E\left(X_i^d\right)+c^2 E\left(X_i^{2 d}\right)\right)</span>
<span id="cb71-1287"><a href="#cb71-1287"></a>\end{aligned}</span>
<span id="cb71-1288"><a href="#cb71-1288"></a>$$ 式中 $: v_i=x_i-x_{i-1}, i=2,3, \cdots, n ; u_i=a t_i^b-a t_{i-1}^b, i=2,3, \cdots, n_{\text {。 }}$</span>
<span id="cb71-1289"><a href="#cb71-1289"></a></span>
<span id="cb71-1290"><a href="#cb71-1290"></a>式中的 4 个期望值 $E\left(X_i\right) 、 E\left(X_i^d\right) 、 E\left(X_i^{2 d}\right)$ 以及 $E\left(\ln \left(\nu_i\right)\right)$ 通过下面的仿真方法(粒子光滑算法) 获得。</span>
<span id="cb71-1291"><a href="#cb71-1291"></a></span>
<span id="cb71-1292"><a href="#cb71-1292"></a>**仿真方法(粒子光滑算法)**</span>
<span id="cb71-1293"><a href="#cb71-1293"></a></span>
<span id="cb71-1294"><a href="#cb71-1294"></a><span class="ss">1.  </span>首先辨识基于 Gamma 过程的状态空间模型的状态转移过程。 <span class="co">&lt;!-- 根据 Gamma 桥性质,在获得直接退化量的观测数据之后, 系统的退化过程从Gamma过程变为混合随机过程,该混合随机过程为 --&gt;</span> $$</span>
<span id="cb71-1295"><a href="#cb71-1295"></a>    \begin{aligned}</span>
<span id="cb71-1296"><a href="#cb71-1296"></a>    &amp;f\left(X_i \mid X_{1: n-1}, X_{k_{1, m}}\right) <span class="sc">\\</span></span>
<span id="cb71-1297"><a href="#cb71-1297"></a>    &amp;= \begin{cases}f\left(X_i \mid X_{i-1}, X_{n_i}\right)=b e\left(\frac{x_i-x_{i-1}}{x_{n_i}-x_{i-1}} ; \alpha\left(t_i\right)-\alpha\left(t_{i-1}\right), \alpha\left(t_{n_i}\right)-\alpha\left(t_i\right)\right), <span class="sc">\\</span></span>
<span id="cb71-1298"><a href="#cb71-1298"></a>    &amp; I_{\mathrm{obv}}(i)=0, i<span class="kw">&lt;k_m</span> <span class="er">\\</span></span>
<span id="cb71-1299"><a href="#cb71-1299"></a><span class="ot">    f</span><span class="er">\left(X_i</span> <span class="er">\mid</span> <span class="er">X_{i-1}\right)</span><span class="ot">=</span><span class="st">g</span> <span class="er">a\left(x_i-x_{i-1}</span> <span class="er">;</span> <span class="er">\alpha\left(t_i\right)-\alpha\left(t_{i-1}\right),</span> <span class="er">\beta\right),</span> <span class="er">&amp;</span> <span class="er">I_{\mathrm{obv}}(i)</span><span class="ot">=</span><span class="st">0,</span> <span class="er">i</span><span class="kw">&gt;</span>k_m\end{cases}</span>
<span id="cb71-1300"><a href="#cb71-1300"></a>    \end{aligned}</span>
<span id="cb71-1301"><a href="#cb71-1301"></a>    $$</span>
<span id="cb71-1302"><a href="#cb71-1302"></a></span>
<span id="cb71-1303"><a href="#cb71-1303"></a>式中: $n_i$ 是给定当前观测时间指标 $i$ 的条件下,下一个直接观测退化量的观测时间指 标, 即 $n_i=\min \left<span class="sc">\{</span>u ; u&gt;i, I_{\mathrm{obv}}(u)=1\right<span class="sc">\}</span>, i<span class="kw">&lt;k_m</span> <span class="er">;</span> <span class="er">b</span> <span class="er">e(\because</span> <span class="er">;</span> <span class="er">\alpha,</span> <span class="er">\beta)$</span> <span class="er">是参数为</span> <span class="er">$\alpha$</span> <span class="er">和</span> <span class="er">$\beta$</span> <span class="er">的</span> <span class="er">Beta</span> <span class="er">分布的概率密度函数。</span> <span class="er">&lt;!--</span> <span class="er">(这里利用了</span> <span class="er">Gamma</span> <span class="er">桥性质。当直接退化量是</span> <span class="er">Wiener</span> <span class="er">过程时,</span> <span class="er">可用</span> <span class="er">Brownian</span> <span class="er">桥性质构造类似的混合随机过程;</span> <span class="er">更一般的情况可以通过</span> <span class="er">Bayesian</span> <span class="er">定理构造</span> <span class="er">验后随机过程)。</span> <span class="er">--</span><span class="kw">&gt;</span></span>
<span id="cb71-1304"><a href="#cb71-1304"></a></span>
<span id="cb71-1305"><a href="#cb71-1305"></a><span class="ss">2.  </span>从该混合随机过程抽取 $N_f$ 个样本序列, 记为 $s_{1: n}^{1: N_f}=\left<span class="sc">\{</span>s_i^j: i=1,2, \cdots, n, j=1,2, \cdots\right.$, $\left.N_f\right<span class="sc">\}</span>$, <span class="co">&lt;!-- 使用这 $N_f$ 个序列可以得到式 (4.50) 和式 (4.51) 中的期望值的估计: --&gt;</span> $$</span>
<span id="cb71-1306"><a href="#cb71-1306"></a>    \begin{cases}E\left(X_i\right)=\frac{1}{N_f} \sum_{j=1}^{N_f} s_i^j, &amp; E\left(X_i^{2 d}\right)=\frac{1}{N_f} \sum_{j=1}^{N_f}\left(s_i^j\right)^{2 d} \\ E\left(X_i^d\right)=\frac{1}{N_f} \sum_{j=1}^{N_f}\left(s_i^j\right)^d, &amp; E\left(\ln \left(X_i-X_{i-1}\right)\right)=\frac{1}{N_f} \sum_{j=1}^{N_f} \ln \left(s_i^j-s_{i-1}^j\right)\end{cases}</span>
<span id="cb71-1307"><a href="#cb71-1307"></a>    $$ 一旦获得了完整似然函数的期望, 就可以进行最大化获得对应的参数的"条件" 似然估计。</span>
<span id="cb71-1308"><a href="#cb71-1308"></a></span>
<span id="cb71-1309"><a href="#cb71-1309"></a><span class="co">&lt;!-- 基于 Gamma 过程的状态空间模型的参数估计结束后, 应该计算协方差矩阵以便得 到置信区间估计。文献 [44]基于粒子光滑得到计算协方差矩阵的方法, 其中观测的信 息阵为 --&gt;</span></span>
<span id="cb71-1310"><a href="#cb71-1310"></a></span>
<span id="cb71-1311"><a href="#cb71-1311"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1312"><a href="#cb71-1312"></a></span>
<span id="cb71-1313"><a href="#cb71-1313"></a><span class="co">&lt;!-- \begin{gathered} --&gt;</span></span>
<span id="cb71-1314"><a href="#cb71-1314"></a></span>
<span id="cb71-1315"><a href="#cb71-1315"></a><span class="co">&lt;!-- -\frac{\partial^2 \ln f\left(y_{1: n}, x_{k_{1, m}} \mid \boldsymbol{\theta}\right)}{\partial \theta \partial \theta^{\mathrm{T</span><span class="re">}}}</span><span class="co"> \approx \frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial^2 \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \theta \partial \theta^{\mathrm{T</span><span class="re">}}}</span><span class="co"> \\ --&gt;</span></span>
<span id="cb71-1316"><a href="#cb71-1316"></a></span>
<span id="cb71-1317"><a href="#cb71-1317"></a><span class="co">&lt;!-- -\frac{1}{N_f} \sum_{j=1}^{N_f} \frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}} \frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}^{\mathrm{T</span><span class="re">}}}</span><span class="co"> \\ --&gt;</span></span>
<span id="cb71-1318"><a href="#cb71-1318"></a></span>
<span id="cb71-1319"><a href="#cb71-1319"></a><span class="co">&lt;!-- +\left(\frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}}\right)\left(\frac{1}{N_f} \sum_{j=1}^{N_f}-\frac{\partial \ln f\left(s_{1: n}^j, x_{1: n} \mid \boldsymbol{\theta}\right)}{\partial \boldsymbol{\theta}^{\mathrm{T</span><span class="re">}}}</span><span class="co">\right) --&gt;</span></span>
<span id="cb71-1320"><a href="#cb71-1320"></a></span>
<span id="cb71-1321"><a href="#cb71-1321"></a><span class="co">&lt;!-- \end{gathered} --&gt;</span></span>
<span id="cb71-1322"><a href="#cb71-1322"></a></span>
<span id="cb71-1323"><a href="#cb71-1323"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1324"><a href="#cb71-1324"></a></span>
<span id="cb71-1325"><a href="#cb71-1325"></a><span class="co">&lt;!-- 式中 $: s_{1, n}^j$ 是光滑粒子的第 $j$ 个序列。 --&gt;</span></span>
<span id="cb71-1326"><a href="#cb71-1326"></a></span>
<span id="cb71-1327"><a href="#cb71-1327"></a><span class="co">&lt;!-- **基于粒子光滑的序贯抽样方法** --&gt;</span></span>
<span id="cb71-1328"><a href="#cb71-1328"></a></span>
<span id="cb71-1329"><a href="#cb71-1329"></a><span class="co">&lt;!-- 1. 首先,假设基于直到第 $i$ 个观测时刻 $t_i$ 的间接退化量 $y_{1: i}$ 得到 $t_i$ 时刻的直接退化量分布, 表示为 --&gt;</span></span>
<span id="cb71-1330"><a href="#cb71-1330"></a></span>
<span id="cb71-1331"><a href="#cb71-1331"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1332"><a href="#cb71-1332"></a></span>
<span id="cb71-1333"><a href="#cb71-1333"></a><span class="co">&lt;!-- f\left(x_i \mid y_{1: i}\right) \approx \sum_{j=1}^{N_f} w_i^j \delta\left(x_i-x_i^j\right), \quad i=1,2, \cdots, n --&gt;</span></span>
<span id="cb71-1334"><a href="#cb71-1334"></a></span>
<span id="cb71-1335"><a href="#cb71-1335"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1336"><a href="#cb71-1336"></a></span>
<span id="cb71-1337"><a href="#cb71-1337"></a><span class="co">&lt;!-- 式中: $\delta(\cdot)$ 是狄拉克函数, 定义为 --&gt;</span></span>
<span id="cb71-1338"><a href="#cb71-1338"></a></span>
<span id="cb71-1339"><a href="#cb71-1339"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1340"><a href="#cb71-1340"></a></span>
<span id="cb71-1341"><a href="#cb71-1341"></a><span class="co">&lt;!-- \delta\left(x-x^j\right)= \begin{cases}0, &amp; x \neq x^j \\ 1, &amp; x=x^j\end{cases} --&gt;</span></span>
<span id="cb71-1342"><a href="#cb71-1342"></a></span>
<span id="cb71-1343"><a href="#cb71-1343"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1344"><a href="#cb71-1344"></a></span>
<span id="cb71-1345"><a href="#cb71-1345"></a><span class="co">&lt;!-- 2. 随机数 $\left\{x_i^j ; j=1, \cdots, N_f \mid\right.$ 被称作粒子, 它们一般通过一个重要性分布 $q\left(x_i^j \mid x_{i-1}^j, y_i\right)$ 抽取, 并且对应的权重 $\left\{w_i^j ; j=1, \cdots, N_f\right\}$ 可以递推计算如下: --&gt;</span></span>
<span id="cb71-1346"><a href="#cb71-1346"></a></span>
<span id="cb71-1347"><a href="#cb71-1347"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1348"><a href="#cb71-1348"></a></span>
<span id="cb71-1349"><a href="#cb71-1349"></a><span class="co">&lt;!-- w_i^j \propto w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i\right)} --&gt;</span></span>
<span id="cb71-1350"><a href="#cb71-1350"></a></span>
<span id="cb71-1351"><a href="#cb71-1351"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1352"><a href="#cb71-1352"></a></span>
<span id="cb71-1353"><a href="#cb71-1353"></a><span class="co">&lt;!-- 显然, 在上述逼近验后分布的过程中, 只用了截止到当前时刻的观测值, 称为粒子 滤波过程。粒子光滑考虑了整个观测序列, 因此具有更好的近似精度。 $\operatorname{Simon}^{[44]}$ 提出 的后向模拟粒子光滑, 是基于粒子滤波(即 $x_{1: n}^{1: N_f}=\left\{x_i^j ; i=1,2, \cdots, n, j=1,2, \cdots, N_f\right\}$ ) 的。 粒子光滑的递推算法为 --&gt;</span></span>
<span id="cb71-1354"><a href="#cb71-1354"></a></span>
<span id="cb71-1355"><a href="#cb71-1355"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1356"><a href="#cb71-1356"></a></span>
<span id="cb71-1357"><a href="#cb71-1357"></a><span class="co">&lt;!-- w_{i i i+1}^{j, u} \propto \frac{w_i^u f\left(s_{i+1}^j \mid x_i^u\right)}{\sum_{i=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^{\varepsilon}\right)}, \quad u=1,2, \cdots, N_f, i=1,2, \cdots, n-1 --&gt;</span></span>
<span id="cb71-1358"><a href="#cb71-1358"></a></span>
<span id="cb71-1359"><a href="#cb71-1359"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1360"><a href="#cb71-1360"></a></span>
<span id="cb71-1361"><a href="#cb71-1361"></a><span class="co">&lt;!-- 式中: $w_{i i i+1}^{j, u}$ 表示在第 $i$ 步的对应于第 $i+1$ 步的第 $j$ 个光滑粒子的第 $u$ 个滤波粒子的 权重。 --&gt;</span></span>
<span id="cb71-1362"><a href="#cb71-1362"></a></span>
<span id="cb71-1363"><a href="#cb71-1363"></a><span class="co">&lt;!-- 然后根据权重 $w_{i l i+1}^{j, 1, N_f}=\left\{w_{i i i+1}^{j, u} ; u=1,2, \cdots, N_f\right\}$ 从 $x_i^{1, N_f}$ 重采样得到随机数 $s_i^j$, 在第 $i$ 个时刻状态的分布就采用光滑粒子 $\left\{s_i^j ; j=1,2, \cdots, N_f\right\}$ 近似。 --&gt;</span></span>
<span id="cb71-1364"><a href="#cb71-1364"></a></span>
<span id="cb71-1365"><a href="#cb71-1365"></a><span class="co">&lt;!-- 回到退化过程,滤波粒子的权重按如下方式递推地更新: --&gt;</span></span>
<span id="cb71-1366"><a href="#cb71-1366"></a></span>
<span id="cb71-1367"><a href="#cb71-1367"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1368"><a href="#cb71-1368"></a></span>
<span id="cb71-1369"><a href="#cb71-1369"></a><span class="co">&lt;!-- w_i^j \propto \begin{cases}w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j, x_{n_i}\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i, x_{n_i}\right)}, &amp; i&lt;k_m \\ w_{i-1}^j \frac{f\left(y_i \mid x_i^j\right) f\left(x_i^j \mid x_{i-1}^j\right)}{q\left(x_i^j \mid x_{i-1}^j, y_i\right)}, &amp; i&gt;k_m\end{cases} --&gt;</span></span>
<span id="cb71-1370"><a href="#cb71-1370"></a></span>
<span id="cb71-1371"><a href="#cb71-1371"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1372"><a href="#cb71-1372"></a></span>
<span id="cb71-1373"><a href="#cb71-1373"></a><span class="co">&lt;!-- 两个重要性密度, 即 $q\left(x_i^j \mid x_{i-1}^j, y_i, x_{n_i}\right)$ 和 $q\left(x_i^j \mid x_{i-1}^j, y_i\right)$, 服从式 (4.40) 中的两个方程, 即 $f\left(x_i \mid x_{i-1}, x_{n_i}\right)$ 和 $f\left(x_i \mid x_{i-1}\right)$ 。在时间点 $t_{k_{1, m}}=\left\{t_{k_l} ; l=1,2, \cdots, m\right\}$ 直接退化量是已知的, 所有 $N_f$ 个粒子就直接设置为观测到的直接退化量 $x_{k_{1, m}}$ 。在其他时刻采用序贯重要性 重采样(SIR)算法。类似地, 式 (4.44) 中光滑粒子的递推权重计算公式修正为 --&gt;</span></span>
<span id="cb71-1374"><a href="#cb71-1374"></a></span>
<span id="cb71-1375"><a href="#cb71-1375"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1376"><a href="#cb71-1376"></a></span>
<span id="cb71-1377"><a href="#cb71-1377"></a><span class="co">&lt;!-- w_{i i+1}^{j, u} \propto \begin{cases}\frac{w_i^u f\left(s_{i+1}^j \mid x_i^u, x_{n_{i+1}}\right)}{\sum_{f=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^v, x_{n_{i+1}}\right)}, &amp; i&lt;k_m \\ \frac{w_i^u f\left(s_{i+1}^j \mid x_i^u\right)}{\sum_{v=1}^{N_f} w_i^v f\left(s_{i+1}^j \mid x_i^v\right)}, &amp; i&gt;k_m\end{cases} --&gt;</span></span>
<span id="cb71-1378"><a href="#cb71-1378"></a></span>
<span id="cb71-1379"><a href="#cb71-1379"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb71-1380"><a href="#cb71-1380"></a></span>
<span id="cb71-1381"><a href="#cb71-1381"></a><span class="co">&lt;!-- 式 (4.46) 中的两个部分 $f\left(s_{i+1}^j \mid x_i^u, x_{n_{i+1}}\right)$ 和 $f\left(s_{i+1}^j \mid x_i^u\right)$ 满足式 (4.40) 中的两个方 程。在时刻 $t_i$, 若 $I_{\mathrm{obv}}(i)=1$ 或 $I_{\mathrm{obv}}(i+1)=1$, 粒子滤波结果直接取为粒子光滑的结果; 在其他时刻,粒子光滑通过后向模拟算法得到。 --&gt;</span></span>
<span id="cb71-1382"><a href="#cb71-1382"></a></span>
<span id="cb71-1383"><a href="#cb71-1383"></a><span class="fu">### 4.4 案例分析</span></span>
<span id="cb71-1384"><a href="#cb71-1384"></a></span>
<span id="cb71-1385"><a href="#cb71-1385"></a><span class="fu">#### 4.4.1 wear data</span></span>
<span id="cb71-1386"><a href="#cb71-1386"></a></span>
<span id="cb71-1387"><a href="#cb71-1387"></a><span class="at">&gt; 数据来自： Ye Z.S., et al. (2014). "Semiparametric Estimation of Gamma Processes for Deteriorating Products" Technometrics</span></span>
<span id="cb71-1388"><a href="#cb71-1388"></a></span>
<span id="cb71-1389"><a href="#cb71-1389"></a>Wear of a tire tread is a major cause of tire failures. To assess the wear behavior of a batch of tire treads from a factory, a bus park in South Korea sampled some tires installed on buses of the same version. Degradation level of each tire was measured, and its time in service (in thousands of kilometers) was retrospected.</span>
<span id="cb71-1390"><a href="#cb71-1390"></a></span>
<span id="cb71-1393"><a href="#cb71-1393"></a><span class="in">```{r}</span></span>
<span id="cb71-1394"><a href="#cb71-1394"></a>wear_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/wear data.csv"</span>)</span>
<span id="cb71-1395"><a href="#cb71-1395"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wear_dat))</span>
<span id="cb71-1396"><a href="#cb71-1396"></a>wear_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(wear_dat<span class="sc">$</span>Unit)</span>
<span id="cb71-1397"><a href="#cb71-1397"></a><span class="in">```</span></span>
<span id="cb71-1398"><a href="#cb71-1398"></a></span>
<span id="cb71-1401"><a href="#cb71-1401"></a><span class="in">```{r}</span></span>
<span id="cb71-1402"><a href="#cb71-1402"></a>wear_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,wear,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb71-1403"><a href="#cb71-1403"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-1404"><a href="#cb71-1404"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-1405"><a href="#cb71-1405"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-1406"><a href="#cb71-1406"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-1407"><a href="#cb71-1407"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-1408"><a href="#cb71-1408"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-1409"><a href="#cb71-1409"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span>
<span id="cb71-1410"><a href="#cb71-1410"></a><span class="in">```</span></span>
<span id="cb71-1411"><a href="#cb71-1411"></a></span>
<span id="cb71-1412"><a href="#cb71-1412"></a><span class="fu">#### 4.4.2 Crack of Titanium</span></span>
<span id="cb71-1413"><a href="#cb71-1413"></a></span>
<span id="cb71-1414"><a href="#cb71-1414"></a>A manufacturer of Titanium (Ti) Grade has the highest ultimate strength of the pure Ti Grades. It is used in many applications where high strength is required. However, under high stress and high cycle fatigue, it develops cracks that lead to failures. In order to conduct a RDT, the manufacturer machined 10 bars with 0.5" diameter and subjected them to high stress and made notches (of the same dimensions) in all the bars to accelerate the crack growth. The crack length is measured every five days and is recoded for the ten units as shown in Table 6.10. The measurements are expressed in 0.001 mm but scaled for calculation purposes. Determine the number of days when the crack threshold reaches 2mm (1500 in the measurement scale)</span>
<span id="cb71-1415"><a href="#cb71-1415"></a></span>
<span id="cb71-1418"><a href="#cb71-1418"></a><span class="in">```{r}</span></span>
<span id="cb71-1419"><a href="#cb71-1419"></a>ti_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Crack_Length_Data_of_Ten_Bar_of_Ti.csv"</span>)</span>
<span id="cb71-1420"><a href="#cb71-1420"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(ti_dat))</span>
<span id="cb71-1421"><a href="#cb71-1421"></a>ti_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(ti_dat<span class="sc">$</span>Unit)</span>
<span id="cb71-1422"><a href="#cb71-1422"></a><span class="in">```</span></span>
<span id="cb71-1423"><a href="#cb71-1423"></a></span>
<span id="cb71-1426"><a href="#cb71-1426"></a><span class="in">```{r}</span></span>
<span id="cb71-1427"><a href="#cb71-1427"></a>ti_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,crack_length,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb71-1428"><a href="#cb71-1428"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-1429"><a href="#cb71-1429"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-1430"><a href="#cb71-1430"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-1431"><a href="#cb71-1431"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-1432"><a href="#cb71-1432"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-1433"><a href="#cb71-1433"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-1434"><a href="#cb71-1434"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span>
<span id="cb71-1435"><a href="#cb71-1435"></a><span class="in">```</span></span>
<span id="cb71-1436"><a href="#cb71-1436"></a></span>
<span id="cb71-1437"><a href="#cb71-1437"></a><span class="fu">#### 4.4.3 Lithium-ion batteries</span></span>
<span id="cb71-1438"><a href="#cb71-1438"></a></span>
<span id="cb71-1439"><a href="#cb71-1439"></a>Lithium-ion batteries are widely used in many applications and consumer products including electric vehicles because of their high energy density and power capability. However, the long-term performance (capacity to provide the power) decreases with number of charge and discharge cycles. A degradation test is conducted on four battery cells with initial capacities in Ah (Ampere hours, which is defined as is the amount of energy charge in a battery that will allow one ampere of current to flow for one hour). The cells are discharged and charged, and the battery capacity is measured after the accumulation of a number of charge-discharge cycles. The battery is considered failed when its capacity is $80 \%$ of the original capacity. Use the first 25 observations of each cell and develop a general degradation model. Then utilize the model to predict the capacities at the remaining 17 cycles and calculate the error prediction of the models. Note that the original capacity corresponds to zero cycles.</span>
<span id="cb71-1440"><a href="#cb71-1440"></a></span>
<span id="cb71-1443"><a href="#cb71-1443"></a><span class="in">```{r}</span></span>
<span id="cb71-1444"><a href="#cb71-1444"></a>li_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Lithium-ion batteries.csv"</span>)</span>
<span id="cb71-1445"><a href="#cb71-1445"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(li_dat))</span>
<span id="cb71-1446"><a href="#cb71-1446"></a><span class="co"># ti_dat$Unit = as.factor(li_dat$Unit)</span></span>
<span id="cb71-1447"><a href="#cb71-1447"></a><span class="in">```</span></span>
<span id="cb71-1448"><a href="#cb71-1448"></a></span>
<span id="cb71-1451"><a href="#cb71-1451"></a><span class="in">```{r}</span></span>
<span id="cb71-1452"><a href="#cb71-1452"></a>li_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>,Cell<span class="fl">.2</span>,Cell<span class="fl">.3</span>,Cell<span class="fl">.4</span>)) <span class="sc">+</span></span>
<span id="cb71-1453"><a href="#cb71-1453"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.2</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-1454"><a href="#cb71-1454"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.3</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.4</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-1455"><a href="#cb71-1455"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-1456"><a href="#cb71-1456"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-1457"><a href="#cb71-1457"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-1458"><a href="#cb71-1458"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-1459"><a href="#cb71-1459"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-1460"><a href="#cb71-1460"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span>
<span id="cb71-1461"><a href="#cb71-1461"></a><span class="in">```</span></span>
<span id="cb71-1462"><a href="#cb71-1462"></a></span>
<span id="cb71-1463"><a href="#cb71-1463"></a><span class="fu">#### 4.4.4 fatigue crack data</span></span>
<span id="cb71-1464"><a href="#cb71-1464"></a></span>
<span id="cb71-1465"><a href="#cb71-1465"></a><span class="at">&gt; 数据来自： Meeker, W. Q. (1998). Statistical Methods for Reliability Data</span></span>
<span id="cb71-1466"><a href="#cb71-1466"></a></span>
<span id="cb71-1467"><a href="#cb71-1467"></a>Fatigue Crack-Size Data gives the size of fatigue cracks as a function of number of cycles of applied stress for 21 test specimens. The data were collected to obtain information on crack growth rates for the alloy. Usually, we will refer to these data as Alloy-A and assume that a crack of size $1.6$ inches is considered to be a failure.</span>
<span id="cb71-1468"><a href="#cb71-1468"></a></span>
<span id="cb71-1469"><a href="#cb71-1469"></a><span class="al">![](images/Fatigue%20Crack%20Growth%20Data.jpg)</span></span>
<span id="cb71-1470"><a href="#cb71-1470"></a></span>
<span id="cb71-1473"><a href="#cb71-1473"></a><span class="in">```{r}</span></span>
<span id="cb71-1474"><a href="#cb71-1474"></a>fatigue_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Fatigue Crack Growth Data.csv"</span>)</span>
<span id="cb71-1475"><a href="#cb71-1475"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(fatigue_dat))</span>
<span id="cb71-1476"><a href="#cb71-1476"></a>fatigue_dat<span class="sc">$</span>path <span class="ot">=</span> <span class="fu">as.factor</span>(fatigue_dat<span class="sc">$</span>path)</span>
<span id="cb71-1477"><a href="#cb71-1477"></a><span class="in">```</span></span>
<span id="cb71-1478"><a href="#cb71-1478"></a></span>
<span id="cb71-1481"><a href="#cb71-1481"></a><span class="in">```{r}</span></span>
<span id="cb71-1482"><a href="#cb71-1482"></a>fatigue_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,crack,<span class="at">color =</span> path)) <span class="sc">+</span></span>
<span id="cb71-1483"><a href="#cb71-1483"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb71-1484"><a href="#cb71-1484"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-1485"><a href="#cb71-1485"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-1486"><a href="#cb71-1486"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-1487"><a href="#cb71-1487"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb71-1488"><a href="#cb71-1488"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb71-1489"><a href="#cb71-1489"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"cycles"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span>
<span id="cb71-1490"><a href="#cb71-1490"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>