<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="庄亮亮、吴温慧">

<title>退化过程模型综述</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#介绍" id="toc-介绍" class="nav-link active" data-scroll-target="#介绍">1. 介绍</a></li>
  <li><a href="#wiener-退化过程模型" id="toc-wiener-退化过程模型" class="nav-link" data-scroll-target="#wiener-退化过程模型">2. Wiener 退化过程模型</a>
  <ul>
  <li><a href="#统计推断" id="toc-统计推断" class="nav-link" data-scroll-target="#统计推断">2.1 统计推断</a>
  <ul>
  <li><a href="#极大似然估计" id="toc-极大似然估计" class="nav-link" data-scroll-target="#极大似然估计">2.1.1 极大似然估计</a></li>
  <li><a href="#贝叶斯分析" id="toc-贝叶斯分析" class="nav-link" data-scroll-target="#贝叶斯分析">2.1.2 贝叶斯分析</a></li>
  </ul></li>
  <li><a href="#模拟数据分析" id="toc-模拟数据分析" class="nav-link" data-scroll-target="#模拟数据分析">2.2 模拟数据分析</a></li>
  <li><a href="#数据模拟产生" id="toc-数据模拟产生" class="nav-link" data-scroll-target="#数据模拟产生">数据模拟产生</a></li>
  <li><a href="#绘制退化路径图" id="toc-绘制退化路径图" class="nav-link" data-scroll-target="#绘制退化路径图">绘制退化路径图</a></li>
  <li><a href="#极大似然估计-1" id="toc-极大似然估计-1" class="nav-link" data-scroll-target="#极大似然估计-1">极大似然估计</a></li>
  <li><a href="#贝叶斯估计" id="toc-贝叶斯估计" class="nav-link" data-scroll-target="#贝叶斯估计">贝叶斯估计</a></li>
  <li><a href="#可靠度和-rul-计算" id="toc-可靠度和-rul-计算" class="nav-link" data-scroll-target="#可靠度和-rul-计算">可靠度和 RUL 计算</a></li>
  </ul></li>
  <li><a href="#gamma-退化过程模型" id="toc-gamma-退化过程模型" class="nav-link" data-scroll-target="#gamma-退化过程模型">3. Gamma 退化过程模型</a>
  <ul>
  <li><a href="#统计推断-1" id="toc-统计推断-1" class="nav-link" data-scroll-target="#统计推断-1">3.1 统计推断</a>
  <ul>
  <li><a href="#矩估计" id="toc-矩估计" class="nav-link" data-scroll-target="#矩估计">3.1.1 矩估计</a></li>
  <li><a href="#极大似然估计-2" id="toc-极大似然估计-2" class="nav-link" data-scroll-target="#极大似然估计-2">3.1.2 极大似然估计</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#案例分析" id="toc-案例分析" class="nav-link" data-scroll-target="#案例分析">4 案例分析</a>
  <ul>
  <li><a href="#维纳过程相关" id="toc-维纳过程相关" class="nav-link" data-scroll-target="#维纳过程相关">4.1 维纳过程相关</a>
  <ul>
  <li><a href="#nasa-锂电池数据" id="toc-nasa-锂电池数据" class="nav-link" data-scroll-target="#nasa-锂电池数据">4.1.1 NASA 锂电池数据</a></li>
  <li><a href="#激光器件-laser-数据集" id="toc-激光器件-laser-数据集" class="nav-link" data-scroll-target="#激光器件-laser-数据集">4.1.2 激光器件 Laser 数据集</a></li>
  <li><a href="#炭膜电阻器-carbon-film-resistors" id="toc-炭膜电阻器-carbon-film-resistors" class="nav-link" data-scroll-target="#炭膜电阻器-carbon-film-resistors">4.1.3 炭膜电阻器 carbon-film resistors</a></li>
  <li><a href="#惯导平台-interial-navigition-数据" id="toc-惯导平台-interial-navigition-数据" class="nav-link" data-scroll-target="#惯导平台-interial-navigition-数据">4.1.4 惯导平台 interial navigition 数据</a></li>
  <li><a href="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" id="toc-铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="nav-link" data-scroll-target="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">4.1.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</a></li>
  </ul></li>
  <li><a href="#伽马过程相关" id="toc-伽马过程相关" class="nav-link" data-scroll-target="#伽马过程相关">伽马过程相关</a>
  <ul>
  <li><a href="#wear-data" id="toc-wear-data" class="nav-link" data-scroll-target="#wear-data">4.4.1 wear data</a></li>
  <li><a href="#crack-of-titanium" id="toc-crack-of-titanium" class="nav-link" data-scroll-target="#crack-of-titanium">4.4.2 Crack of Titanium</a></li>
  <li><a href="#lithium-ion-batteries" id="toc-lithium-ion-batteries" class="nav-link" data-scroll-target="#lithium-ion-batteries">4.4.3 Lithium-ion batteries</a></li>
  <li><a href="#fatigue-crack-data" id="toc-fatigue-crack-data" class="nav-link" data-scroll-target="#fatigue-crack-data">4.4.4 fatigue crack data</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">退化过程模型综述</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>庄亮亮、吴温慧 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="介绍" class="level2">
<h2 class="anchored" data-anchor-id="介绍">1. 介绍</h2>
<p>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在<strong>基于退化的可靠性模型</strong>方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</p>
<ol type="1">
<li><p>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</p></li>
<li><p>基于 Wiener 过程的模型</p></li>
<li><p>基于 Gamma 过程的模型</p></li>
<li><p>基于逆高斯过程的模型</p></li>
</ol>
<p>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究<strong>矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法</strong>，以及<strong>非参数和半参数方法</strong>等，解决模型辨识和修正问题;</p>
<p>采用<strong>似然比检验、Bayes 因子分析</strong>等方法进行模型验证;</p>
<p>采用<strong>均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)</strong>等进行模型优良性检验。</p>
<p>在基于退化的可靠性技术应用方面，针对<strong>机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）</strong>等的退化失效过程，开展<strong>退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计</strong>：特别是加速退化试验方案设计的研究。</p>
</section>
<section id="wiener-退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="wiener-退化过程模型">2. Wiener 退化过程模型</h2>
<p>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中应用最为广泛的一种模型。Wiener 退化过程的<strong>首达时间分布具有解析形式</strong>，便于对<strong>产品寿命</strong>和<strong>可靠度</strong>的分析和计算。</p>
<p>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</p>
<p>通过对经典 Wiener 过程的参数引入<strong>随机性</strong>，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</p>
<blockquote class="blockquote">
<p>对 Wiener 退化过程及其观测过程所构成的<strong>状态空间模型</strong>，可以采用 <strong>Kalman 滤波技术</strong>进行处理，为产品<strong>在线寿命预测、视情维修决策</strong>等提供了可行的算法和实现途径。</p>
</blockquote>
<p>称 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是漂移参数为 <span class="math inline">\(\mu\)</span> 、扩散参数为 <span class="math inline">\(\sigma\)</span> 的 (一元) Wiener 过程, 若</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span>。</p></li>
<li><p><span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 有平稳独立增量。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 服从均值为 <span class="math inline">\(\mu t\)</span>，方差为 <span class="math inline">\(\sigma^2 t\)</span> 的正态分布。</p></li>
</ol>
<p>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: <span class="math display">\[
X(t)=\mu t+\sigma B(t)
\]</span> 式中: <span class="math inline">\(\{B(t)\}, t \geqslant 0\)</span> 是标准 Wiener 过程或标准布朗运动过程。</p>
<p>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</p>
<p>（1）时刻 <span class="math inline">\(t \sim t+\Delta t\)</span> 之间的增量服从正态分布, 即 <span class="math inline">\(\Delta X=X(t+\Delta t)-X(t) \sim\)</span> <span class="math inline">\(N\left(\mu \Delta t, \sigma^2 \Delta t\right)\)</span> 。</p>
<p>（2）对任意两个不相交的时间区间 <span class="math inline">\(\left[t_1, t_2\right],\left[t_3, t_4\right], t_1&lt;t_2 \leqslant t_3&lt;t_4\)</span>, 增量 <span class="math inline">\(X\left(t_4\right)-X\)</span> <span class="math inline">\(\left(t_3\right)\)</span> 与 <span class="math inline">\(X\left(t_2\right)-X\left(t_1\right)\)</span> 相互独立。</p>
<p><strong>可靠度</strong></p>
<p>如果产品的性能退化过程是一元 Wiener 过程，失效阈值为<span class="math inline">\(l\)</span>。 则可靠度为 <span class="math display">\[
R(t)= 1-F(t ; \mu, \sigma)=\Phi\left(\frac{l-\mu t}{\sigma \sqrt{t}}\right)-\exp \left(\frac{2 \mu l}{\sigma^2}\right) \Phi\left(\frac{-l-\mu t}{\sigma \sqrt{t}}\right)
\]</span></p>
<p><strong>剩余使用寿命</strong></p>
<p>假设其运行到时刻 <span class="math inline">\(\tau\)</span> 仍末失效, 且当前性能退化量为 <span class="math inline">\(x_\tau\left(x_\tau&lt;l\right)\)</span>, 则产品的剩余寿命 <span class="math inline">\(T_1\)</span> 可以表示为 <span class="math display">\[
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
\]</span> 由一元 Wiener 过程的独立增量性质和齐次马尔可夫性得到 <span class="math display">\[
\begin{aligned}
T_1 &amp;=\inf \left\{t \mid X(t+\tau)-X(\tau) \geqslant l-x_\tau, t \geqslant 0\right\} \\
&amp;=\inf \left\{t \mid X(t) \geqslant l-x_\tau, t \geqslant 0\right\}
\end{aligned}
\]</span> 可知剩余寿命 <span class="math inline">\(T_1\)</span> 也是逆 Gaussian 分布, 其密度函数只需将寿命 <span class="math inline">\(T\)</span> 密度函数中的失效阈值 <span class="math inline">\(l\)</span> 替换为 <span class="math inline">\(l-x_\tau\)</span>, 即 <span class="math display">\[f_{T_1}(t)=\frac{l-x_\tau}{\sqrt{2 \pi \sigma^2 t^3}} \exp \left[-\frac{\left(l-x_\tau-\mu t\right)^2}{2 \sigma^2 t}\right]\]</span></p>
<section id="统计推断" class="level3">
<h3 class="anchored" data-anchor-id="统计推断">2.1 统计推断</h3>
<p>假设共有 <span class="math inline">\(n\)</span> 个样品进行性能退化试验。样品 <span class="math inline">\(i\)</span> 初始时刻 <span class="math inline">\(t_{i 0}\)</span> 退化量取值为 <span class="math inline">\(X_{i 0}=0\)</span>, 在 时刻 <span class="math inline">\(t_{i 1}, \cdots, t_{i m_i}\)</span> 样品 <span class="math inline">\(i\)</span> 退化量为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span> 。记 <span class="math inline">\(\Delta X_{i j}=X_{i j}-X_{i, j-1}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{i, j-1} \sim t_{i j}\)</span> 之间的退化增量, <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 为各样品的测量间隔。</p>
<section id="极大似然估计" class="level4">
<h4 class="anchored" data-anchor-id="极大似然估计">2.1.1 极大似然估计</h4>
<!-- 在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。 -->
<p>由 Wiener 过程的性质, 容易知道 <span class="math display">\[
\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)
\]</span></p>
<p>于是由退化数据 <span class="math inline">\(X_{i j}=x_{i j}\)</span> <span class="math inline">\(j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span>, 得到模型参数的似然函数为 <span class="math display">\[
L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left[-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right]
\]</span> 由式可以直接求得漂移参数 <span class="math inline">\(\mu\)</span> 和扩散参数 <span class="math inline">\(\sigma^2\)</span> 的极大似然估计如下: <span class="math display">\[
\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left[\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right]
\]</span></p>
</section>
<section id="贝叶斯分析" class="level4">
<h4 class="anchored" data-anchor-id="贝叶斯分析">2.1.2 贝叶斯分析</h4>
<!-- 基于 rstan 进行贝叶斯估计。详细的参考文献如下： -->
<!-- -   最新、入门级别 [rstan](https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html) 资料。 -->
<!-- -   [官网资料](https://mc-stan.org/users/interfaces/rstan) -->
<p>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),\\
&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),\\
&amp; \mu|w \sim N(d,\frac{c}{w}).
\end{aligned}
\]</span></p>
<p>其中，<span class="math inline">\(a = b = 1, d = 0, c =100\)</span>。</p>
<ul>
<li>数据准备</li>
</ul>
<p>准备<span class="math inline">\(\Delta t_{ij}\)</span> 和 <span class="math inline">\(\Delta x_{ij}\)</span>的数据，并且标志出矩阵的维数。</p>
<ul>
<li>构建模型（<code>wiener_linear.stan</code>）</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a>data {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb1-3"><a href="#cb1-3"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb1-4"><a href="#cb1-4"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb1-5"><a href="#cb1-5"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb1-6"><a href="#cb1-6"></a>}</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>parameters {</span>
<span id="cb1-9"><a href="#cb1-9"></a>  real mu;</span>
<span id="cb1-10"><a href="#cb1-10"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>model {</span>
<span id="cb1-14"><a href="#cb1-14"></a>  w ~ gamma(1,1);</span>
<span id="cb1-15"><a href="#cb1-15"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb1-16"><a href="#cb1-16"></a>  for (i in 1:I){</span>
<span id="cb1-17"><a href="#cb1-17"></a>    for (j in 1:J) {</span>
<span id="cb1-18"><a href="#cb1-18"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb1-19"><a href="#cb1-19"></a>    }</span>
<span id="cb1-20"><a href="#cb1-20"></a>  }</span>
<span id="cb1-21"><a href="#cb1-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="模拟数据分析" class="level3">
<h3 class="anchored" data-anchor-id="模拟数据分析">2.2 模拟数据分析</h3>
</section>
<section id="数据模拟产生" class="level3">
<h3 class="anchored" data-anchor-id="数据模拟产生">数据模拟产生</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb2-5"><a href="#cb2-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.001971</td>
<td style="text-align: right;">1.465440</td>
<td style="text-align: right;">2.378471</td>
<td style="text-align: right;">0.4928235</td>
<td style="text-align: right;">2.320860</td>
<td style="text-align: right;">1.734249</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.401856</td>
<td style="text-align: right;">1.490439</td>
<td style="text-align: right;">3.681339</td>
<td style="text-align: right;">-0.7451053</td>
<td style="text-align: right;">2.619837</td>
<td style="text-align: right;">1.324379</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.374835</td>
<td style="text-align: right;">3.351536</td>
<td style="text-align: right;">5.247479</td>
<td style="text-align: right;">-0.4312110</td>
<td style="text-align: right;">5.572412</td>
<td style="text-align: right;">3.619365</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5.383691</td>
<td style="text-align: right;">4.127350</td>
<td style="text-align: right;">7.505240</td>
<td style="text-align: right;">-0.9256635</td>
<td style="text-align: right;">6.446643</td>
<td style="text-align: right;">4.267378</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4.015560</td>
<td style="text-align: right;">4.446789</td>
<td style="text-align: right;">9.477815</td>
<td style="text-align: right;">1.0783003</td>
<td style="text-align: right;">6.034852</td>
<td style="text-align: right;">7.121497</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">plot_path</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="绘制退化路径图" class="level3">
<h3 class="anchored" data-anchor-id="绘制退化路径图">绘制退化路径图</h3>
</section>
<section id="极大似然估计-1" class="level3">
<h3 class="anchored" data-anchor-id="极大似然估计-1">极大似然估计</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb4-2"><a href="#cb4-2"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># mle_re</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># 区间估计</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">low</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">up</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.873</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.985</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.030</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="贝叶斯估计" class="level3">
<h3 class="anchored" data-anchor-id="贝叶斯估计">贝叶斯估计</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># 数据准备</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb5-5"><a href="#cb5-5"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb5-13"><a href="#cb5-13"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># 后验抽样</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">library</span>(rstan)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>输出各个参数的后验估计结果并进行绘制。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">print</span>(fit1,</span>
<span id="cb7-2"><a href="#cb7-2"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inference for Stan model: wiener_linear.
1 chains, each with iter=2000; warmup=1000; thin=1; 
post-warmup draws per chain=1000, total post-warmup draws=1000.

        mean se_mean   sd     10%     50%     90% n_eff Rhat
mu      0.93    0.00 0.03    0.89    0.93    0.97  1015 1.00
w       1.01    0.00 0.02    0.98    1.01    1.04   924 1.00
lp__ -591.91    0.05 0.97 -593.10 -591.63 -591.05   430 1.01

Samples were drawn using NUTS(diag_e) at Sat Feb 18 17:31:28 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">plot</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb10-2"><a href="#cb10-2"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb10-3"><a href="#cb10-3"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>可以看出，效果较好。真实值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.25\)</span>，估计值为：<span class="math inline">\(\mu = 2,w = 1 / \sigma^2 = 0.5\)</span>。 估计值的<span class="math inline">\(\sigma^2\)</span> 有些问题，应该如何处理？</p>
</section>
<section id="可靠度和-rul-计算" class="level3">
<h3 class="anchored" data-anchor-id="可靠度和-rul-计算">可靠度和 RUL 计算</h3>
<p>这里以MLE的参数估计值作为案例。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb11-3"><a href="#cb11-3"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">return</span>(R)</span>
<span id="cb11-5"><a href="#cb11-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb12-4"><a href="#cb12-4"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb12-5"><a href="#cb12-5"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="gamma-退化过程模型" class="level1">
<h1>3. Gamma 退化过程模型</h1>
<p>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。 当产品的退化过程是严格单调非负时, Wiener 过程不再适用。Gamma 过程具有独立非负增量,可以对该类退化过程进行建模。</p>
<p>称连续时间随机过程 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是平稳 Gamma 过程 <span class="math inline">\({ }^{[2]}\)</span>, 若它满足以下性质:</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span> 以概率 1 成立。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 具有平稳独立增量。</p></li>
<li><p>对任意 <span class="math inline">\(t \geqslant 0\)</span> 和 <span class="math inline">\(\Delta t, X(t+\Delta t)-X(t) \sim G a(\alpha \Delta t, \beta)\)</span> 。</p>
<p>其中 <span class="math inline">\(G a(\alpha, \beta)\)</span> 是形状参数为 <span class="math inline">\(\alpha&gt;0\)</span> 、尺度参数为 <span class="math inline">\(\beta&gt;0\)</span> 的 Gamma 分布, 分布密度函数为 <span class="math display">\[
f(x \mid \alpha, \beta)=\frac{1}{\Gamma(\alpha) \beta^\alpha} \alpha^{\alpha-1} \mathrm{e}^{-x / \beta} I_{(0, \infty)}(x)
\]</span> 并且 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 称为形状参数为 <span class="math inline">\(\alpha&gt;0\)</span> 、尺度参数为 <span class="math inline">\(\beta&gt;0\)</span> 的平稳 Gamma 过程。</p></li>
</ol>
<p><strong>产品寿命</strong></p>
<p>因为Gamma 过程的退化是单调递增的，即<span class="math inline">\(X(t) \sim Ga(\alpha t,\beta)\)</span> ,因此<strong>产品寿命</strong>的分布可以直接通过退化量的转换获得。当给定产品退化失效阈值 <span class="math inline">\(\ell\)</span> 时，产品寿命 <span class="math inline">\(T\)</span> 的CDF和PDF为</p>
<p><span class="math display">\[
\begin{aligned}
{F}_{{T}}(t) &amp;={P}({T} \leqslant {t})={P}({X}({t}) \geqslant \ell) \\
&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha {t}) \beta^{\alpha {t}}} {x}^{\alpha {t}-1} \mathrm{e}^{-\frac{{x}}{\beta}} {dx} \\
&amp;=\frac{1}{\Gamma(\alpha {t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi ,\\
{f}_{{T}}(t) &amp;=\frac{{d}}{{dt}} \frac{\Gamma(\alpha {t}, 1 / \beta)}{\Gamma(\alpha {t})} \\
&amp;=\frac{\alpha}{\Gamma(\alpha {t})} \int_0^{\nu / \beta}\left[\ln (\xi)-\frac{\Gamma^{\prime}(\alpha {t})}{\Gamma(\alpha {t})}\right] \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi.
\end{aligned}
\]</span></p>
<p>由于<span class="math inline">\({f}_{{T}}({t})\)</span> 相当复杂，因此一般用B-S分布来逼近：</p>
<p><span class="math display">\[
{F}(t ; \ell)=\Phi\left[\frac{1}{{v}}\left(\sqrt{\frac{{t}}{{u}}}-\sqrt{\frac{{u}}{{t}}}\right)\right], \quad {t}&gt;0.
\]</span> 其中，<span class="math inline">\(\Phi(\cdot)\)</span> 为标准正态分布，<span class="math inline">\(v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}\)</span>. 相应的 PDF 为 <span class="math display">\[
{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} {uv}}\left[\left(\frac{{u}}{{t}}\right)^{\frac{1}{2}}+\left(\frac{{u}}{{t}}\right)^{\frac{3}{2}}\right] \exp \left[-\frac{1}{2 {v}^2}\left(\frac{{t}}{{u}}-2+\frac{{u}}{{t}}\right)\right], {t}&gt;0.
\]</span></p>
<p><strong>剩余寿命</strong></p>
<p>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 <span class="math display">\[
\begin{aligned}
{F}(t \mid s) &amp;={P}\left({T} \leqslant t \mid {X}(s)={x}_{s}\right) \\
&amp;={P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) \\
&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .
\end{aligned}
\]</span> 这与将失效阈值由 <span class="math inline">\(\ell\)</span> 变为 <span class="math inline">\(\ell-{x_s}\)</span> 、时间 <span class="math inline">\(t\)</span> 变为 <span class="math inline">\(t-s\)</span> 情形的寿命分布是一样的. 因此，在给定当前状态情况下，可以按照类似的途径更新剩余寿命.</p>
<section id="统计推断-1" class="level3">
<h3 class="anchored" data-anchor-id="统计推断-1">3.1 统计推断</h3>
<p>假设共有 <span class="math inline">\({n}\)</span> 个样品进行性能退化试验. 对于样品 <span class="math inline">\(i\)</span>, 初始时刻 <span class="math inline">\(t_0\)</span> 性能退化量为 <span class="math inline">\(X_{i 0}=0\)</span>, 在时刻 <span class="math inline">\(t_1, \cdots, t_{m_i}\)</span> 测量产品的性能退化量, 得到其测量值为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span>. 记 <span class="math inline">\(\Delta x_{i j}=X_{i j}-X_{i(j-1)}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{j-1}\)</span> 和 <span class="math inline">\(t_j\)</span> 之间的性能退化量, 由 Gamma 过程的独立增量性得到<span class="math inline">\(\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)\)</span>。</p>
<section id="矩估计" class="level4">
<h4 class="anchored" data-anchor-id="矩估计">3.1.1 矩估计</h4>
<p>令 <span class="math inline">\(R_{i j}=\Delta X_{i j} / \Delta t_{i j}\)</span>, 则诸 <span class="math inline">\(R_{i j}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 服从形状参数为 <span class="math inline">\(\alpha\)</span> 、尺度参数为 <span class="math inline">\(\beta\)</span> 的 Gamma 分布, 且相互独立(根据 Gamma 过程独立增量特性, 以及各样品退化过程的独立性)。记 <span class="math inline">\(M=\sum_{i=1}^n m_i\)</span>, 样本均值和样本方差为 <span class="math display">\[
\begin{align}
\bar{R}&amp; =\frac{1}{M} \sum_{i=1}^n \sum_{j=1}^{m_i} R_{i j} \\
S_R^2 &amp; =\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left[R_{i j}-\bar{R}\right]^2
\end{align}
\]</span> 易知 <span class="math display">\[
\begin{aligned}
E[\bar{R}] &amp;=\alpha \beta \\
Var[\bar{R}]&amp;=\frac{1}{M^2} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right]\\
\end{aligned}
\]</span> 所以，</p>
<p><span class="math display">\[
\begin{aligned}
E\left[S_R^2\right]&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left[R_{i j}-\bar{R}\right]^2\\
&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left[R_{i j}-\alpha \beta-(\bar{R}-\alpha \beta)\right]^2 \\
&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left\{Var\left[R_{i j}\right]^2-\frac{2}{m_i} Var\left[R_{i j}\right]+ Var[\bar{R}]\right\} \\
&amp;=\frac{1}{M-1} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left[\frac{1}{\Delta t_{i j}}\right]
\end{aligned}
\]</span> 将待估参数和样本矩联系起来, 即令 <span class="math display">\[
\left\{\begin{array}{l}
\alpha \beta=\bar{R} \\
\alpha \beta^2=M S_R^2 / \sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right]
\end{array}\right.
\]</span> 可得如下矩估计: <span class="math display">\[
\begin{gathered}
\hat{\alpha}=\frac{\sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right] \bar{R}^2}{M S_R^2} \\
\hat{\beta}=\frac{M S_R^2}{\sum_{i=1}^n \sum_{j=1}^{m_i}\left[1 / \Delta t_{i j}\right] \bar{R}}
\end{gathered}
\]</span></p>
<p>上述矩估计方法是基于退化速率的，金光还给出了基于退化量的矩估计（详见P128）,注意到当测量间隔都相同时，两个矩估计方法相同。</p>
</section>
<section id="极大似然估计-2" class="level4">
<h4 class="anchored" data-anchor-id="极大似然估计-2">3.1.2 极大似然估计</h4>
<p>由 Gamma 过程独立增量特性, 以及 <span class="math display">\[
\Delta X_{i j} \sim G a\left(\alpha \Delta t_{i j}, \beta\right)=\frac{\left(\Delta x_{i j} / \beta\right)^{\alpha \Delta t_{i j}-1}}{\beta \Gamma\left(\alpha \Delta t_{i j}\right)} \mathrm{e}^{-\Delta x_{i j} / \beta}
\]</span> 可以获得对数似然函数为 <span class="math display">\[
l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)
\]</span> 由极大似然估计原理, 令 <span class="math display">\[
\left\{\begin{array}{l}
\frac{\partial l}{\partial \alpha}=\sum_{i=1}^n \sum_{j=1}^{m_i} \Delta t_{i j}\left(\ln x_{i j}-\psi\left(\alpha \Delta t_{i j}\right)-\ln \beta\right)=0 \\
\frac{\partial l}{\partial \beta}=\sum_{i=1}^n\left(\frac{x_{i m_i}}{\beta^2}-\frac{\alpha t_{i m_i}}{\beta}\right)=0
\end{array}\right.
\]</span> 式中 <span class="math inline">\(\psi(u)\)</span> 是 digamma 函数。 <span class="math display">\[
\begin{aligned}
&amp;\hat{\beta}=\frac{\sum_{i=1}^n X_{i m_i}}{\alpha \sum_{i=1}^n t_{i m_i}}\\
&amp;\sum_{i=1}^n\left[\sum_{j=1}^{m_i} \Delta t_{i j} \ln \left(\Delta x_{i j}\right)-t_{i m_i} \ln \frac{x_{i m_i}}{\alpha t_{i m_i}}-\sum_{j=1}^{m_i} \Delta t_{i j} \psi\left(\alpha \Delta t_{i j}\right)\right]=0
\end{aligned}
\]</span></p>
</section>
</section>
</section>
<section id="案例分析" class="level1">
<h1>4 案例分析</h1>
<section id="维纳过程相关" class="level2">
<h2 class="anchored" data-anchor-id="维纳过程相关">4.1 维纳过程相关</h2>
<section id="nasa-锂电池数据" class="level3">
<h3 class="anchored" data-anchor-id="nasa-锂电池数据">4.1.1 NASA 锂电池数据</h3>
<blockquote class="blockquote">
<p>数据来源于<a href="https://c3.ndc.nasa.gov/dashlink/resources/133/">NASA Ames Prognostics Center of Excellence (PCoE)</a>，但是找不到数据下载。最后是通过 <a href="https://github.com/psanabriaUC/BatteryDatasetImplementation">Github</a> 获得。</p>
</blockquote>
<p>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即<strong>充电</strong>、<strong>放电</strong>和<strong>测量 EIS</strong>。</p>
<p>充电是以<strong>恒流模</strong>式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以<strong>恒压模式</strong>(CV)继续充电直到电流降到 20mA。</p>
<p>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</p>
<p>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Voltage_measured</th>
<th style="text-align: right;">Current_measured</th>
<th style="text-align: right;">Temperature_measured</th>
<th style="text-align: right;">Current_charge</th>
<th style="text-align: right;">Voltage_charge</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Capacity</th>
<th style="text-align: right;">id_cycle</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">ambient_temperature</th>
<th style="text-align: right;">time</th>
<th style="text-align: left;">Battery</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.974871</td>
<td style="text-align: right;">-2.012528</td>
<td style="text-align: right;">24.38909</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.062</td>
<td style="text-align: right;">35.703</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.951717</td>
<td style="text-align: right;">-2.013979</td>
<td style="text-align: right;">24.54475</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.030</td>
<td style="text-align: right;">53.781</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.934353</td>
<td style="text-align: right;">-2.011144</td>
<td style="text-align: right;">24.73139</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.011</td>
<td style="text-align: right;">71.922</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.920058</td>
<td style="text-align: right;">-2.013007</td>
<td style="text-align: right;">24.90982</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.991</td>
<td style="text-align: right;">90.094</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.907904</td>
<td style="text-align: right;">-2.014400</td>
<td style="text-align: right;">25.10588</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.977</td>
<td style="text-align: right;">108.281</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.897036</td>
<td style="text-align: right;">-2.011603</td>
<td style="text-align: right;">25.31702</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.967</td>
<td style="text-align: right;">126.453</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb17-2"><a href="#cb17-2"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb19-2"><a href="#cb19-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb19-4"><a href="#cb19-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003751909 0.017612386</code></pre>
</div>
</div>
<p>计算可靠度并绘图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6048919 0.9074667 0.6817691 0.6014642</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb23-5"><a href="#cb23-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb23-6"><a href="#cb23-6"></a>}</span>
<span id="cb23-7"><a href="#cb23-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb23-8"><a href="#cb23-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb23-10"><a href="#cb23-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb23-11"><a href="#cb23-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb23-12"><a href="#cb23-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb23-15"><a href="#cb23-15"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="激光器件-laser-数据集" class="level3">
<h3 class="anchored" data-anchor-id="激光器件-laser-数据集">4.1.2 激光器件 Laser 数据集</h3>
<blockquote class="blockquote">
<p>数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</p>
</blockquote>
<p>激光器件的质量特征是其<strong>工作电流</strong>。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9255</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1147</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7168</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5110</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1250</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb28-2"><a href="#cb28-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb28-4"><a href="#cb28-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00203768 0.01268431</code></pre>
</div>
</div>
<p>计算可靠度并绘图，阈值设置参考 Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety <strong>193</strong>. 第6节案例分析</p>
<p>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</p>
<blockquote class="blockquote">
<p>可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3995107</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb32-5"><a href="#cb32-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb32-6"><a href="#cb32-6"></a>}</span>
<span id="cb32-7"><a href="#cb32-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb32-8"><a href="#cb32-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb32-10"><a href="#cb32-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb32-11"><a href="#cb32-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb32-12"><a href="#cb32-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="炭膜电阻器-carbon-film-resistors" class="level3">
<h3 class="anchored" data-anchor-id="炭膜电阻器-carbon-film-resistors">4.1.3 炭膜电阻器 carbon-film resistors</h3>
<blockquote class="blockquote">
<p>退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</p>
</blockquote>
<p>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</p>
<p>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Percent.Increase</th>
<th style="text-align: left;">Resistor.ID</th>
<th style="text-align: right;">DegreesC</th>
<th style="text-align: right;">Thousands.of.Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.32</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.38</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">4.341</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">8.084</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.22</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb35-2"><a href="#cb35-2"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>后续参数估计和可靠度估计就先不做了。</p>
<p>类似的数据集还包括：</p>
</section>
<section id="惯导平台-interial-navigition-数据" class="level3">
<h3 class="anchored" data-anchor-id="惯导平台-interial-navigition-数据">4.1.4 惯导平台 interial navigition 数据</h3>
<blockquote class="blockquote">
<p>数据来自于文献：Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability <strong>61</strong>(1): 50-67.</p>
</blockquote>
<p>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</p>
<p>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</p>
<p>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</p>
<p><img src="images/paste-40CEA295.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
<th style="text-align: right;">Item5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.0507</td>
<td style="text-align: right;">0.1300</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.1052</td>
<td style="text-align: right;">0.0928</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">0.1789</td>
<td style="text-align: right;">0.2554</td>
<td style="text-align: right;">0.0309</td>
<td style="text-align: right;">0.1996</td>
<td style="text-align: right;">0.2633</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0.2059</td>
<td style="text-align: right;">0.3153</td>
<td style="text-align: right;">0.0077</td>
<td style="text-align: right;">0.2927</td>
<td style="text-align: right;">0.3010</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">0.2548</td>
<td style="text-align: right;">0.3966</td>
<td style="text-align: right;">0.1510</td>
<td style="text-align: right;">0.3060</td>
<td style="text-align: right;">0.3515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">0.3117</td>
<td style="text-align: right;">0.2424</td>
<td style="text-align: right;">0.1162</td>
<td style="text-align: right;">0.2860</td>
<td style="text-align: right;">0.2818</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">0.5236</td>
<td style="text-align: right;">0.3473</td>
<td style="text-align: right;">0.0237</td>
<td style="text-align: right;">0.2918</td>
<td style="text-align: right;">0.4375</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb37-3"><a href="#cb37-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-16"><a href="#cb37-16"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="level3">
<h3 class="anchored" data-anchor-id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">4.1.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</h3>
<blockquote class="blockquote">
<p>数据来自： (Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability 61(1): 50-67).</p>
</blockquote>
<p>它是飞机上常用的金属材料，这种材料的完整性通过<strong>疲劳裂纹的长度</strong>来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</p>
<p>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。<strong>退化过程存在非线性</strong>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Cycle</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb39-3"><a href="#cb39-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb39-4"><a href="#cb39-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a></span>
<span id="cb39-6"><a href="#cb39-6"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb39-12"><a href="#cb39-12"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-15"><a href="#cb39-15"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="伽马过程相关" class="level2">
<h2 class="anchored" data-anchor-id="伽马过程相关">伽马过程相关</h2>
<section id="wear-data" class="level4">
<h4 class="anchored" data-anchor-id="wear-data">4.4.1 wear data</h4>
<blockquote class="blockquote">
<p>数据来自： Ye Z.S., et al.&nbsp;(2014). “Semiparametric Estimation of Gamma Processes for Deteriorating Products” Technometrics</p>
</blockquote>
<p>Wear of a tire tread is a major cause of tire failures. To assess the wear behavior of a batch of tire treads from a factory, a bus park in South Korea sampled some tires installed on buses of the same version. Degradation level of each tire was measured, and its time in service (in thousands of kilometers) was retrospected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>wear_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/wear data.csv"</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wear_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">wear</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.3</td>
<td style="text-align: right;">6.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">46.5</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">47.1</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">48.1</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">49.0</td>
<td style="text-align: right;">6.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">49.7</td>
<td style="text-align: right;">5.8</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>wear_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(wear_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>wear_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,wear,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="crack-of-titanium" class="level4">
<h4 class="anchored" data-anchor-id="crack-of-titanium">4.4.2 Crack of Titanium</h4>
<p>A manufacturer of Titanium (Ti) Grade has the highest ultimate strength of the pure Ti Grades. It is used in many applications where high strength is required. However, under high stress and high cycle fatigue, it develops cracks that lead to failures. In order to conduct a RDT, the manufacturer machined 10 bars with 0.5” diameter and subjected them to high stress and made notches (of the same dimensions) in all the bars to accelerate the crack growth. The crack length is measured every five days and is recoded for the ten units as shown in Table 6.10. The measurements are expressed in 0.001 mm but scaled for calculation purposes. Determine the number of days when the crack threshold reaches 2mm (1500 in the measurement scale)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>ti_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Crack_Length_Data_of_Ten_Bar_of_Ti.csv"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(ti_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">crack_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">218</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">311</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">410</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">507</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">605</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>ti_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(ti_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>ti_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,crack_length,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="lithium-ion-batteries" class="level4">
<h4 class="anchored" data-anchor-id="lithium-ion-batteries">4.4.3 Lithium-ion batteries</h4>
<p>Lithium-ion batteries are widely used in many applications and consumer products including electric vehicles because of their high energy density and power capability. However, the long-term performance (capacity to provide the power) decreases with number of charge and discharge cycles. A degradation test is conducted on four battery cells with initial capacities in Ah (Ampere hours, which is defined as is the amount of energy charge in a battery that will allow one ampere of current to flow for one hour). The cells are discharged and charged, and the battery capacity is measured after the accumulation of a number of charge-discharge cycles. The battery is considered failed when its capacity is <span class="math inline">\(80 \%\)</span> of the original capacity. Use the first 25 observations of each cell and develop a general degradation model. Then utilize the model to predict the capacities at the remaining 17 cycles and calculate the error prediction of the models. Note that the original capacity corresponds to zero cycles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>li_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Lithium-ion batteries.csv"</span>)</span>
<span id="cb46-2"><a href="#cb46-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(li_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">cycles</th>
<th style="text-align: right;">Cell.1</th>
<th style="text-align: right;">Cell.2</th>
<th style="text-align: right;">Cell.3</th>
<th style="text-align: right;">Cell.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.543</td>
<td style="text-align: right;">2.532</td>
<td style="text-align: right;">2.525</td>
<td style="text-align: right;">2.496</td>
</tr>
<tr class="even">
<td style="text-align: right;">150</td>
<td style="text-align: right;">2.497</td>
<td style="text-align: right;">2.495</td>
<td style="text-align: right;">2.487</td>
<td style="text-align: right;">2.466</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">2.466</td>
<td style="text-align: right;">2.467</td>
<td style="text-align: right;">2.463</td>
<td style="text-align: right;">2.438</td>
</tr>
<tr class="even">
<td style="text-align: right;">450</td>
<td style="text-align: right;">2.453</td>
<td style="text-align: right;">2.452</td>
<td style="text-align: right;">2.447</td>
<td style="text-align: right;">2.435</td>
</tr>
<tr class="odd">
<td style="text-align: right;">600</td>
<td style="text-align: right;">2.428</td>
<td style="text-align: right;">2.424</td>
<td style="text-align: right;">2.412</td>
<td style="text-align: right;">2.399</td>
</tr>
<tr class="even">
<td style="text-align: right;">750</td>
<td style="text-align: right;">2.400</td>
<td style="text-align: right;">2.400</td>
<td style="text-align: right;">2.393</td>
<td style="text-align: right;">2.376</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># ti_dat$Unit = as.factor(li_dat$Unit)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>li_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>,Cell<span class="fl">.2</span>,Cell<span class="fl">.3</span>,Cell<span class="fl">.4</span>)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.2</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.3</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.4</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fatigue-crack-data" class="level4">
<h4 class="anchored" data-anchor-id="fatigue-crack-data">4.4.4 fatigue crack data</h4>
<blockquote class="blockquote">
<p>数据来自： Meeker, W. Q. (1998). Statistical Methods for Reliability Data</p>
</blockquote>
<p>Fatigue Crack-Size Data gives the size of fatigue cracks as a function of number of cycles of applied stress for 21 test specimens. The data were collected to obtain information on crack growth rates for the alloy. Usually, we will refer to these data as Alloy-A and assume that a crack of size <span class="math inline">\(1.6\)</span> inches is considered to be a failure.</p>
<p><img src="images/Fatigue%20Crack%20Growth%20Data.jpg" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>fatigue_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Fatigue Crack Growth Data.csv"</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(fatigue_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">path</th>
<th style="text-align: right;">cycles</th>
<th style="text-align: right;">crack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>fatigue_dat<span class="sc">$</span>path <span class="ot">=</span> <span class="fu">as.factor</span>(fatigue_dat<span class="sc">$</span>path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>fatigue_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,crack,<span class="at">color =</span> path)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"cycles"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb52" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb52-1"><a href="#cb52-1"></a><span class="co">---</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="an">title:</span><span class="co"> "退化过程模型综述"</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="an">author:</span><span class="co"> "庄亮亮、吴温慧"</span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="co">  html:</span></span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="co">    toc: TRUE</span></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="co">    toc-title: "目录"</span></span>
<span id="cb52-9"><a href="#cb52-9"></a><span class="co">    theme: cerulean</span></span>
<span id="cb52-10"><a href="#cb52-10"></a><span class="co">    code-tools: true</span></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="co">    highlight-style: cerulean.theme</span></span>
<span id="cb52-12"><a href="#cb52-12"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb52-13"><a href="#cb52-13"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb52-14"><a href="#cb52-14"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb52-15"><a href="#cb52-15"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb52-16"><a href="#cb52-16"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb52-17"><a href="#cb52-17"></a><span class="co">---</span></span>
<span id="cb52-18"><a href="#cb52-18"></a></span>
<span id="cb52-19"><a href="#cb52-19"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb52-20"><a href="#cb52-20"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-21"><a href="#cb52-21"></a><span class="in">```</span></span>
<span id="cb52-22"><a href="#cb52-22"></a></span>
<span id="cb52-23"><a href="#cb52-23"></a><span class="fu">## 1. 介绍</span></span>
<span id="cb52-24"><a href="#cb52-24"></a></span>
<span id="cb52-25"><a href="#cb52-25"></a>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在**基于退化的可靠性模型**方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</span>
<span id="cb52-26"><a href="#cb52-26"></a></span>
<span id="cb52-27"><a href="#cb52-27"></a><span class="ss">1.  </span>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</span>
<span id="cb52-28"><a href="#cb52-28"></a></span>
<span id="cb52-29"><a href="#cb52-29"></a><span class="ss">2.  </span>基于 Wiener 过程的模型</span>
<span id="cb52-30"><a href="#cb52-30"></a></span>
<span id="cb52-31"><a href="#cb52-31"></a><span class="ss">3.  </span>基于 Gamma 过程的模型</span>
<span id="cb52-32"><a href="#cb52-32"></a></span>
<span id="cb52-33"><a href="#cb52-33"></a><span class="ss">4.  </span>基于逆高斯过程的模型</span>
<span id="cb52-34"><a href="#cb52-34"></a></span>
<span id="cb52-35"><a href="#cb52-35"></a>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究**矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法**，以及**非参数和半参数方法**等，解决模型辨识和修正问题;</span>
<span id="cb52-36"><a href="#cb52-36"></a></span>
<span id="cb52-37"><a href="#cb52-37"></a>采用**似然比检验、Bayes 因子分析**等方法进行模型验证;</span>
<span id="cb52-38"><a href="#cb52-38"></a></span>
<span id="cb52-39"><a href="#cb52-39"></a>采用**均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)**等进行模型优良性检验。</span>
<span id="cb52-40"><a href="#cb52-40"></a></span>
<span id="cb52-41"><a href="#cb52-41"></a>在基于退化的可靠性技术应用方面，针对**机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）**等的退化失效过程，开展**退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计**：特别是加速退化试验方案设计的研究。</span>
<span id="cb52-42"><a href="#cb52-42"></a></span>
<span id="cb52-43"><a href="#cb52-43"></a><span class="fu">## 2. Wiener 退化过程模型</span></span>
<span id="cb52-44"><a href="#cb52-44"></a></span>
<span id="cb52-45"><a href="#cb52-45"></a>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中应用最为广泛的一种模型。Wiener 退化过程的**首达时间分布具有解析形式**，便于对**产品寿命**和**可靠度**的分析和计算。</span>
<span id="cb52-46"><a href="#cb52-46"></a></span>
<span id="cb52-47"><a href="#cb52-47"></a>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</span>
<span id="cb52-48"><a href="#cb52-48"></a></span>
<span id="cb52-49"><a href="#cb52-49"></a>通过对经典 Wiener 过程的参数引入**随机性**，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</span>
<span id="cb52-50"><a href="#cb52-50"></a></span>
<span id="cb52-51"><a href="#cb52-51"></a><span class="at">&gt; 对 Wiener 退化过程及其观测过程所构成的**状态空间模型**，可以采用 **Kalman 滤波技术**进行处理，为产品**在线寿命预测、视情维修决策**等提供了可行的算法和实现途径。</span></span>
<span id="cb52-52"><a href="#cb52-52"></a></span>
<span id="cb52-53"><a href="#cb52-53"></a></span>
<span id="cb52-54"><a href="#cb52-54"></a>称 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是漂移参数为 $\mu$ 、扩散参数为 $\sigma$ 的 (一元) Wiener 过程, 若</span>
<span id="cb52-55"><a href="#cb52-55"></a></span>
<span id="cb52-56"><a href="#cb52-56"></a>(1) $X(0)=0$。</span>
<span id="cb52-57"><a href="#cb52-57"></a></span>
<span id="cb52-58"><a href="#cb52-58"></a>(2) $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 有平稳独立增量。</span>
<span id="cb52-59"><a href="#cb52-59"></a></span>
<span id="cb52-60"><a href="#cb52-60"></a>(3) $X(t)$ 服从均值为 $\mu t$，方差为 $\sigma^2 t$ 的正态分布。</span>
<span id="cb52-61"><a href="#cb52-61"></a></span>
<span id="cb52-62"><a href="#cb52-62"></a>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: $$</span>
<span id="cb52-63"><a href="#cb52-63"></a>X(t)=\mu t+\sigma B(t)</span>
<span id="cb52-64"><a href="#cb52-64"></a>$$ 式中: $<span class="sc">\{</span>B(t)<span class="sc">\}</span>, t \geqslant 0$ 是标准 Wiener 过程或标准布朗运动过程。</span>
<span id="cb52-65"><a href="#cb52-65"></a></span>
<span id="cb52-66"><a href="#cb52-66"></a>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</span>
<span id="cb52-67"><a href="#cb52-67"></a></span>
<span id="cb52-68"><a href="#cb52-68"></a>（1）时刻 $t \sim t+\Delta t$ 之间的增量服从正态分布, 即 $\Delta X=X(t+\Delta t)-X(t) \sim$ $N\left(\mu \Delta t, \sigma^2 \Delta t\right)$ 。</span>
<span id="cb52-69"><a href="#cb52-69"></a></span>
<span id="cb52-70"><a href="#cb52-70"></a>（2）对任意两个不相交的时间区间 $\left<span class="co">[</span><span class="ot">t_1, t_2\right</span><span class="co">]</span>,\left<span class="co">[</span><span class="ot">t_3, t_4\right</span><span class="co">]</span>, t_1<span class="kw">&lt;t_2</span> <span class="er">\leqslant</span> <span class="er">t_3&lt;t_4$,</span> <span class="er">增量</span> <span class="er">$X\left(t_4\right)-X$</span> <span class="er">$\left(t_3\right)$</span> <span class="er">与</span> <span class="er">$X\left(t_2\right)-X\left(t_1\right)$</span> <span class="er">相互独立。</span></span>
<span id="cb52-71"><a href="#cb52-71"></a></span>
<span id="cb52-72"><a href="#cb52-72"></a><span class="ot">*</span><span class="er">*可靠度**</span></span>
<span id="cb52-73"><a href="#cb52-73"></a></span>
<span id="cb52-74"><a href="#cb52-74"></a><span class="er">如果产品的性能退化过程是一元</span> <span class="er">Wiener</span> <span class="er">过程，失效阈值为$l$。</span> <span class="er">则可靠度为</span> <span class="er">$$</span></span>
<span id="cb52-75"><a href="#cb52-75"></a><span class="ot">R</span><span class="er">(t)</span><span class="ot">=</span> <span class="st">1-F(t</span> <span class="er">;</span> <span class="er">\mu,</span> <span class="er">\sigma)</span><span class="ot">=</span><span class="st">\Phi\left(\frac{l-\mu</span> <span class="er">t}{\sigma</span> <span class="er">\sqrt{t}}\right)-\exp</span> <span class="er">\left(\frac{2</span> <span class="er">\mu</span> <span class="er">l}{\sigma^2}\right)</span> <span class="er">\Phi\left(\frac{-l-\mu</span> <span class="er">t}{\sigma</span> <span class="er">\sqrt{t}}\right)</span></span>
<span id="cb52-76"><a href="#cb52-76"></a><span class="er">$$</span></span>
<span id="cb52-77"><a href="#cb52-77"></a></span>
<span id="cb52-78"><a href="#cb52-78"></a><span class="ot">*</span><span class="er">*剩余使用寿命**</span></span>
<span id="cb52-79"><a href="#cb52-79"></a></span>
<span id="cb52-80"><a href="#cb52-80"></a><span class="er">假设其运行到时刻</span> <span class="er">$\tau$</span> <span class="er">仍末失效,</span> <span class="er">且当前性能退化量为</span> <span class="er">$x_\tau\left(x_\tau&lt;l\right)$,</span> <span class="er">则产品的剩余寿命</span> <span class="er">$T_1$</span> <span class="er">可以表示为</span> <span class="er">$$</span></span>
<span id="cb52-81"><a href="#cb52-81"></a><span class="ot">T_1=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)</span> <span class="er">\geqslant</span> <span class="er">l,</span> <span class="er">X(\tau)</span><span class="ot">=</span><span class="st">x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb52-82"><a href="#cb52-82"></a><span class="er">$$</span> <span class="er">由一元</span> <span class="er">Wiener</span> <span class="er">过程的独立增量性质和齐次马尔可夫性得到</span> <span class="er">$$</span></span>
<span id="cb52-83"><a href="#cb52-83"></a><span class="er">\begin{aligned}</span></span>
<span id="cb52-84"><a href="#cb52-84"></a><span class="ot">T_1</span> <span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)-X(\tau)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span> <span class="er">\\</span></span>
<span id="cb52-85"><a href="#cb52-85"></a><span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb52-86"><a href="#cb52-86"></a><span class="er">\end{aligned}</span></span>
<span id="cb52-87"><a href="#cb52-87"></a><span class="er">$$</span> <span class="er">可知剩余寿命</span> <span class="er">$T_1$</span> <span class="er">也是逆</span> <span class="er">Gaussian</span> <span class="er">分布,</span> <span class="er">其密度函数只需将寿命</span> <span class="er">$T$</span> <span class="er">密度函数中的失效阈值</span> <span class="er">$l$</span> <span class="er">替换为</span> <span class="er">$l-x_\tau$,</span> <span class="er">即</span> <span class="er">$$f_{T_1}(t)</span><span class="ot">=</span><span class="st">\frac{l-x_\tau}{\sqrt{2</span> <span class="er">\pi</span> <span class="er">\sigma^2</span> <span class="er">t^3}}</span> <span class="er">\exp</span> <span class="er">\left[-\frac{\left(l-x_\tau-\mu</span> <span class="er">t\right)^2}{2</span> <span class="er">\sigma^2</span> <span class="er">t}\right]$$</span></span>
<span id="cb52-88"><a href="#cb52-88"></a></span>
<span id="cb52-89"><a href="#cb52-89"></a><span class="er">```{r</span> <span class="er">include</span><span class="ot">=</span><span class="st">FALSE}</span></span>
<span id="cb52-90"><a href="#cb52-90"></a><span class="ot">library</span><span class="er">(ggplot2)</span></span>
<span id="cb52-91"><a href="#cb52-91"></a><span class="ot">library</span><span class="er">(tidyverse)</span></span>
<span id="cb52-92"><a href="#cb52-92"></a><span class="ot">library</span><span class="er">(viridis)</span></span>
<span id="cb52-93"><a href="#cb52-93"></a><span class="er">```</span></span>
<span id="cb52-94"><a href="#cb52-94"></a></span>
<span id="cb52-95"><a href="#cb52-95"></a></span>
<span id="cb52-96"><a href="#cb52-96"></a><span class="ot">#</span><span class="er">##</span> <span class="er">2.1</span> <span class="er">统计推断</span></span>
<span id="cb52-97"><a href="#cb52-97"></a></span>
<span id="cb52-98"><a href="#cb52-98"></a><span class="er">假设共有</span> <span class="er">$n$</span> <span class="er">个样品进行性能退化试验。样品</span> <span class="er">$i$</span> <span class="er">初始时刻</span> <span class="er">$t_{i</span> <span class="er">0}$</span> <span class="er">退化量取值为</span> <span class="er">$X_{i</span> <span class="er">0}</span><span class="ot">=</span><span class="st">0$,</span> <span class="er">在</span> <span class="er">时刻</span> <span class="er">$t_{i</span> <span class="er">1},</span> <span class="er">\cdots,</span> <span class="er">t_{i</span> <span class="er">m_i}$</span> <span class="er">样品</span> <span class="er">$i$</span> <span class="er">退化量为</span> <span class="er">$X_{i</span> <span class="er">1},</span> <span class="er">\cdots,</span> <span class="er">X_{i</span> <span class="er">m_i}$</span> <span class="er">。记</span> <span class="er">$\Delta</span> <span class="er">X_{i</span> <span class="er">j}</span><span class="ot">=</span><span class="st">X_{i</span> <span class="er">j}-X_{i,</span> <span class="er">j-1}$</span> <span class="er">是样品</span> <span class="er">$i$</span> <span class="er">在时刻</span> <span class="er">$t_{i,</span> <span class="er">j-1}</span> <span class="er">\sim</span> <span class="er">t_{i</span> <span class="er">j}$</span> <span class="er">之间的退化增量,</span> <span class="er">$\Delta</span> <span class="er">t_{i</span> <span class="er">j}</span><span class="ot">=</span><span class="st">t_{i</span> <span class="er">j}-t_{i</span> <span class="er">j-1},</span> <span class="er">j</span><span class="ot">=</span><span class="st">1,2,</span> <span class="er">\cdots,</span> <span class="er">m_i,</span> <span class="er">i</span><span class="ot">=</span><span class="st">1,2,</span> <span class="er">\cdots,</span> <span class="er">n$</span> <span class="er">为各样品的测量间隔。</span></span>
<span id="cb52-99"><a href="#cb52-99"></a></span>
<span id="cb52-100"><a href="#cb52-100"></a><span class="ot">#</span><span class="er">###</span> <span class="er">2.1.1</span> <span class="er">极大似然估计</span></span>
<span id="cb52-101"><a href="#cb52-101"></a></span>
<span id="cb52-102"><a href="#cb52-102"></a><span class="er">&lt;!--</span> <span class="er">在简单情形,</span> <span class="er">认为退化数据的测量不存在误差,</span> <span class="er">并且总体退化过程不存在随机效应。</span> <span class="er">--</span><span class="kw">&gt;</span></span>
<span id="cb52-103"><a href="#cb52-103"></a>由 Wiener 过程的性质, 容易知道 $$</span>
<span id="cb52-104"><a href="#cb52-104"></a>\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)</span>
<span id="cb52-105"><a href="#cb52-105"></a>$$</span>
<span id="cb52-106"><a href="#cb52-106"></a></span>
<span id="cb52-107"><a href="#cb52-107"></a>于是由退化数据 $X_{i j}=x_{i j}$ $j=1,2, \cdots, m_i, i=1,2, \cdots, n$, 得到模型参数的似然函数为 $$</span>
<span id="cb52-108"><a href="#cb52-108"></a>L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left<span class="co">[</span><span class="ot">-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb52-109"><a href="#cb52-109"></a>$$ 由式可以直接求得漂移参数 $\mu$ 和扩散参数 $\sigma^2$ 的极大似然估计如下: $$</span>
<span id="cb52-110"><a href="#cb52-110"></a>\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left<span class="co">[</span><span class="ot">\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right</span><span class="co">]</span></span>
<span id="cb52-111"><a href="#cb52-111"></a>$$</span>
<span id="cb52-112"><a href="#cb52-112"></a></span>
<span id="cb52-113"><a href="#cb52-113"></a></span>
<span id="cb52-114"><a href="#cb52-114"></a></span>
<span id="cb52-115"><a href="#cb52-115"></a><span class="fu">#### 2.1.2 贝叶斯分析</span></span>
<span id="cb52-116"><a href="#cb52-116"></a></span>
<span id="cb52-117"><a href="#cb52-117"></a><span class="co">&lt;!-- 基于 rstan 进行贝叶斯估计。详细的参考文献如下： --&gt;</span></span>
<span id="cb52-118"><a href="#cb52-118"></a></span>
<span id="cb52-119"><a href="#cb52-119"></a><span class="co">&lt;!-- -   最新、入门级别 [rstan](https://mirrors.sjtug.sjtu.edu.cn/cran/web/packages/rstan/vignettes/rstan.html) 资料。 --&gt;</span></span>
<span id="cb52-120"><a href="#cb52-120"></a></span>
<span id="cb52-121"><a href="#cb52-121"></a><span class="co">&lt;!-- -   [官网资料](https://mc-stan.org/users/interfaces/rstan) --&gt;</span></span>
<span id="cb52-122"><a href="#cb52-122"></a></span>
<span id="cb52-123"><a href="#cb52-123"></a>基于前面所提的经典线性维纳过程，利用 rstan 进行贝叶斯分析。</span>
<span id="cb52-124"><a href="#cb52-124"></a></span>
<span id="cb52-125"><a href="#cb52-125"></a>$$</span>
<span id="cb52-126"><a href="#cb52-126"></a>\begin{aligned}</span>
<span id="cb52-127"><a href="#cb52-127"></a>&amp;\Delta X_{ij} = N(\mu \Delta t_{ij}, \sigma^2 \Delta t_{ij}),<span class="sc">\\</span></span>
<span id="cb52-128"><a href="#cb52-128"></a>&amp;w = \frac{1}{\sigma^2} \sim Gam(a,b),<span class="sc">\\</span></span>
<span id="cb52-129"><a href="#cb52-129"></a>&amp; \mu|w \sim N(d,\frac{c}{w}).</span>
<span id="cb52-130"><a href="#cb52-130"></a>\end{aligned}</span>
<span id="cb52-131"><a href="#cb52-131"></a>$$</span>
<span id="cb52-132"><a href="#cb52-132"></a></span>
<span id="cb52-133"><a href="#cb52-133"></a>其中，$a = b = 1, d = 0, c =100$。</span>
<span id="cb52-134"><a href="#cb52-134"></a></span>
<span id="cb52-135"><a href="#cb52-135"></a><span class="ss">-   </span>数据准备</span>
<span id="cb52-136"><a href="#cb52-136"></a></span>
<span id="cb52-137"><a href="#cb52-137"></a>准备$\Delta t_{ij}$ 和 $\Delta x_{ij}$的数据，并且标志出矩阵的维数。</span>
<span id="cb52-138"><a href="#cb52-138"></a></span>
<span id="cb52-139"><a href="#cb52-139"></a><span class="ss">- </span>构建模型（<span class="in">`wiener_linear.stan`</span>）</span>
<span id="cb52-140"><a href="#cb52-140"></a></span>
<span id="cb52-141"><a href="#cb52-141"></a><span class="in">``` markdown</span></span>
<span id="cb52-142"><a href="#cb52-142"></a>data {</span>
<span id="cb52-143"><a href="#cb52-143"></a>  int&lt;lower=0&gt; I;</span>
<span id="cb52-144"><a href="#cb52-144"></a>  int&lt;lower=0&gt; J;</span>
<span id="cb52-145"><a href="#cb52-145"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> x;</span>
<span id="cb52-146"><a href="#cb52-146"></a>  matrix<span class="co">[</span><span class="ot">I,J</span><span class="co">]</span> t;</span>
<span id="cb52-147"><a href="#cb52-147"></a>}</span>
<span id="cb52-148"><a href="#cb52-148"></a></span>
<span id="cb52-149"><a href="#cb52-149"></a>parameters {</span>
<span id="cb52-150"><a href="#cb52-150"></a>  real mu;</span>
<span id="cb52-151"><a href="#cb52-151"></a>  real&lt;lower=0&gt; w;</span>
<span id="cb52-152"><a href="#cb52-152"></a>}</span>
<span id="cb52-153"><a href="#cb52-153"></a></span>
<span id="cb52-154"><a href="#cb52-154"></a>model {</span>
<span id="cb52-155"><a href="#cb52-155"></a>  w ~ gamma(1,1);</span>
<span id="cb52-156"><a href="#cb52-156"></a>  mu ~ normal(0, 100/w);</span>
<span id="cb52-157"><a href="#cb52-157"></a>  for (i in 1:I){</span>
<span id="cb52-158"><a href="#cb52-158"></a>    for (j in 1:J) {</span>
<span id="cb52-159"><a href="#cb52-159"></a>      x<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span> ~ normal(mu * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>, 1/w * t<span class="co">[</span><span class="ot">i,j</span><span class="co">]</span>);</span>
<span id="cb52-160"><a href="#cb52-160"></a>    }</span>
<span id="cb52-161"><a href="#cb52-161"></a>  }</span>
<span id="cb52-162"><a href="#cb52-162"></a>}</span>
<span id="cb52-163"><a href="#cb52-163"></a><span class="in">```</span></span>
<span id="cb52-164"><a href="#cb52-164"></a></span>
<span id="cb52-165"><a href="#cb52-165"></a><span class="fu">### 2.2 模拟数据分析</span></span>
<span id="cb52-166"><a href="#cb52-166"></a></span>
<span id="cb52-167"><a href="#cb52-167"></a><span class="fu">### 数据模拟产生</span></span>
<span id="cb52-168"><a href="#cb52-168"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb52-169"><a href="#cb52-169"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb52-170"><a href="#cb52-170"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)){</span>
<span id="cb52-171"><a href="#cb52-171"></a>  <span class="co"># para 指 mu,sigma</span></span>
<span id="cb52-172"><a href="#cb52-172"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb52-173"><a href="#cb52-173"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb52-174"><a href="#cb52-174"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb52-175"><a href="#cb52-175"></a>  dat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb52-176"><a href="#cb52-176"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb52-177"><a href="#cb52-177"></a>  dat_unit <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb52-178"><a href="#cb52-178"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb52-179"><a href="#cb52-179"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) dat_unit[j] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],<span class="fu">sqrt</span>(para[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_t[j]))</span>
<span id="cb52-180"><a href="#cb52-180"></a>    dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit)</span>
<span id="cb52-181"><a href="#cb52-181"></a>  }</span>
<span id="cb52-182"><a href="#cb52-182"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb52-183"><a href="#cb52-183"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb52-184"><a href="#cb52-184"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb52-185"><a href="#cb52-185"></a>  <span class="fu">return</span>(dat1)</span>
<span id="cb52-186"><a href="#cb52-186"></a>}</span>
<span id="cb52-187"><a href="#cb52-187"></a><span class="in">```</span></span>
<span id="cb52-188"><a href="#cb52-188"></a></span>
<span id="cb52-189"><a href="#cb52-189"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb52-190"><a href="#cb52-190"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb52-191"><a href="#cb52-191"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb52-192"><a href="#cb52-192"></a>    <span class="co"># 画图</span></span>
<span id="cb52-193"><a href="#cb52-193"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb52-194"><a href="#cb52-194"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb52-195"><a href="#cb52-195"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-196"><a href="#cb52-196"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb52-197"><a href="#cb52-197"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-198"><a href="#cb52-198"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb52-199"><a href="#cb52-199"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb52-200"><a href="#cb52-200"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb52-201"><a href="#cb52-201"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb52-202"><a href="#cb52-202"></a>  <span class="fu">print</span>(p)</span>
<span id="cb52-203"><a href="#cb52-203"></a>}</span>
<span id="cb52-204"><a href="#cb52-204"></a><span class="in">```</span></span>
<span id="cb52-205"><a href="#cb52-205"></a></span>
<span id="cb52-206"><a href="#cb52-206"></a><span class="in">```{r }</span></span>
<span id="cb52-207"><a href="#cb52-207"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb52-208"><a href="#cb52-208"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb52-209"><a href="#cb52-209"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb52-210"><a href="#cb52-210"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb52-211"><a href="#cb52-211"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span>
<span id="cb52-212"><a href="#cb52-212"></a><span class="fu">plot_path</span>(dat)</span>
<span id="cb52-213"><a href="#cb52-213"></a><span class="in">```</span></span>
<span id="cb52-214"><a href="#cb52-214"></a></span>
<span id="cb52-215"><a href="#cb52-215"></a></span>
<span id="cb52-216"><a href="#cb52-216"></a><span class="fu">### 绘制退化路径图</span></span>
<span id="cb52-217"><a href="#cb52-217"></a></span>
<span id="cb52-218"><a href="#cb52-218"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb52-219"><a href="#cb52-219"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb52-220"><a href="#cb52-220"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb52-221"><a href="#cb52-221"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb52-222"><a href="#cb52-222"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb52-223"><a href="#cb52-223"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb52-224"><a href="#cb52-224"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb52-225"><a href="#cb52-225"></a>  }</span>
<span id="cb52-226"><a href="#cb52-226"></a>  <span class="fu">return</span>(re)</span>
<span id="cb52-227"><a href="#cb52-227"></a>}</span>
<span id="cb52-228"><a href="#cb52-228"></a><span class="in">```</span></span>
<span id="cb52-229"><a href="#cb52-229"></a><span class="fu">### 极大似然估计</span></span>
<span id="cb52-230"><a href="#cb52-230"></a></span>
<span id="cb52-231"><a href="#cb52-231"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb52-232"><a href="#cb52-232"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb52-233"><a href="#cb52-233"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb52-234"><a href="#cb52-234"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb52-235"><a href="#cb52-235"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb52-236"><a href="#cb52-236"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb52-237"><a href="#cb52-237"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb52-238"><a href="#cb52-238"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb52-239"><a href="#cb52-239"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb52-240"><a href="#cb52-240"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb52-241"><a href="#cb52-241"></a></span>
<span id="cb52-242"><a href="#cb52-242"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb52-243"><a href="#cb52-243"></a></span>
<span id="cb52-244"><a href="#cb52-244"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb52-245"><a href="#cb52-245"></a>}</span>
<span id="cb52-246"><a href="#cb52-246"></a><span class="in">```</span></span>
<span id="cb52-247"><a href="#cb52-247"></a></span>
<span id="cb52-250"><a href="#cb52-250"></a><span class="in">```{r}</span></span>
<span id="cb52-251"><a href="#cb52-251"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb52-252"><a href="#cb52-252"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-253"><a href="#cb52-253"></a><span class="co"># mle_re</span></span>
<span id="cb52-254"><a href="#cb52-254"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb52-255"><a href="#cb52-255"></a><span class="co"># 区间估计</span></span>
<span id="cb52-256"><a href="#cb52-256"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb52-257"><a href="#cb52-257"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb52-258"><a href="#cb52-258"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb52-259"><a href="#cb52-259"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb52-260"><a href="#cb52-260"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span>
<span id="cb52-261"><a href="#cb52-261"></a><span class="in">```</span></span>
<span id="cb52-262"><a href="#cb52-262"></a></span>
<span id="cb52-263"><a href="#cb52-263"></a></span>
<span id="cb52-264"><a href="#cb52-264"></a><span class="fu">### 贝叶斯估计</span></span>
<span id="cb52-265"><a href="#cb52-265"></a></span>
<span id="cb52-268"><a href="#cb52-268"></a><span class="in">```{r}</span></span>
<span id="cb52-269"><a href="#cb52-269"></a><span class="co"># 数据准备</span></span>
<span id="cb52-270"><a href="#cb52-270"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(dat) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> dat[,<span class="dv">1</span>];y <span class="ot">=</span> dat[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb52-271"><a href="#cb52-271"></a><span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb52-272"><a href="#cb52-272"></a>delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb52-273"><a href="#cb52-273"></a>delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb52-274"><a href="#cb52-274"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb52-275"><a href="#cb52-275"></a></span>
<span id="cb52-276"><a href="#cb52-276"></a>wiener_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-277"><a href="#cb52-277"></a>  <span class="at">I =</span> <span class="fu">nrow</span>(delta_y),</span>
<span id="cb52-278"><a href="#cb52-278"></a>  <span class="at">J =</span> <span class="fu">ncol</span>(delta_y),</span>
<span id="cb52-279"><a href="#cb52-279"></a>  <span class="at">x =</span> delta_y,</span>
<span id="cb52-280"><a href="#cb52-280"></a>  <span class="at">t =</span> delta_time</span>
<span id="cb52-281"><a href="#cb52-281"></a>)</span>
<span id="cb52-282"><a href="#cb52-282"></a><span class="in">```</span></span>
<span id="cb52-283"><a href="#cb52-283"></a></span>
<span id="cb52-286"><a href="#cb52-286"></a><span class="in">```{r}</span></span>
<span id="cb52-287"><a href="#cb52-287"></a><span class="co">#| warning: false</span></span>
<span id="cb52-288"><a href="#cb52-288"></a><span class="co">#| message: false</span></span>
<span id="cb52-289"><a href="#cb52-289"></a><span class="co"># 后验抽样</span></span>
<span id="cb52-290"><a href="#cb52-290"></a><span class="fu">library</span>(rstan)</span>
<span id="cb52-291"><a href="#cb52-291"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb52-292"><a href="#cb52-292"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-293"><a href="#cb52-293"></a>fit1 <span class="ot">=</span> <span class="fu">stan</span>(</span>
<span id="cb52-294"><a href="#cb52-294"></a>  <span class="at">file =</span> <span class="st">"wiener_linear.stan"</span>,</span>
<span id="cb52-295"><a href="#cb52-295"></a>  <span class="at">data =</span> wiener_data,</span>
<span id="cb52-296"><a href="#cb52-296"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb52-297"><a href="#cb52-297"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb52-298"><a href="#cb52-298"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb52-299"><a href="#cb52-299"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb52-300"><a href="#cb52-300"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb52-301"><a href="#cb52-301"></a>)</span>
<span id="cb52-302"><a href="#cb52-302"></a><span class="in">```</span></span>
<span id="cb52-303"><a href="#cb52-303"></a></span>
<span id="cb52-304"><a href="#cb52-304"></a>输出各个参数的后验估计结果并进行绘制。</span>
<span id="cb52-305"><a href="#cb52-305"></a></span>
<span id="cb52-308"><a href="#cb52-308"></a><span class="in">```{r}</span></span>
<span id="cb52-309"><a href="#cb52-309"></a><span class="fu">print</span>(fit1,</span>
<span id="cb52-310"><a href="#cb52-310"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span>
<span id="cb52-311"><a href="#cb52-311"></a></span>
<span id="cb52-312"><a href="#cb52-312"></a><span class="fu">plot</span>(fit1)</span>
<span id="cb52-313"><a href="#cb52-313"></a></span>
<span id="cb52-314"><a href="#cb52-314"></a><span class="fu">traceplot</span>(fit1,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>,<span class="st">"w"</span>),</span>
<span id="cb52-315"><a href="#cb52-315"></a>          <span class="at">inc_warmup =</span> T,</span>
<span id="cb52-316"><a href="#cb52-316"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb52-317"><a href="#cb52-317"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb52-318"><a href="#cb52-318"></a><span class="in">```</span></span>
<span id="cb52-319"><a href="#cb52-319"></a></span>
<span id="cb52-320"><a href="#cb52-320"></a>可以看出，效果较好。真实值为：$\mu = 2,w = 1 / \sigma^2 = 0.25$，估计值为：$\mu = 2,w = 1 / \sigma^2 = 0.5$。 估计值的$\sigma^2$ 有些问题，应该如何处理？</span>
<span id="cb52-321"><a href="#cb52-321"></a></span>
<span id="cb52-322"><a href="#cb52-322"></a></span>
<span id="cb52-323"><a href="#cb52-323"></a><span class="fu">### 可靠度和 RUL 计算</span></span>
<span id="cb52-324"><a href="#cb52-324"></a></span>
<span id="cb52-325"><a href="#cb52-325"></a>这里以MLE的参数估计值作为案例。</span>
<span id="cb52-326"><a href="#cb52-326"></a><span class="in">```{r,collapse=TRUE}</span></span>
<span id="cb52-327"><a href="#cb52-327"></a><span class="do">## 可靠度计算</span></span>
<span id="cb52-328"><a href="#cb52-328"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb52-329"><a href="#cb52-329"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb52-330"><a href="#cb52-330"></a>  <span class="fu">return</span>(R)</span>
<span id="cb52-331"><a href="#cb52-331"></a>}</span>
<span id="cb52-332"><a href="#cb52-332"></a></span>
<span id="cb52-333"><a href="#cb52-333"></a><span class="in">```</span></span>
<span id="cb52-334"><a href="#cb52-334"></a></span>
<span id="cb52-335"><a href="#cb52-335"></a></span>
<span id="cb52-336"><a href="#cb52-336"></a></span>
<span id="cb52-339"><a href="#cb52-339"></a><span class="in">```{r}</span></span>
<span id="cb52-340"><a href="#cb52-340"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb52-341"><a href="#cb52-341"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb52-342"><a href="#cb52-342"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb52-343"><a href="#cb52-343"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb52-344"><a href="#cb52-344"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb52-345"><a href="#cb52-345"></a></span>
<span id="cb52-346"><a href="#cb52-346"></a><span class="in">```</span></span>
<span id="cb52-347"><a href="#cb52-347"></a></span>
<span id="cb52-350"><a href="#cb52-350"></a><span class="in">```{r}</span></span>
<span id="cb52-351"><a href="#cb52-351"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb52-352"><a href="#cb52-352"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb52-353"><a href="#cb52-353"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-354"><a href="#cb52-354"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb52-355"><a href="#cb52-355"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-356"><a href="#cb52-356"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span>
<span id="cb52-357"><a href="#cb52-357"></a><span class="in">```</span></span>
<span id="cb52-358"><a href="#cb52-358"></a></span>
<span id="cb52-359"><a href="#cb52-359"></a></span>
<span id="cb52-360"><a href="#cb52-360"></a><span class="fu"># 3. Gamma 退化过程模型</span></span>
<span id="cb52-361"><a href="#cb52-361"></a></span>
<span id="cb52-362"><a href="#cb52-362"></a>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。 当产品的退化过程是严格单调非负时, Wiener 过程不再适用。Gamma 过程具有独立非负增量,可以对该类退化过程进行建模。</span>
<span id="cb52-363"><a href="#cb52-363"></a></span>
<span id="cb52-364"><a href="#cb52-364"></a></span>
<span id="cb52-365"><a href="#cb52-365"></a>称连续时间随机过程 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是平稳 Gamma 过程 ${ }^{<span class="co">[</span><span class="ot">2</span><span class="co">]</span>}$, 若它满足以下性质:</span>
<span id="cb52-366"><a href="#cb52-366"></a></span>
<span id="cb52-367"><a href="#cb52-367"></a>(1) $X(0)=0$ 以概率 1 成立。</span>
<span id="cb52-368"><a href="#cb52-368"></a></span>
<span id="cb52-369"><a href="#cb52-369"></a>(2) $X(t)$ 具有平稳独立增量。</span>
<span id="cb52-370"><a href="#cb52-370"></a></span>
<span id="cb52-371"><a href="#cb52-371"></a>(3) 对任意 $t \geqslant 0$ 和 $\Delta t, X(t+\Delta t)-X(t) \sim G a(\alpha \Delta t, \beta)$ 。</span>
<span id="cb52-372"><a href="#cb52-372"></a></span>
<span id="cb52-373"><a href="#cb52-373"></a><span class="in">    其中 $G a(\alpha, \beta)$ 是形状参数为 $\alpha&gt;0$ 、尺度参数为 $\beta&gt;0$ 的 Gamma 分布, 分布密度函数为 $$</span></span>
<span id="cb52-374"><a href="#cb52-374"></a><span class="in">    f(x \mid \alpha, \beta)=\frac{1}{\Gamma(\alpha) \beta^\alpha} \alpha^{\alpha-1} \mathrm{e}^{-x / \beta} I_{(0, \infty)}(x)</span></span>
<span id="cb52-375"><a href="#cb52-375"></a><span class="in">    $$ 并且 $\{X(t), t \geqslant 0\}$ 称为形状参数为 $\alpha&gt;0$ 、尺度参数为 $\beta&gt;0$ 的平稳 Gamma 过程。</span></span>
<span id="cb52-376"><a href="#cb52-376"></a></span>
<span id="cb52-377"><a href="#cb52-377"></a>**产品寿命**</span>
<span id="cb52-378"><a href="#cb52-378"></a></span>
<span id="cb52-379"><a href="#cb52-379"></a>因为Gamma 过程的退化是单调递增的，即$X(t) \sim Ga(\alpha t,\beta)$ ,因此**产品寿命**的分布可以直接通过退化量的转换获得。当给定产品退化失效阈值 $\ell$ 时，产品寿命 $T$ 的CDF和PDF为</span>
<span id="cb52-380"><a href="#cb52-380"></a></span>
<span id="cb52-381"><a href="#cb52-381"></a>$$</span>
<span id="cb52-382"><a href="#cb52-382"></a>\begin{aligned}</span>
<span id="cb52-383"><a href="#cb52-383"></a>{F}_{{T}}(t) &amp;={P}({T} \leqslant {t})={P}({X}({t}) \geqslant \ell) <span class="sc">\\</span></span>
<span id="cb52-384"><a href="#cb52-384"></a>&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha {t}) \beta^{\alpha {t}}} {x}^{\alpha {t}-1} \mathrm{e}^{-\frac{{x}}{\beta}} {dx} <span class="sc">\\</span></span>
<span id="cb52-385"><a href="#cb52-385"></a>&amp;=\frac{1}{\Gamma(\alpha {t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi ,<span class="sc">\\</span></span>
<span id="cb52-386"><a href="#cb52-386"></a>{f}_{{T}}(t) &amp;=\frac{{d}}{{dt}} \frac{\Gamma(\alpha {t}, 1 / \beta)}{\Gamma(\alpha {t})} <span class="sc">\\</span></span>
<span id="cb52-387"><a href="#cb52-387"></a>&amp;=\frac{\alpha}{\Gamma(\alpha {t})} \int_0^{\nu / \beta}\left<span class="co">[</span><span class="ot">\ln (\xi)-\frac{\Gamma^{\prime}(\alpha {t})}{\Gamma(\alpha {t})}\right</span><span class="co">]</span> \xi^{\alpha {t}-1} \mathrm{e}^{-\xi} {d} \xi.</span>
<span id="cb52-388"><a href="#cb52-388"></a>\end{aligned}</span>
<span id="cb52-389"><a href="#cb52-389"></a>$$</span>
<span id="cb52-390"><a href="#cb52-390"></a></span>
<span id="cb52-391"><a href="#cb52-391"></a>由于${f}_{{T}}({t})$ 相当复杂，因此一般用B-S分布来逼近：</span>
<span id="cb52-392"><a href="#cb52-392"></a></span>
<span id="cb52-393"><a href="#cb52-393"></a>$$</span>
<span id="cb52-394"><a href="#cb52-394"></a>{F}(t ; \ell)=\Phi\left<span class="co">[</span><span class="ot">\frac{1}{{v}}\left(\sqrt{\frac{{t}}{{u}}}-\sqrt{\frac{{u}}{{t}}}\right)\right</span><span class="co">]</span>, \quad {t}&gt;0.</span>
<span id="cb52-395"><a href="#cb52-395"></a>$$ 其中，$\Phi(\cdot)$ 为标准正态分布，$v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}$. 相应的 PDF 为 $$</span>
<span id="cb52-396"><a href="#cb52-396"></a>{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} {uv}}\left<span class="co">[</span><span class="ot">\left(\frac{{u}}{{t}}\right)^{\frac{1}{2}}+\left(\frac{{u}}{{t}}\right)^{\frac{3}{2}}\right</span><span class="co">]</span> \exp \left<span class="co">[</span><span class="ot">-\frac{1}{2 {v}^2}\left(\frac{{t}}{{u}}-2+\frac{{u}}{{t}}\right)\right</span><span class="co">]</span>, {t}&gt;0.</span>
<span id="cb52-397"><a href="#cb52-397"></a>$$</span>
<span id="cb52-398"><a href="#cb52-398"></a></span>
<span id="cb52-399"><a href="#cb52-399"></a>**剩余寿命**</span>
<span id="cb52-400"><a href="#cb52-400"></a></span>
<span id="cb52-401"><a href="#cb52-401"></a>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 $$</span>
<span id="cb52-402"><a href="#cb52-402"></a>\begin{aligned}</span>
<span id="cb52-403"><a href="#cb52-403"></a>{F}(t \mid s) &amp;={P}\left({T} \leqslant t \mid {X}(s)={x}_{s}\right) <span class="sc">\\</span></span>
<span id="cb52-404"><a href="#cb52-404"></a>&amp;={P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) <span class="sc">\\</span></span>
<span id="cb52-405"><a href="#cb52-405"></a>&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .</span>
<span id="cb52-406"><a href="#cb52-406"></a>\end{aligned}</span>
<span id="cb52-407"><a href="#cb52-407"></a>$$ 这与将失效阈值由 $\ell$ 变为 $\ell-{x_s}$ 、时间 $t$ 变为 $t-s$ 情形的寿命分布是一样的. 因此，在给定当前状态情况下，可以按照类似的途径更新剩余寿命.</span>
<span id="cb52-408"><a href="#cb52-408"></a></span>
<span id="cb52-409"><a href="#cb52-409"></a><span class="fu">### 3.1 统计推断</span></span>
<span id="cb52-410"><a href="#cb52-410"></a></span>
<span id="cb52-411"><a href="#cb52-411"></a>假设共有 ${n}$ 个样品进行性能退化试验. 对于样品 $i$, 初始时刻 $t_0$ 性能退化量为 $X_{i 0}=0$, 在时刻 $t_1, \cdots, t_{m_i}$ 测量产品的性能退化量, 得到其测量值为 $X_{i 1}, \cdots, X_{i m_i}$. 记 $\Delta x_{i j}=X_{i j}-X_{i(j-1)}$ 是样品 $i$ 在时刻 $t_{j-1}$ 和 $t_j$ 之间的性能退化量, 由 Gamma 过程的独立增量性得到$\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)$。</span>
<span id="cb52-412"><a href="#cb52-412"></a></span>
<span id="cb52-413"><a href="#cb52-413"></a><span class="fu">#### 3.1.1 矩估计</span></span>
<span id="cb52-414"><a href="#cb52-414"></a></span>
<span id="cb52-415"><a href="#cb52-415"></a>令 $R_{i j}=\Delta X_{i j} / \Delta t_{i j}$, 则诸 $R_{i j}, j=1,2, \cdots, m_i, i=1,2, \cdots, n$ 服从形状参数为 $\alpha$ 、尺度参数为 $\beta$ 的 Gamma 分布, 且相互独立(根据 Gamma 过程独立增量特性, 以及各样品退化过程的独立性)。记 $M=\sum_{i=1}^n m_i$, 样本均值和样本方差为 $$</span>
<span id="cb52-416"><a href="#cb52-416"></a>\begin{align}</span>
<span id="cb52-417"><a href="#cb52-417"></a>\bar{R}&amp; =\frac{1}{M} \sum_{i=1}^n \sum_{j=1}^{m_i} R_{i j} <span class="sc">\\</span></span>
<span id="cb52-418"><a href="#cb52-418"></a>S_R^2 &amp; =\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">R_{i j}-\bar{R}\right</span><span class="co">]</span>^2</span>
<span id="cb52-419"><a href="#cb52-419"></a>\end{align}</span>
<span id="cb52-420"><a href="#cb52-420"></a>$$ 易知 $$</span>
<span id="cb52-421"><a href="#cb52-421"></a>\begin{aligned}</span>
<span id="cb52-422"><a href="#cb52-422"></a>E<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span> &amp;=\alpha \beta <span class="sc">\\</span></span>
<span id="cb52-423"><a href="#cb52-423"></a>Var<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span>&amp;=\frac{1}{M^2} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb52-424"><a href="#cb52-424"></a>\end{aligned}</span>
<span id="cb52-425"><a href="#cb52-425"></a>$$ 所以，</span>
<span id="cb52-426"><a href="#cb52-426"></a></span>
<span id="cb52-427"><a href="#cb52-427"></a>$$</span>
<span id="cb52-428"><a href="#cb52-428"></a>\begin{aligned}</span>
<span id="cb52-429"><a href="#cb52-429"></a>E\left<span class="co">[</span><span class="ot">S_R^2\right</span><span class="co">]</span>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left<span class="co">[</span><span class="ot">R_{i j}-\bar{R}\right</span><span class="co">]</span>^2<span class="sc">\\</span></span>
<span id="cb52-430"><a href="#cb52-430"></a>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i} E\left<span class="co">[</span><span class="ot">R_{i j}-\alpha \beta-(\bar{R}-\alpha \beta)\right</span><span class="co">]</span>^2 <span class="sc">\\</span></span>
<span id="cb52-431"><a href="#cb52-431"></a>&amp;=\frac{1}{M-1} \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="sc">\{</span>Var\left<span class="co">[</span><span class="ot">R_{i j}\right</span><span class="co">]</span>^2-\frac{2}{m_i} Var\left<span class="co">[</span><span class="ot">R_{i j}\right</span><span class="co">]</span>+ Var<span class="co">[</span><span class="ot">\bar{R}</span><span class="co">]</span>\right<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb52-432"><a href="#cb52-432"></a>&amp;=\frac{1}{M-1} \alpha \beta^2 \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">\frac{1}{\Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb52-433"><a href="#cb52-433"></a>\end{aligned}</span>
<span id="cb52-434"><a href="#cb52-434"></a>$$ 将待估参数和样本矩联系起来, 即令 $$</span>
<span id="cb52-435"><a href="#cb52-435"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb52-436"><a href="#cb52-436"></a>\alpha \beta=\bar{R} <span class="sc">\\</span></span>
<span id="cb52-437"><a href="#cb52-437"></a>\alpha \beta^2=M S_R^2 / \sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span></span>
<span id="cb52-438"><a href="#cb52-438"></a>\end{array}\right.</span>
<span id="cb52-439"><a href="#cb52-439"></a>$$ 可得如下矩估计: $$</span>
<span id="cb52-440"><a href="#cb52-440"></a>\begin{gathered}</span>
<span id="cb52-441"><a href="#cb52-441"></a>\hat{\alpha}=\frac{\sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span> \bar{R}^2}{M S_R^2} <span class="sc">\\</span></span>
<span id="cb52-442"><a href="#cb52-442"></a>\hat{\beta}=\frac{M S_R^2}{\sum_{i=1}^n \sum_{j=1}^{m_i}\left<span class="co">[</span><span class="ot">1 / \Delta t_{i j}\right</span><span class="co">]</span> \bar{R}}</span>
<span id="cb52-443"><a href="#cb52-443"></a>\end{gathered}</span>
<span id="cb52-444"><a href="#cb52-444"></a>$$</span>
<span id="cb52-445"><a href="#cb52-445"></a></span>
<span id="cb52-446"><a href="#cb52-446"></a>上述矩估计方法是基于退化速率的，金光还给出了基于退化量的矩估计（详见P128）,注意到当测量间隔都相同时，两个矩估计方法相同。</span>
<span id="cb52-447"><a href="#cb52-447"></a></span>
<span id="cb52-448"><a href="#cb52-448"></a></span>
<span id="cb52-449"><a href="#cb52-449"></a></span>
<span id="cb52-450"><a href="#cb52-450"></a><span class="fu">#### 3.1.2 极大似然估计</span></span>
<span id="cb52-451"><a href="#cb52-451"></a></span>
<span id="cb52-452"><a href="#cb52-452"></a>由 Gamma 过程独立增量特性, 以及 $$</span>
<span id="cb52-453"><a href="#cb52-453"></a>\Delta X_{i j} \sim G a\left(\alpha \Delta t_{i j}, \beta\right)=\frac{\left(\Delta x_{i j} / \beta\right)^{\alpha \Delta t_{i j}-1}}{\beta \Gamma\left(\alpha \Delta t_{i j}\right)} \mathrm{e}^{-\Delta x_{i j} / \beta}</span>
<span id="cb52-454"><a href="#cb52-454"></a>$$ 可以获得对数似然函数为 $$</span>
<span id="cb52-455"><a href="#cb52-455"></a>l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)</span>
<span id="cb52-456"><a href="#cb52-456"></a>$$ 由极大似然估计原理, 令 $$</span>
<span id="cb52-457"><a href="#cb52-457"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb52-458"><a href="#cb52-458"></a>\frac{\partial l}{\partial \alpha}=\sum_{i=1}^n \sum_{j=1}^{m_i} \Delta t_{i j}\left(\ln x_{i j}-\psi\left(\alpha \Delta t_{i j}\right)-\ln \beta\right)=0 <span class="sc">\\</span></span>
<span id="cb52-459"><a href="#cb52-459"></a>\frac{\partial l}{\partial \beta}=\sum_{i=1}^n\left(\frac{x_{i m_i}}{\beta^2}-\frac{\alpha t_{i m_i}}{\beta}\right)=0</span>
<span id="cb52-460"><a href="#cb52-460"></a>\end{array}\right.</span>
<span id="cb52-461"><a href="#cb52-461"></a>$$ 式中 $\psi(u)$ 是 digamma 函数。 $$</span>
<span id="cb52-462"><a href="#cb52-462"></a>\begin{aligned}</span>
<span id="cb52-463"><a href="#cb52-463"></a>&amp;\hat{\beta}=\frac{\sum_{i=1}^n X_{i m_i}}{\alpha \sum_{i=1}^n t_{i m_i}}<span class="sc">\\</span></span>
<span id="cb52-464"><a href="#cb52-464"></a>&amp;\sum_{i=1}^n\left<span class="co">[</span><span class="ot">\sum_{j=1}^{m_i} \Delta t_{i j} \ln \left(\Delta x_{i j}\right)-t_{i m_i} \ln \frac{x_{i m_i}}{\alpha t_{i m_i}}-\sum_{j=1}^{m_i} \Delta t_{i j} \psi\left(\alpha \Delta t_{i j}\right)\right</span><span class="co">]</span>=0</span>
<span id="cb52-465"><a href="#cb52-465"></a>\end{aligned}</span>
<span id="cb52-466"><a href="#cb52-466"></a>$$</span>
<span id="cb52-467"><a href="#cb52-467"></a></span>
<span id="cb52-468"><a href="#cb52-468"></a></span>
<span id="cb52-469"><a href="#cb52-469"></a><span class="fu"># 4 案例分析</span></span>
<span id="cb52-470"><a href="#cb52-470"></a></span>
<span id="cb52-471"><a href="#cb52-471"></a><span class="fu">## 4.1 维纳过程相关</span></span>
<span id="cb52-472"><a href="#cb52-472"></a></span>
<span id="cb52-473"><a href="#cb52-473"></a><span class="fu">### 4.1.1 NASA 锂电池数据</span></span>
<span id="cb52-474"><a href="#cb52-474"></a></span>
<span id="cb52-475"><a href="#cb52-475"></a><span class="at">&gt; 数据来源于</span><span class="co">[</span><span class="ot">NASA Ames Prognostics Center of Excellence (PCoE)</span><span class="co">](https://c3.ndc.nasa.gov/dashlink/resources/133/)</span><span class="at">，但是找不到数据下载。最后是通过 </span><span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/psanabriaUC/BatteryDatasetImplementation)</span><span class="at"> 获得。</span></span>
<span id="cb52-476"><a href="#cb52-476"></a></span>
<span id="cb52-477"><a href="#cb52-477"></a>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即**充电**、**放电**和**测量 EIS**。</span>
<span id="cb52-478"><a href="#cb52-478"></a></span>
<span id="cb52-479"><a href="#cb52-479"></a>充电是以**恒流模**式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以**恒压模式**(CV)继续充电直到电流降到 20mA。</span>
<span id="cb52-480"><a href="#cb52-480"></a></span>
<span id="cb52-481"><a href="#cb52-481"></a>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</span>
<span id="cb52-482"><a href="#cb52-482"></a></span>
<span id="cb52-483"><a href="#cb52-483"></a>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</span>
<span id="cb52-484"><a href="#cb52-484"></a></span>
<span id="cb52-487"><a href="#cb52-487"></a><span class="in">```{r}</span></span>
<span id="cb52-488"><a href="#cb52-488"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb52-489"><a href="#cb52-489"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span>
<span id="cb52-490"><a href="#cb52-490"></a><span class="in">```</span></span>
<span id="cb52-491"><a href="#cb52-491"></a></span>
<span id="cb52-494"><a href="#cb52-494"></a><span class="in">```{r}</span></span>
<span id="cb52-495"><a href="#cb52-495"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-496"><a href="#cb52-496"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb52-497"><a href="#cb52-497"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-498"><a href="#cb52-498"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-499"><a href="#cb52-499"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span>
<span id="cb52-500"><a href="#cb52-500"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb52-501"><a href="#cb52-501"></a><span class="in">```</span></span>
<span id="cb52-502"><a href="#cb52-502"></a></span>
<span id="cb52-503"><a href="#cb52-503"></a>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</span>
<span id="cb52-504"><a href="#cb52-504"></a></span>
<span id="cb52-507"><a href="#cb52-507"></a><span class="in">```{r}</span></span>
<span id="cb52-508"><a href="#cb52-508"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb52-509"><a href="#cb52-509"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb52-510"><a href="#cb52-510"></a></span>
<span id="cb52-511"><a href="#cb52-511"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb52-512"><a href="#cb52-512"></a></span>
<span id="cb52-513"><a href="#cb52-513"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-514"><a href="#cb52-514"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb52-515"><a href="#cb52-515"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-516"><a href="#cb52-516"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-517"><a href="#cb52-517"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb52-518"><a href="#cb52-518"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb52-519"><a href="#cb52-519"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb52-520"><a href="#cb52-520"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-521"><a href="#cb52-521"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-522"><a href="#cb52-522"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-523"><a href="#cb52-523"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span>
<span id="cb52-524"><a href="#cb52-524"></a><span class="in">```</span></span>
<span id="cb52-525"><a href="#cb52-525"></a></span>
<span id="cb52-526"><a href="#cb52-526"></a>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</span>
<span id="cb52-527"><a href="#cb52-527"></a></span>
<span id="cb52-530"><a href="#cb52-530"></a><span class="in">```{r}</span></span>
<span id="cb52-531"><a href="#cb52-531"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-532"><a href="#cb52-532"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb52-533"><a href="#cb52-533"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb52-534"><a href="#cb52-534"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb52-535"><a href="#cb52-535"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb52-536"><a href="#cb52-536"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span>
<span id="cb52-537"><a href="#cb52-537"></a><span class="in">```</span></span>
<span id="cb52-538"><a href="#cb52-538"></a></span>
<span id="cb52-541"><a href="#cb52-541"></a><span class="in">```{r}</span></span>
<span id="cb52-542"><a href="#cb52-542"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb52-543"><a href="#cb52-543"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-544"><a href="#cb52-544"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb52-545"><a href="#cb52-545"></a>mle_par</span>
<span id="cb52-546"><a href="#cb52-546"></a><span class="in">```</span></span>
<span id="cb52-547"><a href="#cb52-547"></a></span>
<span id="cb52-548"><a href="#cb52-548"></a>计算可靠度并绘图</span>
<span id="cb52-549"><a href="#cb52-549"></a></span>
<span id="cb52-552"><a href="#cb52-552"></a><span class="in">```{r}</span></span>
<span id="cb52-553"><a href="#cb52-553"></a><span class="co"># 计算可靠度</span></span>
<span id="cb52-554"><a href="#cb52-554"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span>
<span id="cb52-555"><a href="#cb52-555"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb52-556"><a href="#cb52-556"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb52-557"><a href="#cb52-557"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb52-558"><a href="#cb52-558"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb52-559"><a href="#cb52-559"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb52-560"><a href="#cb52-560"></a>}</span>
<span id="cb52-561"><a href="#cb52-561"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb52-562"><a href="#cb52-562"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb52-563"><a href="#cb52-563"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb52-564"><a href="#cb52-564"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb52-565"><a href="#cb52-565"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb52-566"><a href="#cb52-566"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-567"><a href="#cb52-567"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb52-568"><a href="#cb52-568"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-569"><a href="#cb52-569"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-570"><a href="#cb52-570"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span>
<span id="cb52-571"><a href="#cb52-571"></a><span class="in">```</span></span>
<span id="cb52-572"><a href="#cb52-572"></a></span>
<span id="cb52-573"><a href="#cb52-573"></a><span class="fu">### 4.1.2 激光器件 Laser 数据集</span></span>
<span id="cb52-574"><a href="#cb52-574"></a></span>
<span id="cb52-575"><a href="#cb52-575"></a><span class="at">&gt; 数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</span></span>
<span id="cb52-576"><a href="#cb52-576"></a></span>
<span id="cb52-577"><a href="#cb52-577"></a>激光器件的质量特征是其**工作电流**。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</span>
<span id="cb52-578"><a href="#cb52-578"></a></span>
<span id="cb52-581"><a href="#cb52-581"></a><span class="in">```{r}</span></span>
<span id="cb52-582"><a href="#cb52-582"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb52-583"><a href="#cb52-583"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span>
<span id="cb52-584"><a href="#cb52-584"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span>
<span id="cb52-585"><a href="#cb52-585"></a><span class="in">```</span></span>
<span id="cb52-586"><a href="#cb52-586"></a></span>
<span id="cb52-589"><a href="#cb52-589"></a><span class="in">```{r}</span></span>
<span id="cb52-590"><a href="#cb52-590"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb52-591"><a href="#cb52-591"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-592"><a href="#cb52-592"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-593"><a href="#cb52-593"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-594"><a href="#cb52-594"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-595"><a href="#cb52-595"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb52-596"><a href="#cb52-596"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-597"><a href="#cb52-597"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb52-598"><a href="#cb52-598"></a><span class="in">```</span></span>
<span id="cb52-599"><a href="#cb52-599"></a></span>
<span id="cb52-602"><a href="#cb52-602"></a><span class="in">```{r}</span></span>
<span id="cb52-603"><a href="#cb52-603"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb52-604"><a href="#cb52-604"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb52-605"><a href="#cb52-605"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb52-606"><a href="#cb52-606"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span>
<span id="cb52-607"><a href="#cb52-607"></a><span class="in">```</span></span>
<span id="cb52-608"><a href="#cb52-608"></a></span>
<span id="cb52-611"><a href="#cb52-611"></a><span class="in">```{r}</span></span>
<span id="cb52-612"><a href="#cb52-612"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb52-613"><a href="#cb52-613"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-614"><a href="#cb52-614"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb52-615"><a href="#cb52-615"></a>mle_par</span>
<span id="cb52-616"><a href="#cb52-616"></a><span class="in">```</span></span>
<span id="cb52-617"><a href="#cb52-617"></a></span>
<span id="cb52-618"><a href="#cb52-618"></a>计算可靠度并绘图，阈值设置参考 Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety **193**. 第6节案例分析</span>
<span id="cb52-619"><a href="#cb52-619"></a></span>
<span id="cb52-620"><a href="#cb52-620"></a>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</span>
<span id="cb52-621"><a href="#cb52-621"></a></span>
<span id="cb52-622"><a href="#cb52-622"></a><span class="at">&gt; 可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</span></span>
<span id="cb52-623"><a href="#cb52-623"></a></span>
<span id="cb52-626"><a href="#cb52-626"></a><span class="in">```{r}</span></span>
<span id="cb52-627"><a href="#cb52-627"></a><span class="co"># 计算可靠度</span></span>
<span id="cb52-628"><a href="#cb52-628"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb52-629"><a href="#cb52-629"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb52-630"><a href="#cb52-630"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb52-631"><a href="#cb52-631"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb52-632"><a href="#cb52-632"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb52-633"><a href="#cb52-633"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb52-634"><a href="#cb52-634"></a>}</span>
<span id="cb52-635"><a href="#cb52-635"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb52-636"><a href="#cb52-636"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb52-637"><a href="#cb52-637"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb52-638"><a href="#cb52-638"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb52-639"><a href="#cb52-639"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb52-640"><a href="#cb52-640"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-641"><a href="#cb52-641"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb52-642"><a href="#cb52-642"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-643"><a href="#cb52-643"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb52-644"><a href="#cb52-644"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb52-645"><a href="#cb52-645"></a></span>
<span id="cb52-646"><a href="#cb52-646"></a><span class="in">```</span></span>
<span id="cb52-647"><a href="#cb52-647"></a></span>
<span id="cb52-648"><a href="#cb52-648"></a><span class="fu">### 4.1.3 炭膜电阻器 carbon-film resistors</span></span>
<span id="cb52-649"><a href="#cb52-649"></a></span>
<span id="cb52-650"><a href="#cb52-650"></a><span class="at">&gt; 退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</span></span>
<span id="cb52-651"><a href="#cb52-651"></a></span>
<span id="cb52-652"><a href="#cb52-652"></a>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</span>
<span id="cb52-653"><a href="#cb52-653"></a></span>
<span id="cb52-654"><a href="#cb52-654"></a>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</span>
<span id="cb52-655"><a href="#cb52-655"></a></span>
<span id="cb52-658"><a href="#cb52-658"></a><span class="in">```{r}</span></span>
<span id="cb52-659"><a href="#cb52-659"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb52-660"><a href="#cb52-660"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span>
<span id="cb52-661"><a href="#cb52-661"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb52-662"><a href="#cb52-662"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span>
<span id="cb52-663"><a href="#cb52-663"></a><span class="in">```</span></span>
<span id="cb52-664"><a href="#cb52-664"></a></span>
<span id="cb52-667"><a href="#cb52-667"></a><span class="in">```{r}</span></span>
<span id="cb52-668"><a href="#cb52-668"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb52-669"><a href="#cb52-669"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-670"><a href="#cb52-670"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb52-671"><a href="#cb52-671"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-672"><a href="#cb52-672"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-673"><a href="#cb52-673"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-674"><a href="#cb52-674"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-675"><a href="#cb52-675"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb52-676"><a href="#cb52-676"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-677"><a href="#cb52-677"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb52-678"><a href="#cb52-678"></a><span class="in">```</span></span>
<span id="cb52-679"><a href="#cb52-679"></a></span>
<span id="cb52-680"><a href="#cb52-680"></a>后续参数估计和可靠度估计就先不做了。</span>
<span id="cb52-681"><a href="#cb52-681"></a></span>
<span id="cb52-682"><a href="#cb52-682"></a>类似的数据集还包括：</span>
<span id="cb52-683"><a href="#cb52-683"></a></span>
<span id="cb52-684"><a href="#cb52-684"></a><span class="fu">### 4.1.4 惯导平台 interial navigition 数据</span></span>
<span id="cb52-685"><a href="#cb52-685"></a></span>
<span id="cb52-686"><a href="#cb52-686"></a><span class="at">&gt; 数据来自于文献：Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability **61**(1): 50-67.</span></span>
<span id="cb52-687"><a href="#cb52-687"></a></span>
<span id="cb52-688"><a href="#cb52-688"></a>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</span>
<span id="cb52-689"><a href="#cb52-689"></a></span>
<span id="cb52-690"><a href="#cb52-690"></a>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</span>
<span id="cb52-691"><a href="#cb52-691"></a></span>
<span id="cb52-692"><a href="#cb52-692"></a>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</span>
<span id="cb52-693"><a href="#cb52-693"></a></span>
<span id="cb52-694"><a href="#cb52-694"></a><span class="al">![](images/paste-40CEA295.png)</span></span>
<span id="cb52-695"><a href="#cb52-695"></a></span>
<span id="cb52-698"><a href="#cb52-698"></a><span class="in">```{r}</span></span>
<span id="cb52-699"><a href="#cb52-699"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb52-700"><a href="#cb52-700"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span>
<span id="cb52-701"><a href="#cb52-701"></a><span class="in">```</span></span>
<span id="cb52-702"><a href="#cb52-702"></a></span>
<span id="cb52-703"><a href="#cb52-703"></a>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</span>
<span id="cb52-704"><a href="#cb52-704"></a></span>
<span id="cb52-707"><a href="#cb52-707"></a><span class="in">```{r}</span></span>
<span id="cb52-708"><a href="#cb52-708"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb52-709"><a href="#cb52-709"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb52-710"><a href="#cb52-710"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb52-711"><a href="#cb52-711"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb52-712"><a href="#cb52-712"></a></span>
<span id="cb52-713"><a href="#cb52-713"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb52-714"><a href="#cb52-714"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb52-715"><a href="#cb52-715"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb52-716"><a href="#cb52-716"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb52-717"><a href="#cb52-717"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb52-718"><a href="#cb52-718"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb52-719"><a href="#cb52-719"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb52-720"><a href="#cb52-720"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb52-721"><a href="#cb52-721"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb52-722"><a href="#cb52-722"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-723"><a href="#cb52-723"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb52-724"><a href="#cb52-724"></a><span class="in">```</span></span>
<span id="cb52-725"><a href="#cb52-725"></a></span>
<span id="cb52-726"><a href="#cb52-726"></a><span class="fu">### 4.1.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</span></span>
<span id="cb52-727"><a href="#cb52-727"></a></span>
<span id="cb52-728"><a href="#cb52-728"></a><span class="at">&gt; 数据来自： (Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability 61(1): 50-67).</span></span>
<span id="cb52-729"><a href="#cb52-729"></a></span>
<span id="cb52-730"><a href="#cb52-730"></a>它是飞机上常用的金属材料，这种材料的完整性通过**疲劳裂纹的长度**来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</span>
<span id="cb52-731"><a href="#cb52-731"></a></span>
<span id="cb52-732"><a href="#cb52-732"></a>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。**退化过程存在非线性**。</span>
<span id="cb52-733"><a href="#cb52-733"></a></span>
<span id="cb52-736"><a href="#cb52-736"></a><span class="in">```{r}</span></span>
<span id="cb52-737"><a href="#cb52-737"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb52-738"><a href="#cb52-738"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span>
<span id="cb52-739"><a href="#cb52-739"></a><span class="in">```</span></span>
<span id="cb52-740"><a href="#cb52-740"></a></span>
<span id="cb52-743"><a href="#cb52-743"></a><span class="in">```{r}</span></span>
<span id="cb52-744"><a href="#cb52-744"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb52-745"><a href="#cb52-745"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb52-746"><a href="#cb52-746"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb52-747"><a href="#cb52-747"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb52-748"><a href="#cb52-748"></a></span>
<span id="cb52-749"><a href="#cb52-749"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb52-750"><a href="#cb52-750"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb52-751"><a href="#cb52-751"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb52-752"><a href="#cb52-752"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb52-753"><a href="#cb52-753"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-754"><a href="#cb52-754"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb52-755"><a href="#cb52-755"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb52-756"><a href="#cb52-756"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb52-757"><a href="#cb52-757"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-758"><a href="#cb52-758"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb52-759"><a href="#cb52-759"></a><span class="in">```</span></span>
<span id="cb52-760"><a href="#cb52-760"></a></span>
<span id="cb52-761"><a href="#cb52-761"></a></span>
<span id="cb52-762"><a href="#cb52-762"></a><span class="fu">## 伽马过程相关</span></span>
<span id="cb52-763"><a href="#cb52-763"></a></span>
<span id="cb52-764"><a href="#cb52-764"></a><span class="fu">#### 4.4.1 wear data</span></span>
<span id="cb52-765"><a href="#cb52-765"></a></span>
<span id="cb52-766"><a href="#cb52-766"></a><span class="at">&gt; 数据来自： Ye Z.S., et al. (2014). "Semiparametric Estimation of Gamma Processes for Deteriorating Products" Technometrics</span></span>
<span id="cb52-767"><a href="#cb52-767"></a></span>
<span id="cb52-768"><a href="#cb52-768"></a>Wear of a tire tread is a major cause of tire failures. To assess the wear behavior of a batch of tire treads from a factory, a bus park in South Korea sampled some tires installed on buses of the same version. Degradation level of each tire was measured, and its time in service (in thousands of kilometers) was retrospected.</span>
<span id="cb52-769"><a href="#cb52-769"></a></span>
<span id="cb52-772"><a href="#cb52-772"></a><span class="in">```{r}</span></span>
<span id="cb52-773"><a href="#cb52-773"></a>wear_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/wear data.csv"</span>)</span>
<span id="cb52-774"><a href="#cb52-774"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wear_dat))</span>
<span id="cb52-775"><a href="#cb52-775"></a>wear_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(wear_dat<span class="sc">$</span>Unit)</span>
<span id="cb52-776"><a href="#cb52-776"></a><span class="in">```</span></span>
<span id="cb52-777"><a href="#cb52-777"></a></span>
<span id="cb52-780"><a href="#cb52-780"></a><span class="in">```{r}</span></span>
<span id="cb52-781"><a href="#cb52-781"></a>wear_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,wear,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb52-782"><a href="#cb52-782"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-783"><a href="#cb52-783"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-784"><a href="#cb52-784"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-785"><a href="#cb52-785"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-786"><a href="#cb52-786"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-787"><a href="#cb52-787"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-788"><a href="#cb52-788"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span>
<span id="cb52-789"><a href="#cb52-789"></a><span class="in">```</span></span>
<span id="cb52-790"><a href="#cb52-790"></a></span>
<span id="cb52-791"><a href="#cb52-791"></a><span class="fu">#### 4.4.2 Crack of Titanium</span></span>
<span id="cb52-792"><a href="#cb52-792"></a></span>
<span id="cb52-793"><a href="#cb52-793"></a>A manufacturer of Titanium (Ti) Grade has the highest ultimate strength of the pure Ti Grades. It is used in many applications where high strength is required. However, under high stress and high cycle fatigue, it develops cracks that lead to failures. In order to conduct a RDT, the manufacturer machined 10 bars with 0.5" diameter and subjected them to high stress and made notches (of the same dimensions) in all the bars to accelerate the crack growth. The crack length is measured every five days and is recoded for the ten units as shown in Table 6.10. The measurements are expressed in 0.001 mm but scaled for calculation purposes. Determine the number of days when the crack threshold reaches 2mm (1500 in the measurement scale)</span>
<span id="cb52-794"><a href="#cb52-794"></a></span>
<span id="cb52-797"><a href="#cb52-797"></a><span class="in">```{r}</span></span>
<span id="cb52-798"><a href="#cb52-798"></a>ti_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Crack_Length_Data_of_Ten_Bar_of_Ti.csv"</span>)</span>
<span id="cb52-799"><a href="#cb52-799"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(ti_dat))</span>
<span id="cb52-800"><a href="#cb52-800"></a>ti_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(ti_dat<span class="sc">$</span>Unit)</span>
<span id="cb52-801"><a href="#cb52-801"></a><span class="in">```</span></span>
<span id="cb52-802"><a href="#cb52-802"></a></span>
<span id="cb52-805"><a href="#cb52-805"></a><span class="in">```{r}</span></span>
<span id="cb52-806"><a href="#cb52-806"></a>ti_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,crack_length,<span class="at">color =</span> Unit)) <span class="sc">+</span></span>
<span id="cb52-807"><a href="#cb52-807"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-808"><a href="#cb52-808"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-809"><a href="#cb52-809"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-810"><a href="#cb52-810"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-811"><a href="#cb52-811"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-812"><a href="#cb52-812"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-813"><a href="#cb52-813"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span>
<span id="cb52-814"><a href="#cb52-814"></a><span class="in">```</span></span>
<span id="cb52-815"><a href="#cb52-815"></a></span>
<span id="cb52-816"><a href="#cb52-816"></a><span class="fu">#### 4.4.3 Lithium-ion batteries</span></span>
<span id="cb52-817"><a href="#cb52-817"></a></span>
<span id="cb52-818"><a href="#cb52-818"></a>Lithium-ion batteries are widely used in many applications and consumer products including electric vehicles because of their high energy density and power capability. However, the long-term performance (capacity to provide the power) decreases with number of charge and discharge cycles. A degradation test is conducted on four battery cells with initial capacities in Ah (Ampere hours, which is defined as is the amount of energy charge in a battery that will allow one ampere of current to flow for one hour). The cells are discharged and charged, and the battery capacity is measured after the accumulation of a number of charge-discharge cycles. The battery is considered failed when its capacity is $80 \%$ of the original capacity. Use the first 25 observations of each cell and develop a general degradation model. Then utilize the model to predict the capacities at the remaining 17 cycles and calculate the error prediction of the models. Note that the original capacity corresponds to zero cycles.</span>
<span id="cb52-819"><a href="#cb52-819"></a></span>
<span id="cb52-822"><a href="#cb52-822"></a><span class="in">```{r}</span></span>
<span id="cb52-823"><a href="#cb52-823"></a>li_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Lithium-ion batteries.csv"</span>)</span>
<span id="cb52-824"><a href="#cb52-824"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(li_dat))</span>
<span id="cb52-825"><a href="#cb52-825"></a><span class="co"># ti_dat$Unit = as.factor(li_dat$Unit)</span></span>
<span id="cb52-826"><a href="#cb52-826"></a><span class="in">```</span></span>
<span id="cb52-827"><a href="#cb52-827"></a></span>
<span id="cb52-830"><a href="#cb52-830"></a><span class="in">```{r}</span></span>
<span id="cb52-831"><a href="#cb52-831"></a>li_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>,Cell<span class="fl">.2</span>,Cell<span class="fl">.3</span>,Cell<span class="fl">.4</span>)) <span class="sc">+</span></span>
<span id="cb52-832"><a href="#cb52-832"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.1</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.2</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-833"><a href="#cb52-833"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.3</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(cycles,Cell<span class="fl">.4</span>),<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-834"><a href="#cb52-834"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-835"><a href="#cb52-835"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-836"><a href="#cb52-836"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-837"><a href="#cb52-837"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-838"><a href="#cb52-838"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-839"><a href="#cb52-839"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"time"</span>, <span class="at">y =</span> <span class="st">"crack length"</span>)</span>
<span id="cb52-840"><a href="#cb52-840"></a><span class="in">```</span></span>
<span id="cb52-841"><a href="#cb52-841"></a></span>
<span id="cb52-842"><a href="#cb52-842"></a><span class="fu">#### 4.4.4 fatigue crack data</span></span>
<span id="cb52-843"><a href="#cb52-843"></a></span>
<span id="cb52-844"><a href="#cb52-844"></a><span class="at">&gt; 数据来自： Meeker, W. Q. (1998). Statistical Methods for Reliability Data</span></span>
<span id="cb52-845"><a href="#cb52-845"></a></span>
<span id="cb52-846"><a href="#cb52-846"></a>Fatigue Crack-Size Data gives the size of fatigue cracks as a function of number of cycles of applied stress for 21 test specimens. The data were collected to obtain information on crack growth rates for the alloy. Usually, we will refer to these data as Alloy-A and assume that a crack of size $1.6$ inches is considered to be a failure.</span>
<span id="cb52-847"><a href="#cb52-847"></a></span>
<span id="cb52-848"><a href="#cb52-848"></a><span class="al">![](images/Fatigue%20Crack%20Growth%20Data.jpg)</span></span>
<span id="cb52-849"><a href="#cb52-849"></a></span>
<span id="cb52-852"><a href="#cb52-852"></a><span class="in">```{r}</span></span>
<span id="cb52-853"><a href="#cb52-853"></a>fatigue_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Fatigue Crack Growth Data.csv"</span>)</span>
<span id="cb52-854"><a href="#cb52-854"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(fatigue_dat))</span>
<span id="cb52-855"><a href="#cb52-855"></a>fatigue_dat<span class="sc">$</span>path <span class="ot">=</span> <span class="fu">as.factor</span>(fatigue_dat<span class="sc">$</span>path)</span>
<span id="cb52-856"><a href="#cb52-856"></a><span class="in">```</span></span>
<span id="cb52-857"><a href="#cb52-857"></a></span>
<span id="cb52-860"><a href="#cb52-860"></a><span class="in">```{r}</span></span>
<span id="cb52-861"><a href="#cb52-861"></a>fatigue_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cycles,crack,<span class="at">color =</span> path)) <span class="sc">+</span></span>
<span id="cb52-862"><a href="#cb52-862"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb52-863"><a href="#cb52-863"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb52-864"><a href="#cb52-864"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-865"><a href="#cb52-865"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-866"><a href="#cb52-866"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-867"><a href="#cb52-867"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb52-868"><a href="#cb52-868"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"cycles"</span>, <span class="at">y =</span> <span class="st">"crack"</span>)</span>
<span id="cb52-869"><a href="#cb52-869"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>