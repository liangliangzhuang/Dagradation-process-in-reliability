<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="庄亮亮">

<title>逆高斯退化过程</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="IG-notebook_files/libs/clipboard/clipboard.min.js"></script>
<script src="IG-notebook_files/libs/quarto-html/quarto.js"></script>
<script src="IG-notebook_files/libs/quarto-html/popper.min.js"></script>
<script src="IG-notebook_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="IG-notebook_files/libs/quarto-html/anchor.min.js"></script>
<link href="IG-notebook_files/libs/quarto-html/tippy.css" rel="stylesheet">
<script src="IG-notebook_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="IG-notebook_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="IG-notebook_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#ig-退化过程模型" id="toc-ig-退化过程模型" class="nav-link active" data-scroll-target="#ig-退化过程模型">3. IG 退化过程模型</a>
  <ul>
  <li><a href="#经典的-ig-过程" id="toc-经典的-ig-过程" class="nav-link" data-scroll-target="#经典的-ig-过程">3.1 经典的 IG 过程</a>
  <ul>
  <li><a href="#统计推断" id="toc-统计推断" class="nav-link" data-scroll-target="#统计推断">3.1.2 统计推断</a>
  <ul class="collapse">
  <li><a href="#极大似然估计" id="toc-极大似然估计" class="nav-link" data-scroll-target="#极大似然估计">3.1.2.1 极大似然估计</a></li>
  <li><a href="#贝叶斯估计" id="toc-贝叶斯估计" class="nav-link" data-scroll-target="#贝叶斯估计">3.1.2.2 贝叶斯估计</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#模拟数据分析" id="toc-模拟数据分析" class="nav-link" data-scroll-target="#模拟数据分析">3.3 模拟数据分析</a>
  <ul>
  <li><a href="#数据模拟产生" id="toc-数据模拟产生" class="nav-link" data-scroll-target="#数据模拟产生">数据模拟产生</a></li>
  <li><a href="#绘制退化路径图" id="toc-绘制退化路径图" class="nav-link" data-scroll-target="#绘制退化路径图">绘制退化路径图</a></li>
  <li><a href="#极大似然估计-1" id="toc-极大似然估计-1" class="nav-link" data-scroll-target="#极大似然估计-1">极大似然估计</a></li>
  <li><a href="#可靠度和-rul-计算" id="toc-可靠度和-rul-计算" class="nav-link" data-scroll-target="#可靠度和-rul-计算">可靠度和 RUL 计算</a></li>
  </ul></li>
  <li><a href="#激光器件-laser-数据集" id="toc-激光器件-laser-数据集" class="nav-link" data-scroll-target="#激光器件-laser-数据集">激光器件 Laser 数据集</a></li>
  <li><a href="#防辐射-anti-radiation-数据集" id="toc-防辐射-anti-radiation-数据集" class="nav-link" data-scroll-target="#防辐射-anti-radiation-数据集">防辐射 Anti-radiation 数据集</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">逆高斯退化过程</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>庄亮亮 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="ig-退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="ig-退化过程模型">3. IG 退化过程模型</h2>
<!-- > 来源：Ye, Z.-S. and M. Xie (2015). "Stochastic modelling and analysis of degradation for highly reliable products." Applied Stochastic Models in Business and Industry 31(1): 16-32. -->
<p>虽然 Wiener 过程和 Gamma 过程在退化建模中得到了广泛的应用，但这两种模型在实际应用中无法拟合大量退化数据。当这两个过程失败时，另一个选择是逆高斯(inverse Gaussian, IG)过程。</p>
<section id="经典的-ig-过程" class="level3">
<h3 class="anchored" data-anchor-id="经典的-ig-过程">3.1 经典的 IG 过程</h3>
<p>设<span class="math inline">\(X(t)\)</span>为产品在<span class="math inline">\(t\)</span>时刻的退化特性。假设退化路径<span class="math inline">\(X(t)\)</span>可以用参数<span class="math inline">\(\mu\)</span>和<span class="math inline">\(\lambda\)</span>的IG过程来建模。此时，<span class="math inline">\(X(t)\)</span>具有以下属性:</p>
<ul>
<li><span class="math inline">\(X(0)=0\)</span>，概率为1;</li>
<li>对于 <span class="math inline">\(t&gt;s&gt;u, X(t)-X(s) \geq 0, X(s)-X(u) \geq 0\)</span>, <span class="math inline">\(X(t)-X(s)\)</span> 与 <span class="math inline">\(X(s)-X(u)\)</span> 相互独立;</li>
<li>对于 <span class="math inline">\(t&gt;s \geq 0\)</span>, 每个增量 <span class="math inline">\(X(t)-X(s)\)</span> 都服从 IG 分布 <span class="math inline">\(I G\left(\mu (t-s), \lambda(t-s)^2\right)\)</span>。</li>
</ul>
<p>IG 分布的概率密度函数(pdf) <span class="math inline">\(I G(a, b)\)</span>为 <span class="math display">\[
f_{I G}(x, a, b)=\left[\frac{b}{2 \pi x^3}\right]^{1 / 2} \exp \left\{-\frac{b(x-a)^2}{2 a^2 x}\right\}
\]</span> 累计分布函数（cdf）为 <span class="math display">\[
F_{IG}(x, a, b)=\Phi\left[\sqrt{\frac{b}{x}}\left(\frac{x}{a}-1\right)\right]+\exp \left(\frac{2 b}{a}\right) \Phi\left[-\sqrt{\frac{b}{x}}\left(\frac{x}{a}+1\right)\right], X&gt;0 .
\]</span></p>
<p><strong>产品寿命/首达时分布</strong></p>
<p>令 <span class="math inline">\(T\)</span> 为<span class="math inline">\(X(t)\)</span>越过临界值<span class="math inline">\(l\)</span>的首达时。此时，我们有 <span class="math display">\[
T=\inf \{t \mid X(t) \geq l, t&gt;0\} .
\]</span> 对于给定的<span class="math inline">\(l\)</span>，生命周期<span class="math inline">\(T\)</span>具有以下 cdf</p>
<p><span class="math display">\[
\begin{aligned}
F(t) &amp;=P(T \leq t)=P(X(t)&gt;l)=1-F_{I G}\left(l ; \mu t, \lambda t^2\right) \\
&amp;=\Phi\left[ \sqrt{\frac{\lambda}{l}}(t - \frac{l}{\mu})
\right] - \exp\left({\frac{2 \lambda t}{\mu}}\right) \Phi\left[-\sqrt{\frac{\lambda}{l}}(\frac{l}{\mu} +t)\right]
\end{aligned}\]</span></p>
<p>其中 <span class="math inline">\(\Phi(\cdot)\)</span> 为标准正态分布的cdf。</p>
<p><strong>剩余使用寿命</strong></p>
<p>假设其运行到时刻 <span class="math inline">\(\tau\)</span> 仍末失效, 且当前性能退化量为 <span class="math inline">\(x_\tau\left(x_\tau&lt;l\right)\)</span>, 则产品的剩余寿命 <span class="math inline">\(T_1\)</span> 可以表示为 <span class="math display">\[
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
\]</span> 其密度函数只需将寿命 <span class="math inline">\(T\)</span> 密度函数中的失效阈值 <span class="math inline">\(l\)</span> 替换为 <span class="math inline">\(l-x_\tau\)</span>, 即</p>
<p><span class="math display">\[
\begin{aligned}
F_{T_1}(t) = \Phi\left[ \sqrt{\frac{\lambda}{l-x_\tau}}(t - \frac{l}{\mu})
\right] - \exp\left({\frac{2 \lambda t}{\mu}}\right) \Phi\left[-\sqrt{\frac{\lambda}{l-x_\tau}}(\frac{l-x_\tau}{\mu} +t)\right]
\end{aligned}\]</span></p>
<p><span class="math display">\[
\begin{aligned}
f_{T_1}(t)= &amp; \phi\left(\sqrt{\frac{\lambda}{l-x_\tau}}\left(t-\frac{l}{\mu}\right)\right) \cdot \sqrt{\frac{\lambda}{l-x_\tau}}-\frac{2 \lambda}{\mu} \exp \left(\frac{2 \lambda t}{\mu}\right) \Phi\left(-\sqrt{\frac{\lambda}{l-x_\tau}}\left(\frac{l-x_\tau}{\mu}+t\right)\right) \\
&amp; +\exp \left(\frac{2 \lambda t}{\mu}\right) \phi\left(-\sqrt{\frac{\lambda}{l-x_\tau}}\left(\frac{l-x_\tau}{\mu}+t\right)\right) \cdot \sqrt{\frac{\lambda}{l-x_\tau}}
\end{aligned}
\]</span></p>
<section id="统计推断" class="level4">
<h4 class="anchored" data-anchor-id="统计推断">3.1.2 统计推断</h4>
<p>令<span class="math inline">\(X\left(t_{ij}\right)\)</span>为第<span class="math inline">\(i\)</span>个测试单元在<span class="math inline">\(t_{ij}\)</span>时刻测量的退化特性，其中<span class="math inline">\(i=1， \ldots, n\)</span>和<span class="math inline">\(j=\)</span> <span class="math inline">\(1， \ldots, m_i\)</span>。</p>
<section id="极大似然估计" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计">3.1.2.1 极大似然估计</h5>
<p>根据<span class="math inline">\(\Delta x_{ij}=X\left(t_{ij}\right)-X\left(t_{ij -1}\right)， i=1， \ldots n, j=1， \ldots, m_i\)</span>， <span class="math inline">\((\mu, \lambda)\)</span>的似然函数为 <span class="math display">\[
L(\mu, \lambda)=\prod_{i=1}^n \prod_{j=1}^{m_i} f_{I G}\left(\Delta x_{i j}, \mu \Delta t_{i j}, \lambda \Delta^2 t_{i j}\right).
\]</span> 对数似然函数为： <span class="math display">\[
\log L(\mu, \lambda) \propto \sum_{i=1}^n \sum_{j=1}^{m_i}\left(\frac{1}{2} \log (\lambda)+\log \Delta t_{i j}-\frac{3}{2} \log \left(\Delta x_{i j}\right)-\frac{\lambda\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \mu^2 \Delta x_{i j}}\right)
\]</span></p>
</section>
<section id="贝叶斯估计" class="level5">
<h5 class="anchored" data-anchor-id="贝叶斯估计">3.1.2.2 贝叶斯估计</h5>
</section>
</section>
</section>
<section id="模拟数据分析" class="level3">
<h3 class="anchored" data-anchor-id="模拟数据分析">3.3 模拟数据分析</h3>
<section id="数据模拟产生" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生">数据模拟产生</h4>
</section>
<section id="绘制退化路径图" class="level4">
<h4 class="anchored" data-anchor-id="绘制退化路径图">绘制退化路径图</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>) <span class="co">#eta,lambda</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb1-5"><a href="#cb1-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.71899</td>
<td style="text-align: right;">1.181833</td>
<td style="text-align: right;">3.637834</td>
<td style="text-align: right;">12.36443</td>
<td style="text-align: right;">5.900764</td>
<td style="text-align: right;">4.635948</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">24.93780</td>
<td style="text-align: right;">4.120467</td>
<td style="text-align: right;">9.520422</td>
<td style="text-align: right;">17.78306</td>
<td style="text-align: right;">7.433567</td>
<td style="text-align: right;">6.025180</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">26.15506</td>
<td style="text-align: right;">8.252072</td>
<td style="text-align: right;">10.624956</td>
<td style="text-align: right;">20.13795</td>
<td style="text-align: right;">13.376300</td>
<td style="text-align: right;">8.568100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">36.87335</td>
<td style="text-align: right;">16.539377</td>
<td style="text-align: right;">11.724692</td>
<td style="text-align: right;">22.43925</td>
<td style="text-align: right;">18.174601</td>
<td style="text-align: right;">11.974155</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">38.38241</td>
<td style="text-align: right;">19.356215</td>
<td style="text-align: right;">13.264940</td>
<td style="text-align: right;">24.06243</td>
<td style="text-align: right;">24.946093</td>
<td style="text-align: right;">13.657555</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">plot_path</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IG-notebook_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="极大似然估计-1" class="level4">
<h4 class="anchored" data-anchor-id="极大似然估计-1">极大似然估计</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="fl">0.6</span>,<span class="dv">5</span>), <span class="at">fn =</span> IG_mle, </span>
<span id="cb3-2"><a href="#cb3-2"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>mle_re<span class="sc">$</span>par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.132646 5.180048</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># 区间估计</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up,para),<span class="dv">3</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>,<span class="st">"true"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">low</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">up</th>
<th style="text-align: right;">true</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.843</td>
<td style="text-align: right;">5.133</td>
<td style="text-align: right;">5.422</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.765</td>
<td style="text-align: right;">5.180</td>
<td style="text-align: right;">5.596</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="可靠度和-rul-计算" class="level4">
<h4 class="anchored" data-anchor-id="可靠度和-rul-计算">可靠度和 RUL 计算</h4>
<ul>
<li>可靠度</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># 给个简单例子</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">IG_R</span>(<span class="at">t =</span> <span class="dv">30</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4783045</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># 绘制带区间估计的可靠度函数（需要优化为 ggplot 绘制）</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>R_time <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>R_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"Time"</span> <span class="ot">=</span> R_time,</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="st">"Up"</span> <span class="ot">=</span> <span class="fu">IG_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up),</span>
<span id="cb8-5"><a href="#cb8-5"></a>           <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">IG_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),</span>
<span id="cb8-6"><a href="#cb8-6"></a>           <span class="st">"Low"</span> <span class="ot">=</span> <span class="fu">IG_R</span>(<span class="at">t =</span> R_time, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># 绘制带区间估计的可靠度函数</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="fu">ggplot</span>(R_data) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Up),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Mean)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Time,Low),<span class="at">color =</span> <span class="st">"gray60"</span>,<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="fu">ylab</span>(<span class="st">"Reliability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IG-notebook_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>RUL</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>  fut_time <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>  time_epoch <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">150</span>; threshold <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  para <span class="ot">=</span> mle_par</span>
<span id="cb9-4"><a href="#cb9-4"></a>  rul_den <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fut_time)){</span>
<span id="cb9-6"><a href="#cb9-6"></a>    rul_den[[i]] <span class="ot">=</span> <span class="fu">RUL</span>(<span class="at">t =</span> time_epoch, <span class="at">cur_time =</span> fut_time[i],</span>
<span id="cb9-7"><a href="#cb9-7"></a>                      <span class="at">threshold =</span> threshold, <span class="at">par =</span> para)[[<span class="dv">1</span>]]</span>
<span id="cb9-8"><a href="#cb9-8"></a>  }</span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="co"># sapply(rul_den,which.max)</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  </span>
<span id="cb9-11"><a href="#cb9-11"></a>  p <span class="ot">=</span> <span class="fu">RUL_3D_density</span>(fut_time,time_epoch,rul_den,threshold,</span>
<span id="cb9-12"><a href="#cb9-12"></a>                     <span class="at">real_RUL =</span> <span class="cn">NA</span>,<span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.08</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IG-notebook_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="激光器件-laser-数据集" class="level3">
<h3 class="anchored" data-anchor-id="激光器件-laser-数据集">激光器件 Laser 数据集</h3>
<blockquote class="blockquote">
<p>数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</p>
</blockquote>
<p>激光器件的质量特征是其<strong>工作电流</strong>。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的退化路径及其拟合的平均趋势。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9255</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1147</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7168</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5110</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1250</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IG-notebook_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="防辐射-anti-radiation-数据集" class="level3">
<h3 class="anchored" data-anchor-id="防辐射-anti-radiation-数据集">防辐射 Anti-radiation 数据集</h3>
<blockquote class="blockquote">
<p>数据来源：Song, B., et al.&nbsp;(2017). “Performance evaluation of anti-radiation based on the gamma degradation process.” Science China Technological Sciences 60(4): 501-509.</p>
</blockquote>
<blockquote class="blockquote">
<p>分析结果参考：Guan, Q., et al.&nbsp;(2019). “Reference Bayesian analysis of inverse Gaussian degradation process.” Applied Mathematical Modelling 74: 496-511.（IG + 客观贝叶斯）</p>
</blockquote>
<p>数据还未下载（文中有，具体怎么做的试验，还未学习），pdf已经存在Endnote中了。</p>
<p>Peng, W. W., et al.&nbsp;(2014). “Inverse Gaussian process models for degradation analysis: A Bayesian perspective.” Reliability Engineering &amp; System Safety <strong>130</strong>: 175-189.（贝叶斯相关）</p>
<p><br>
</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<pre class="markdown number-lines" data-shortcodes="false"><code>---
title: "逆高斯退化过程"
author: "庄亮亮"
format: 
  html:
    toc: TRUE
    toc-depth: 5
    toc-title: "目录"
    theme: cerulean
    code-tools: true
    highlight-style: cerulean.theme
    code-line-numbers: true
    code-block-bg: true
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

```{r include=FALSE}
library(ggplot2)
library(tidyverse)
library(viridis)
```



## 3. IG 退化过程模型

&lt;!-- &gt; 来源：Ye, Z.-S. and M. Xie (2015). "Stochastic modelling and analysis of degradation for highly reliable products." Applied Stochastic Models in Business and Industry 31(1): 16-32. --&gt;

虽然 Wiener 过程和 Gamma 过程在退化建模中得到了广泛的应用，但这两种模型在实际应用中无法拟合大量退化数据。当这两个过程失败时，另一个选择是逆高斯(inverse Gaussian, IG)过程。

### 3.1 经典的 IG 过程

设$X(t)$为产品在$t$时刻的退化特性。假设退化路径$X(t)$可以用参数$\mu$和$\lambda$的IG过程来建模。此时，$X(t)$具有以下属性:

-   $X(0)=0$，概率为1;
-   对于 $t&gt;s&gt;u, X(t)-X(s) \geq 0, X(s)-X(u) \geq 0$, $X(t)-X(s)$ 与 $X(s)-X(u)$ 相互独立;
-   对于 $t&gt;s \geq 0$, 每个增量 $X(t)-X(s)$ 都服从 IG 分布 $I G\left(\mu (t-s), \lambda(t-s)^2\right)$。

IG 分布的概率密度函数(pdf) $I G(a, b)$为 $$
f_{I G}(x, a, b)=\left[\frac{b}{2 \pi x^3}\right]^{1 / 2} \exp \left\{-\frac{b(x-a)^2}{2 a^2 x}\right\}
$$ 累计分布函数（cdf）为 $$
F_{IG}(x, a, b)=\Phi\left[\sqrt{\frac{b}{x}}\left(\frac{x}{a}-1\right)\right]+\exp \left(\frac{2 b}{a}\right) \Phi\left[-\sqrt{\frac{b}{x}}\left(\frac{x}{a}+1\right)\right], X&gt;0 .
$$

**产品寿命/首达时分布**

令 $T$ 为$X(t)$越过临界值$l$的首达时。此时，我们有 $$
T=\inf \{t \mid X(t) \geq l, t&gt;0\} .
$$ 对于给定的$l$，生命周期$T$具有以下 cdf

$$
\begin{aligned}
F(t) &amp;=P(T \leq t)=P(X(t)&gt;l)=1-F_{I G}\left(l ; \mu t, \lambda t^2\right) \\
&amp;=\Phi\left[ \sqrt{\frac{\lambda}{l}}(t - \frac{l}{\mu})
\right] - \exp\left({\frac{2 \lambda t}{\mu}}\right) \Phi\left[-\sqrt{\frac{\lambda}{l}}(\frac{l}{\mu} +t)\right]
\end{aligned}$$

其中 $\Phi(\cdot)$ 为标准正态分布的cdf。

**剩余使用寿命**


假设其运行到时刻 $\tau$ 仍末失效, 且当前性能退化量为 $x_\tau\left(x_\tau&lt;l\right)$, 则产品的剩余寿命 $T_1$ 可以表示为 $$
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
$$ 
其密度函数只需将寿命 $T$ 密度函数中的失效阈值 $l$ 替换为 $l-x_\tau$, 即


$$
\begin{aligned}
F_{T_1}(t) = \Phi\left[ \sqrt{\frac{\lambda}{l-x_\tau}}(t - \frac{l}{\mu})
\right] - \exp\left({\frac{2 \lambda t}{\mu}}\right) \Phi\left[-\sqrt{\frac{\lambda}{l-x_\tau}}(\frac{l-x_\tau}{\mu} +t)\right]
\end{aligned}$$



$$
\begin{aligned}
f_{T_1}(t)= &amp; \phi\left(\sqrt{\frac{\lambda}{l-x_\tau}}\left(t-\frac{l}{\mu}\right)\right) \cdot \sqrt{\frac{\lambda}{l-x_\tau}}-\frac{2 \lambda}{\mu} \exp \left(\frac{2 \lambda t}{\mu}\right) \Phi\left(-\sqrt{\frac{\lambda}{l-x_\tau}}\left(\frac{l-x_\tau}{\mu}+t\right)\right) \\
&amp; +\exp \left(\frac{2 \lambda t}{\mu}\right) \phi\left(-\sqrt{\frac{\lambda}{l-x_\tau}}\left(\frac{l-x_\tau}{\mu}+t\right)\right) \cdot \sqrt{\frac{\lambda}{l-x_\tau}}
\end{aligned}
$$






#### 3.1.2 统计推断

令$X\left(t_{ij}\right)$为第$i$个测试单元在$t_{ij}$时刻测量的退化特性，其中$i=1， \ldots, n$和$j=$ $1， \ldots, m_i$。

##### 3.1.2.1 极大似然估计

根据$\Delta x_{ij}=X\left(t_{ij}\right)-X\left(t_{ij -1}\right)， i=1， \ldots n, j=1， \ldots, m_i$， $(\mu, \lambda)$的似然函数为 $$
L(\mu, \lambda)=\prod_{i=1}^n \prod_{j=1}^{m_i} f_{I G}\left(\Delta x_{i j}, \mu \Delta t_{i j}, \lambda \Delta^2 t_{i j}\right).
$$ 对数似然函数为： 
$$
\log L(\mu, \lambda) \propto \sum_{i=1}^n \sum_{j=1}^{m_i}\left(\frac{1}{2} \log (\lambda)+\log \Delta t_{i j}-\frac{3}{2} \log \left(\Delta x_{i j}\right)-\frac{\lambda\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \mu^2 \Delta x_{i j}}\right)
$$

##### 3.1.2.2 贝叶斯估计



### 3.3 模拟数据分析

#### 数据模拟产生

```{r include=FALSE}
# 数据模拟产生
sim_dat = function(group = 6, t = 1:200, para = c(2,2)){
  library(SuppDists)
  # para 指 mu,lambda 
  # epoch 指测量次数，group 指组数
  delta_t = diff(t)
  epoch = length(delta_t)
  dat = matrix(NA,epoch,group+1)
  dat[,1] = seq(1,epoch)
  dat_unit = numeric()
  for(i in 1:group){
    for(j in 1:epoch) dat_unit[j] = rinvGauss(1,para[1]*delta_t[j], para[2] * (delta_t[j])^2)  #来自SuppDists包，注意与statmod包不同rinvgauss()
    dat[,i+1] = cumsum(dat_unit)
  }
  dat = data.frame(dat)
  dat1 = rbind(rep(0,group+1),dat) # 加入初始值绘制点
  colnames(dat1) = c("Time",paste(1:group,sep=''))
  return(dat1)
}
```

#### 绘制退化路径图

```{r include=FALSE}
# 绘制退化路径图
plot_path = function(data = dat1){
    # 画图
  p = data %&gt;% pivot_longer(paste(1:group), 
                       names_to = "Group", 
                       values_to = "y") %&gt;% 
    ggplot(aes(Time,y,color = Group)) + 
    geom_line() + 
    scale_color_viridis(discrete = T) + 
    ylab("Degradation") #+
    #theme_bw() +
    #theme(panel.grid = element_blank())
  print(p)
}
```

```{r }
group = 6
t = 1:200
para = c(5,5) #eta,lambda
dat = sim_dat(group = group, t = t, para = para)
knitr::kable(head(dat))
plot_path(dat)
```

#### 极大似然估计

```{r include=FALSE}
cumsub = function(x){
  #完成逐个相减功能，类似cumsum
  re = numeric()
  re[1] = x[1]
  for(i in 2:length(x)){
    re[i] = x[i] - x[i-1]
  }
  return(re)
}
```

```{r include=FALSE}
IG_mle = function(par = c(2,2),data = dat){
  # 输入：mu,lambda，数据
  # 输出：负对数似然函数
  group = ncol(data) - 1;time = data[,1];y = data[-1,-1]
  # 差分得到delta_time和delta_y
  delta_time = matrix(rep(diff(time),group),length(diff(time)),group)
  delta_y = matrix(NA,nrow(delta_time),group)
  for(i in 1:group) delta_y[,i] = cumsub(y[,i])

  logl = nrow(delta_time) * group * 1/2 * log(par[2]) + sum(log(delta_time) - 3/2 * log(delta_y) - (par[2]*(delta_y - par[1]*delta_time)^2)/(2 * par[1]^2 * delta_y),na.rm =T)

  return(-logl)
}
```

quarto-executable-code-5450563D

```r
mle_re = optim(par=c(0.6,5), fn = IG_mle, 
      data = dat, method = "BFGS", hessian = TRUE)
mle_re$par
mle_par = mle_re$par
# 区间估计
mle_up = mle_re$par + sqrt(diag(solve(mle_re$hessian)))*qnorm(0.975)
mle_low = mle_re$par - sqrt(diag(solve(mle_re$hessian)))*qnorm(0.975) #hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217
mle_summary = round(cbind(mle_low,mle_re$par,mle_up,para),3)
colnames(mle_summary) = c("low","mean","up","true")
knitr::kable(mle_summary) 
```



#### 可靠度和 RUL 计算

- 可靠度
```{r,include=FALSE}
## 可靠度计算
IG_R = function(t = 100, threshold = 200, par = mle_par){
  R = 1 - pnorm(sqrt(par[2]/threshold)*(t - threshold/par[1])) +
    exp(2*par[2]*t/par[1])*pnorm(-sqrt(par[2]/threshold) *(threshold/par[1] + t))
  return(R)
}
```


quarto-executable-code-5450563D

```r
# 给个简单例子
IG_R(t = 30, threshold = 150,par = mle_par)
# 绘制带区间估计的可靠度函数（需要优化为 ggplot 绘制）
R_time = 1:60
R_data = data.frame("Time" = R_time,
  "Up" = IG_R(t = R_time, threshold = 150,par = mle_up),
           "Mean" = IG_R(t = R_time, threshold = 150,par = mle_par),
           "Low" = IG_R(t = R_time, threshold = 150,par = mle_low))

# 绘制带区间估计的可靠度函数
ggplot(R_data) +
  geom_line(aes(Time,Up),color = "gray60",linetype = 2) +
  geom_line(aes(Time,Mean)) +
  geom_line(aes(Time,Low),color = "gray60",linetype = 2) +
  ylab("Reliability") + xlab("time")
```

- RUL


```{r,include=FALSE}
## 剩余使用寿命 ========
RUL = function(t = 50:100, cur_time = 30, threshold = 300, data = dat, par = mle_par){
  RUL = list()
  cur_path = as.numeric(data[cur_time,])
  ll = numeric()
  for(i in 1:(ncol(data)-1)){
      RUL[[i]] = numeric()
      ll[i] = sqrt(par[2])/sqrt((threshold - cur_path[i]))
      RUL[[i]] = dnorm(ll[i] * (t - threshold/par[1])) * ll[i] - 2*par[2]/par[1] * exp(2 * par[2] * t / par[1]) * pnorm(- ll[i] * ((threshold - cur_path[i])/par[1] + t)) +
        exp(2*par[2]*t/par[1]) * dnorm(-ll[i] * ((threshold - cur_path[i])/par[1] + t) ) * ll[i]
    }
  return(RUL)
}
```

```{r,include=FALSE}
# 未来时刻fut_time下的RUL值
RUL_3D_density = function(fut_time,time_epoch,rul_den,
                          threshold,real_RUL,
                          zlim = c(0,0.1),xlim = c(0,100)){
  library(plot3D)
  col = c("#02B1e6", "#E81D22", "#F9BC15", "#8015f9", "#20e81d", "#e64602","black")
  scatter3D(time_epoch, rep(1,length(time_epoch)), c(rul_den[[1]],rep(NA,length(time_epoch) - length(rul_den[[1]]))),
            bty = "b2",colkey = FALSE,
            phi = 14,theta = 55,
            pch = 18,alpha = 0, expand =0.2,ticktype = "detailed",
            xlim = xlim,
            ylim = c(min(fut_time)-5,max(fut_time)+5),
            zlim = zlim,
            xlab = "RUL", ylab = "Time", zlab = "Kernel Distribution")
  # 循环绘制3D图形
  for(i in 1:length(fut_time)){
    # 密度函数
    scatter3D(time_epoch, rep(fut_time[i],length(time_epoch)), c(rul_den[[i]],rep(NA,length(time_epoch) - length(rul_den[[i]]))),
              add = TRUE,type ='l', col = col[i], pch = 16)
    # 预测值
    scatter3D(which.max(rul_den[[i]]), fut_time[i], 0,
              add = TRUE, type ='h', col = "black", pch = 16)
    # 真实值
    scatter3D(real_RUL[i],fut_time[i], 0,
              add = TRUE, type ='h', col = "red", pch = 5)
  }
  legend("top", legend = c("RUL distribution","Point estimation","Real value"),
         pch=c(NA,16,5), col = c(col[1],"black","red"),lty = c(1,NA,NA)) #,inset = .05
  # 7.8,6.4
}

```

quarto-executable-code-5450563D

```r
  fut_time = c(50,60,70,80,90,100)
  time_epoch = 0:150; threshold = 300
  para = mle_par
  rul_den = list()
  for(i in 1:length(fut_time)){
    rul_den[[i]] = RUL(t = time_epoch, cur_time = fut_time[i],
                      threshold = threshold, par = para)[[1]]
  }
  # sapply(rul_den,which.max)
  
  p = RUL_3D_density(fut_time,time_epoch,rul_den,threshold,
                     real_RUL = NA,zlim = c(0,0.08), xlim = c(0,150))
```






### 激光器件 Laser 数据集

&gt; 数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。

激光器件的质量特征是其**工作电流**。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的退化路径及其拟合的平均趋势。

quarto-executable-code-5450563D

```r
Laser_dat = read.csv("dataset/GaAsLaser.csv")
knitr::kable(head(Laser_dat))
Laser_dat$Unit = as.factor(Laser_dat$Unit)
```

quarto-executable-code-5450563D

```r
Laser_dat %&gt;% ggplot(aes(Hours,Value,fill = Unit)) +
  geom_line(size = 0.1) + 
  geom_point(size = 0.8) + 
  theme_bw() +
  theme(panel.grid.major = element_blank()) +
  # scale_color_viridis(discrete = T) + 
  theme(legend.position = 'none') +
  labs(x = "Hours", y = "Degradation characteristic")
```

### 防辐射 Anti-radiation 数据集

&gt; 数据来源：Song, B., et al. (2017). "Performance evaluation of anti-radiation based on the gamma degradation process." Science China Technological Sciences 60(4): 501-509.

&gt; 分析结果参考：Guan, Q., et al. (2019). "Reference Bayesian analysis of inverse Gaussian degradation process." Applied Mathematical Modelling 74: 496-511.（IG + 客观贝叶斯）

数据还未下载（文中有，具体怎么做的试验，还未学习），pdf已经存在Endnote中了。

Peng, W. W., et al. (2014). "Inverse Gaussian process models for degradation analysis: A Bayesian perspective." Reliability Engineering &amp; System Safety **130**: 175-189.（贝叶斯相关）

\</code></pre>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>